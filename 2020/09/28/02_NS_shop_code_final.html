<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="https://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      2020 Big Contest - 2 &middot; Data Flows in You
    
  </title>

  


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://5hyunkwon.github.io/favicon.png" />
<link rel="shortcut icon" href="https://5hyunkwon.github.io/favicon.png" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Additional head bits without overriding original head -->
</head>


  <body class="post">

    <div id="sidebar">
  <header>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        Data Flows in You
      </a>
    </div>
    <p class="lead"><a href="https://en.wikipedia.org/wiki/Data_science" target="_blank">Data Scientist</a>: The Sexiest Job of the 21st Century</p>
  </header>
  <nav id="sidebar-nav-links">
  
    <a class="home-link "
        href="/">Home</a>
  
  

  

  


  
    
  

  
    
      <a class="page-link "
          href="/about.html">About</a>
    
  

  
    
  

  

  
    
  

  
    
  

  

  
    
  

  
    
  


  


  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  

  
    
  

  
    
  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  

  <nav id="sidebar-icon-links">
  
  
  
  

  
    <a id="tags-link"
       class="icon"
       title="Tags" aria-label="Tags"
       href="/tags.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
    </a>
  

  <a id="github-link"
    class="icon" title="Github" aria-label="Github"
    href="https://github.com/5hyunkwon"
    target="_blank">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 28" height="24" width="28"><path d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-0.609 0.109-0.828-0.266-0.828-0.578 0-0.391 0.016-1.687 0.016-3.297 0-1.125-0.375-1.844-0.812-2.219 2.672-0.297 5.484-1.313 5.484-5.922 0-1.313-0.469-2.375-1.234-3.219 0.125-0.313 0.531-1.531-0.125-3.187-1-0.313-3.297 1.234-3.297 1.234-0.953-0.266-1.984-0.406-3-0.406s-2.047 0.141-3 0.406c0 0-2.297-1.547-3.297-1.234-0.656 1.656-0.25 2.875-0.125 3.187-0.766 0.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-0.344 0.313-0.656 0.844-0.766 1.609-0.688 0.313-2.438 0.844-3.484-1-0.656-1.141-1.844-1.234-1.844-1.234-1.172-0.016-0.078 0.734-0.078 0.734 0.781 0.359 1.328 1.75 1.328 1.75 0.703 2.141 4.047 1.422 4.047 1.422 0 1 0.016 1.937 0.016 2.234 0 0.313-0.219 0.688-0.828 0.578-4.766-1.594-8.203-6.094-8.203-11.391 0-6.625 5.375-12 12-12zM4.547 19.234c0.031-0.063-0.016-0.141-0.109-0.187-0.094-0.031-0.172-0.016-0.203 0.031-0.031 0.063 0.016 0.141 0.109 0.187 0.078 0.047 0.172 0.031 0.203-0.031zM5.031 19.766c0.063-0.047 0.047-0.156-0.031-0.25-0.078-0.078-0.187-0.109-0.25-0.047-0.063 0.047-0.047 0.156 0.031 0.25 0.078 0.078 0.187 0.109 0.25 0.047zM5.5 20.469c0.078-0.063 0.078-0.187 0-0.297-0.063-0.109-0.187-0.156-0.266-0.094-0.078 0.047-0.078 0.172 0 0.281s0.203 0.156 0.266 0.109zM6.156 21.125c0.063-0.063 0.031-0.203-0.063-0.297-0.109-0.109-0.25-0.125-0.313-0.047-0.078 0.063-0.047 0.203 0.063 0.297 0.109 0.109 0.25 0.125 0.313 0.047zM7.047 21.516c0.031-0.094-0.063-0.203-0.203-0.25-0.125-0.031-0.266 0.016-0.297 0.109s0.063 0.203 0.203 0.234c0.125 0.047 0.266 0 0.297-0.094zM8.031 21.594c0-0.109-0.125-0.187-0.266-0.172-0.141 0-0.25 0.078-0.25 0.172 0 0.109 0.109 0.187 0.266 0.172 0.141 0 0.25-0.078 0.25-0.172zM8.937 21.438c-0.016-0.094-0.141-0.156-0.281-0.141-0.141 0.031-0.234 0.125-0.219 0.234 0.016 0.094 0.141 0.156 0.281 0.125s0.234-0.125 0.219-0.219z"></path>
</svg>

  </a>

  <!-- Optional additional links to insert for icons links -->
<a id="facebook-link"
   class="icon" title="Facebook" aria-label="Facebook"
   href="https://www.facebook.com/5hyunkwon"
   target="_blank">
   <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M22.675 0h-21.35c-.732 0-1.325.593-1.325 1.325v21.351c0 .731.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12v9.293h6.116c.73 0 1.323-.593 1.323-1.325v-21.35c0-.732-.593-1.325-1.325-1.325z"/></svg>
</a>

<a id="instagram-link"
   class="icon" title="Instagram" aria-label="Instagram"
   href="https://www.instagram.com/5hyun_kwon/"
   target="_blank">
   <svg xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" viewBox="0 0 24 24"><path d="M17.34,5.46h0a1.2,1.2,0,1,0,1.2,1.2A1.2,1.2,0,0,0,17.34,5.46Zm4.6,2.42a7.59,7.59,0,0,0-.46-2.43,4.94,4.94,0,0,0-1.16-1.77,4.7,4.7,0,0,0-1.77-1.15,7.3,7.3,0,0,0-2.43-.47C15.06,2,14.72,2,12,2s-3.06,0-4.12.06a7.3,7.3,0,0,0-2.43.47A4.78,4.78,0,0,0,3.68,3.68,4.7,4.7,0,0,0,2.53,5.45a7.3,7.3,0,0,0-.47,2.43C2,8.94,2,9.28,2,12s0,3.06.06,4.12a7.3,7.3,0,0,0,.47,2.43,4.7,4.7,0,0,0,1.15,1.77,4.78,4.78,0,0,0,1.77,1.15,7.3,7.3,0,0,0,2.43.47C8.94,22,9.28,22,12,22s3.06,0,4.12-.06a7.3,7.3,0,0,0,2.43-.47,4.7,4.7,0,0,0,1.77-1.15,4.85,4.85,0,0,0,1.16-1.77,7.59,7.59,0,0,0,.46-2.43c0-1.06.06-1.4.06-4.12S22,8.94,21.94,7.88ZM20.14,16a5.61,5.61,0,0,1-.34,1.86,3.06,3.06,0,0,1-.75,1.15,3.19,3.19,0,0,1-1.15.75,5.61,5.61,0,0,1-1.86.34c-1,.05-1.37.06-4,.06s-3,0-4-.06A5.73,5.73,0,0,1,6.1,19.8,3.27,3.27,0,0,1,5,19.05a3,3,0,0,1-.74-1.15A5.54,5.54,0,0,1,3.86,16c0-1-.06-1.37-.06-4s0-3,.06-4A5.54,5.54,0,0,1,4.21,6.1,3,3,0,0,1,5,5,3.14,3.14,0,0,1,6.1,4.2,5.73,5.73,0,0,1,8,3.86c1,0,1.37-.06,4-.06s3,0,4,.06a5.61,5.61,0,0,1,1.86.34A3.06,3.06,0,0,1,19.05,5,3.06,3.06,0,0,1,19.8,6.1,5.61,5.61,0,0,1,20.14,8c.05,1,.06,1.37.06,4S20.19,15,20.14,16ZM12,6.87A5.13,5.13,0,1,0,17.14,12,5.12,5.12,0,0,0,12,6.87Zm0,8.46A3.33,3.33,0,1,1,15.33,12,3.33,3.33,0,0,1,12,15.33Z"/></svg>
</a>

<a id="linkedin-link"
   class="icon" title="Linkedin" aria-label="Linkedin"
   href="https://www.linkedin.com/in/5hyunkwon/"
   target="_blank">
   <svg xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" viewBox="0 0 24 24"><path d="M20.47,2H3.53A1.45,1.45,0,0,0,2.06,3.43V20.57A1.45,1.45,0,0,0,3.53,22H20.47a1.45,1.45,0,0,0,1.47-1.43V3.43A1.45,1.45,0,0,0,20.47,2ZM8.09,18.74h-3v-9h3ZM6.59,8.48h0a1.56,1.56,0,1,1,0-3.12,1.57,1.57,0,1,1,0,3.12ZM18.91,18.74h-3V13.91c0-1.21-.43-2-1.52-2A1.65,1.65,0,0,0,12.85,13a2,2,0,0,0-.1.73v5h-3s0-8.18,0-9h3V11A3,3,0,0,1,15.46,9.5c2,0,3.45,1.29,3.45,4.06Z"/></svg>
</a>
</nav>

  <p>
  &copy; 2021.
  <a href="/LICENSE.md">MIT License.</a>
</p>

</div>

    <main class="container">
      <header>
  <h1 class="post-title">2020 Big Contest - 2</h1>
</header>
<div class="content">
  <div class="post-meta">
  <span class="post-date">28 Sep 2020</span>
  <span class="post-categories">
    
  </span>
</div>


  <div class="post-body">
    <h2 id="1-predictive-modeling">1. Predictive Modeling</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="nn">konlpy</span>
<span class="kn">import</span> <span class="nn">konlpy.tag</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">konlpy.tag</span> <span class="kn">import</span> <span class="n">Okt</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">TruncatedSVD</span> 
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">RobustScaler</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="c1"># 한글 폰트
</span><span class="n">plt</span><span class="p">.</span><span class="n">rc</span><span class="p">(</span><span class="s">'font'</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s">'Malgun Gothic'</span><span class="p">)</span>

<span class="c1"># 도화지 크기
</span><span class="n">plt</span><span class="p">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s">'figure.figsize'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="c1"># 숫자 표기법 변환
</span><span class="n">pd</span><span class="p">.</span><span class="n">set_option</span><span class="p">(</span><span class="s">'display.float_format'</span><span class="p">,</span> <span class="s">'{:.2f}'</span><span class="p">.</span><span class="nb">format</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/usr/local/lib/python3.6/dist-packages/statsmodels/tools/_testing.py:19: FutureWarning: pandas.util.testing is deprecated. Use the functions in the public API at pandas.testing instead.
  import pandas.util.testing as tm
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>

<span class="n">drive</span><span class="p">.</span><span class="n">mount</span><span class="p">(</span><span class="s">'/content/drive'</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Mounted at /content/drive
</code></pre></div></div>

<h2 id="1-데이터-셋-만들기">1. 데이터 셋 만들기</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"/content/drive/Shared drives/빅콘테스트2020/data/data/01_제공데이터/train.csv"</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"/content/drive/Shared drives/빅콘테스트2020/data/data/02_평가데이터/test.csv"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># column name 변경
</span><span class="n">train</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">test</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># 첫번쨰 행 삭제
</span><span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">test</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>방송일시</th>
      <th>노출(분)</th>
      <th>마더코드</th>
      <th>상품코드</th>
      <th>상품명</th>
      <th>상품군</th>
      <th>판매단가</th>
      <th>취급액</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2019-01-01 6:00</td>
      <td>20</td>
      <td>100346</td>
      <td>201072</td>
      <td>테이트 남성 셀린니트3종</td>
      <td>의류</td>
      <td>39,900</td>
      <td>2,099,000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-01 6:00</td>
      <td>NaN</td>
      <td>100346</td>
      <td>201079</td>
      <td>테이트 여성 셀린니트3종</td>
      <td>의류</td>
      <td>39,900</td>
      <td>4,371,000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-01 6:20</td>
      <td>20</td>
      <td>100346</td>
      <td>201072</td>
      <td>테이트 남성 셀린니트3종</td>
      <td>의류</td>
      <td>39,900</td>
      <td>3,262,000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-01 6:20</td>
      <td>NaN</td>
      <td>100346</td>
      <td>201079</td>
      <td>테이트 여성 셀린니트3종</td>
      <td>의류</td>
      <td>39,900</td>
      <td>6,955,000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2019-01-01 6:40</td>
      <td>20</td>
      <td>100346</td>
      <td>201072</td>
      <td>테이트 남성 셀린니트3종</td>
      <td>의류</td>
      <td>39,900</td>
      <td>6,672,000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>38305</th>
      <td>2020-01-01 0:20</td>
      <td>20</td>
      <td>100073</td>
      <td>200196</td>
      <td>삼성화재 행복한파트너 주택화재보험(1912)</td>
      <td>무형</td>
      <td>-</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>38306</th>
      <td>2020-01-01 0:40</td>
      <td>20</td>
      <td>100073</td>
      <td>200196</td>
      <td>삼성화재 행복한파트너 주택화재보험(1912)</td>
      <td>무형</td>
      <td>-</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>38307</th>
      <td>2020-01-01 1:00</td>
      <td>20</td>
      <td>100073</td>
      <td>200196</td>
      <td>삼성화재 행복한파트너 주택화재보험(1912)</td>
      <td>무형</td>
      <td>-</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>38308</th>
      <td>2020-01-01 1:20</td>
      <td>20</td>
      <td>100490</td>
      <td>201478</td>
      <td>더케이 예다함 상조서비스(티포트)</td>
      <td>무형</td>
      <td>-</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>38309</th>
      <td>2020-01-01 1:40</td>
      <td>17</td>
      <td>100490</td>
      <td>201478</td>
      <td>더케이 예다함 상조서비스(티포트)</td>
      <td>무형</td>
      <td>-</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>38309 rows × 8 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>방송일시</th>
      <th>노출(분)</th>
      <th>마더코드</th>
      <th>상품코드</th>
      <th>상품명</th>
      <th>상품군</th>
      <th>판매단가</th>
      <th>취급액</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2020-06-01 6:20</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59,800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-06-01 6:40</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59,800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-06-01 7:00</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59,800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-06-01 7:20</td>
      <td>20</td>
      <td>100445</td>
      <td>202278</td>
      <td>쿠미투니카 쿨 레이시 란쥬쉐이퍼&amp;팬티</td>
      <td>속옷</td>
      <td>69,900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020-06-01 7:40</td>
      <td>20</td>
      <td>100445</td>
      <td>202278</td>
      <td>쿠미투니카 쿨 레이시 란쥬쉐이퍼&amp;팬티</td>
      <td>속옷</td>
      <td>69,900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2887</th>
      <td>2020-07-01 0:20</td>
      <td>20</td>
      <td>100660</td>
      <td>201989</td>
      <td>쉴렉스  안마의자 렌탈서비스</td>
      <td>무형</td>
      <td>-</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2888</th>
      <td>2020-07-01 0:40</td>
      <td>20</td>
      <td>100660</td>
      <td>201989</td>
      <td>쉴렉스  안마의자 렌탈서비스</td>
      <td>무형</td>
      <td>-</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2889</th>
      <td>2020-07-01 1:00</td>
      <td>20</td>
      <td>100660</td>
      <td>201989</td>
      <td>쉴렉스  안마의자 렌탈서비스</td>
      <td>무형</td>
      <td>-</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2890</th>
      <td>2020-07-01 1:20</td>
      <td>20</td>
      <td>100261</td>
      <td>200875</td>
      <td>아놀드파마 티셔츠레깅스세트</td>
      <td>의류</td>
      <td>69,900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2891</th>
      <td>2020-07-01 1:40</td>
      <td>16</td>
      <td>100261</td>
      <td>200875</td>
      <td>아놀드파마 티셔츠레깅스세트</td>
      <td>의류</td>
      <td>69,900</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2891 rows × 8 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 무형 판매단가 0으로 대입
</span><span class="n">test</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s">'0'</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s">' - '</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>방송일시</th>
      <th>노출(분)</th>
      <th>마더코드</th>
      <th>상품코드</th>
      <th>상품명</th>
      <th>상품군</th>
      <th>판매단가</th>
      <th>취급액</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2020-06-01 6:20</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59,800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-06-01 6:40</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59,800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-06-01 7:00</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59,800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-06-01 7:20</td>
      <td>20</td>
      <td>100445</td>
      <td>202278</td>
      <td>쿠미투니카 쿨 레이시 란쥬쉐이퍼&amp;팬티</td>
      <td>속옷</td>
      <td>69,900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020-06-01 7:40</td>
      <td>20</td>
      <td>100445</td>
      <td>202278</td>
      <td>쿠미투니카 쿨 레이시 란쥬쉐이퍼&amp;팬티</td>
      <td>속옷</td>
      <td>69,900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2887</th>
      <td>2020-07-01 0:20</td>
      <td>20</td>
      <td>100660</td>
      <td>201989</td>
      <td>쉴렉스  안마의자 렌탈서비스</td>
      <td>무형</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2888</th>
      <td>2020-07-01 0:40</td>
      <td>20</td>
      <td>100660</td>
      <td>201989</td>
      <td>쉴렉스  안마의자 렌탈서비스</td>
      <td>무형</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2889</th>
      <td>2020-07-01 1:00</td>
      <td>20</td>
      <td>100660</td>
      <td>201989</td>
      <td>쉴렉스  안마의자 렌탈서비스</td>
      <td>무형</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2890</th>
      <td>2020-07-01 1:20</td>
      <td>20</td>
      <td>100261</td>
      <td>200875</td>
      <td>아놀드파마 티셔츠레깅스세트</td>
      <td>의류</td>
      <td>69,900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2891</th>
      <td>2020-07-01 1:40</td>
      <td>16</td>
      <td>100261</td>
      <td>200875</td>
      <td>아놀드파마 티셔츠레깅스세트</td>
      <td>의류</td>
      <td>69,900</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>2891 rows × 8 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># test 원본 데이터 복제
</span><span class="n">real_test</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></div>

<h1 id="2-데이터-전처리">2. 데이터 전처리</h1>

<h2 id="train-test">train, test</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 38309 entries, 1 to 38309
Data columns (total 8 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   방송일시    38309 non-null  object
 1   노출(분)   21525 non-null  object
 2   마더코드    38309 non-null  object
 3   상품코드    38309 non-null  object
 4   상품명     38309 non-null  object
 5   상품군     38309 non-null  object
 6   판매단가    38309 non-null  object
 7    취급액    35379 non-null  object
dtypes: object(8)
memory usage: 2.6+ MB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 2891 entries, 1 to 2891
Data columns (total 8 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   방송일시    2891 non-null   object
 1   노출(분)   1780 non-null   object
 2   마더코드    2891 non-null   object
 3   상품코드    2891 non-null   object
 4   상품명     2891 non-null   object
 5   상품군     2891 non-null   object
 6   판매단가    2891 non-null   object
 7   취급액     0 non-null      object
dtypes: object(8)
memory usage: 203.3+ KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>방송일시</th>
      <th>노출(분)</th>
      <th>마더코드</th>
      <th>상품코드</th>
      <th>상품명</th>
      <th>상품군</th>
      <th>판매단가</th>
      <th>취급액</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2019-01-01 6:00</td>
      <td>20</td>
      <td>100346</td>
      <td>201072</td>
      <td>테이트 남성 셀린니트3종</td>
      <td>의류</td>
      <td>39,900</td>
      <td>2,099,000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-01 6:00</td>
      <td>NaN</td>
      <td>100346</td>
      <td>201079</td>
      <td>테이트 여성 셀린니트3종</td>
      <td>의류</td>
      <td>39,900</td>
      <td>4,371,000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-01 6:20</td>
      <td>20</td>
      <td>100346</td>
      <td>201072</td>
      <td>테이트 남성 셀린니트3종</td>
      <td>의류</td>
      <td>39,900</td>
      <td>3,262,000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-01 6:20</td>
      <td>NaN</td>
      <td>100346</td>
      <td>201079</td>
      <td>테이트 여성 셀린니트3종</td>
      <td>의류</td>
      <td>39,900</td>
      <td>6,955,000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2019-01-01 6:40</td>
      <td>20</td>
      <td>100346</td>
      <td>201072</td>
      <td>테이트 남성 셀린니트3종</td>
      <td>의류</td>
      <td>39,900</td>
      <td>6,672,000</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>방송일시</th>
      <th>노출(분)</th>
      <th>마더코드</th>
      <th>상품코드</th>
      <th>상품명</th>
      <th>상품군</th>
      <th>판매단가</th>
      <th>취급액</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2020-06-01 6:20</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59,800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-06-01 6:40</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59,800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-06-01 7:00</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59,800</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-06-01 7:20</td>
      <td>20</td>
      <td>100445</td>
      <td>202278</td>
      <td>쿠미투니카 쿨 레이시 란쥬쉐이퍼&amp;팬티</td>
      <td>속옷</td>
      <td>69,900</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020-06-01 7:40</td>
      <td>20</td>
      <td>100445</td>
      <td>202278</td>
      <td>쿠미투니카 쿨 레이시 란쥬쉐이퍼&amp;팬티</td>
      <td>속옷</td>
      <td>69,900</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="column-name-변경">column name 변경</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['방송일시', '노출(분)', '마더코드', '상품코드', '상품명', '상품군', '판매단가', ' 취급액 '], dtype='object', name=0)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['방송일시', '노출(분)', '마더코드', '상품코드', '상품명', '상품군', '판매단가', '취급액'], dtype='object', name=0)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">.</span><span class="n">rename</span><span class="p">({</span><span class="s">' 취급액 '</span><span class="p">:</span><span class="s">'취급액'</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="판매단가-취급액-타입-변경">판매단가, 취급액 타입 변경</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 쉼표 제거
</span><span class="n">train</span><span class="p">[</span><span class="s">'취급액'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">','</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">!=</span> <span class="s">"&lt;class 'float'&gt;"</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s">'취급액'</span><span class="p">]]</span>
<span class="n">train</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">','</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]]</span>

<span class="n">test</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">','</span><span class="p">,</span><span class="s">''</span><span class="p">).</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 취급액 NaN 제거
</span><span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="o">~</span><span class="n">train</span><span class="p">[</span><span class="s">'취급액'</span><span class="p">].</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">reset_index</span><span class="p">().</span><span class="n">drop</span><span class="p">([</span><span class="s">'index'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 판매단가, 취급액 int로 변환 
</span><span class="n">train</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]]</span>
<span class="n">train</span><span class="p">[</span><span class="s">'취급액'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s">'취급액'</span><span class="p">]]</span>

<span class="n">test</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]]</span>
</code></pre></div></div>

<h3 id="방송일시-column을-바탕으로-날짜-시-분-column-만들기">방송일시 column을 바탕으로 날짜, 시, 분 column 만들기</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 날짜 column 생성
</span><span class="n">train</span><span class="p">[</span><span class="s">'날짜'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">]]</span>
<span class="n">train</span><span class="p">[</span><span class="s">'날짜'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">'%Y-%m-%d'</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s">'날짜'</span><span class="p">]]</span>

<span class="n">test</span><span class="p">[</span><span class="s">'날짜'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">]]</span>
<span class="n">test</span><span class="p">[</span><span class="s">'날짜'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">'%Y-%m-%d'</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test</span><span class="p">[</span><span class="s">'날짜'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 방송일시 date type변경
</span><span class="n">train</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">'%Y-%m-%d %H:%M'</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">]]</span>

<span class="n">test</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s">'%Y-%m-%d %H:%M'</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'시'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">hour</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">]]</span>
<span class="n">test</span><span class="p">[</span><span class="s">'시'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">hour</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'분'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">minute</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">]]</span>
<span class="n">test</span><span class="p">[</span><span class="s">'분'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">minute</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'날짜'</span><span class="p">)</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">final</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'시'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'상품군'</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'취급액'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="요일-column-만들기">요일 column 만들기</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mon</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">'20190101'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'20200701'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">'W-MON'</span><span class="p">)</span>
<span class="n">tue</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">'20190101'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'20200701'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">'W-TUE'</span><span class="p">)</span>
<span class="n">wed</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">'20190101'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'20200701'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">'W-WED'</span><span class="p">)</span>
<span class="n">thu</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">'20190101'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'20200701'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">'W-THU'</span><span class="p">)</span>
<span class="n">fri</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">'20190101'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'20200701'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">'W-FRI'</span><span class="p">)</span>
<span class="n">sat</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">'20190101'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'20200701'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">'W-SAT'</span><span class="p">)</span>
<span class="n">sun</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">'20190101'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'20200701'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">'W-SUN'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'날짜'</span><span class="p">])[:</span><span class="mi">10</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">mon</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'1'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">tue</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'2'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">wed</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'3'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">thu</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'4'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">fri</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'5'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">sat</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'6'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'7'</span><span class="p">)</span>
        
<span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span>


<span class="n">lst2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'날짜'</span><span class="p">])[:</span><span class="mi">10</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">mon</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'1'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">tue</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'2'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">wed</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'3'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">thu</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'4'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">fri</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'5'</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">sat</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'6'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">'7'</span><span class="p">)</span>
        
<span class="n">test</span><span class="p">[</span><span class="s">'요일'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst2</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 35379/35379 [00:28&lt;00:00, 1254.83it/s]
100%|██████████| 2891/2891 [00:02&lt;00:00, 1216.80it/s]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'요일'</span><span class="p">])</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f7a100ab5f8&gt;



findfont: Font family ['NanumBarunGothic'] not found. Falling back to DejaVu Sans.
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 50836 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 51068 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 50836 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 51068 missing from current font.
  font.set_text(s, 0, flags=flags)
</code></pre></div></div>

<p><img src="/assets/img/2020_big_contest/output_34_2.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s">'요일'</span><span class="p">])</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f7a12bcc5f8&gt;



/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 50836 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 51068 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 50836 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 51068 missing from current font.
  font.set_text(s, 0, flags=flags)
</code></pre></div></div>

<p><img src="/assets/img/2020_big_contest/output_35_2.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'날짜'</span><span class="p">)</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">final</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'요일'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s">'상품군'</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'취급액'</span><span class="p">)</span>
<span class="n">temp</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">).</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f7a100920b8&gt;



/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 50836 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 51068 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 50836 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 51068 missing from current font.
  font.set_text(s, 0, flags=flags)
</code></pre></div></div>

<p><img src="/assets/img/2020_big_contest/output_36_2.png" alt="png" /></p>

<h3 id="휴일변수-생성">휴일변수 생성</h3>

<h3 id="공휴일이-평일보다-판매수익이-더-높을까">공휴일이 평일보다 판매수익이 더 높을까?</h3>
<h3 id="-공휴일에-상품-평균-판매수익이-더-높다">* 공휴일에 상품 평균 판매수익이 더 높다</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'날짜'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 2019
</span><span class="n">all_day</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">'20190101'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'20200101'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">'D'</span><span class="p">).</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">all_day</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">all_day</span><span class="p">]</span>

<span class="c1"># 평일
</span><span class="n">weekday</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">'20190101'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'20200101'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">'B'</span><span class="p">).</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">weekday</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">weekday</span><span class="p">]</span>

<span class="c1"># 평일 중 공휴일
</span><span class="n">holiday</span> <span class="o">=</span> <span class="p">[</span><span class="s">'2019-01-01'</span><span class="p">,</span> <span class="s">'2019-02-04'</span><span class="p">,</span> <span class="s">'2019-02-05'</span><span class="p">,</span> <span class="s">'2019-02-06'</span><span class="p">,</span> <span class="s">'2019-03-01'</span><span class="p">,</span>
           <span class="s">'2019-05-06'</span><span class="p">,</span> <span class="s">'2019-06-06'</span><span class="p">,</span> <span class="s">'2019-08-15'</span><span class="p">,</span> <span class="s">'2019-09-12'</span><span class="p">,</span> <span class="s">'2019-09-13'</span><span class="p">,</span>
           <span class="s">'2019-10-03'</span><span class="p">,</span> <span class="s">'2019-10-09'</span><span class="p">,</span> <span class="s">'2019-12-25'</span><span class="p">]</span>

<span class="n">weekday_revenue</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">weekday_count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">holiday_revenue</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">holiday_count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">all_day</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">final</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'취급액'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">weekday</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">holiday</span><span class="p">:</span>
            <span class="n">holiday_revenue</span> <span class="o">+=</span> <span class="n">temp</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
            <span class="n">holiday_count</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">weekday_revenue</span> <span class="o">+=</span> <span class="n">temp</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
            <span class="n">weekday_count</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">holiday_revenue</span> <span class="o">+=</span> <span class="n">temp</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
        <span class="n">holiday_count</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 366/366 [00:29&lt;00:00, 12.26it/s]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">holiday_mean_revenue</span> <span class="o">=</span> <span class="n">holiday_revenue</span> <span class="o">/</span> <span class="n">holiday_count</span>
<span class="n">weekday_mean_revenue</span> <span class="o">=</span> <span class="n">weekday_revenue</span> <span class="o">/</span> <span class="n">weekday_count</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="n">temp</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">holiday_mean_revenue</span>
<span class="n">temp</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">weekday_mean_revenue</span>
<span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'주말'</span><span class="p">,</span> <span class="s">'평일'</span><span class="p">]</span>
<span class="n">temp</span><span class="p">.</span><span class="n">rename</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s">'평균취급액'</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">temp</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f7a12acbda0&gt;



/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 51452 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 47568 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 54217 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 51068 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 51452 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 47568 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 54217 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 51068 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 44512 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 52712 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 44553 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 50529 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 44512 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 52712 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 44553 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 50529 missing from current font.
  font.set_text(s, 0, flags=flags)
</code></pre></div></div>

<p><img src="/assets/img/2020_big_contest/output_40_2.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sat</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">'20190101'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'20200701'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">'W-SAT'</span><span class="p">)</span>
<span class="n">sat</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sat</span><span class="p">]</span>

<span class="n">sun</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s">'20190101'</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">'20200701'</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s">'W-SUN'</span><span class="p">)</span>
<span class="n">sun</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sun</span><span class="p">]</span>

<span class="n">holiday</span> <span class="o">=</span> <span class="p">[</span><span class="s">'2019-01-01'</span><span class="p">,</span> <span class="s">'2019-02-04'</span><span class="p">,</span> <span class="s">'2019-02-05'</span><span class="p">,</span> <span class="s">'2019-02-06'</span><span class="p">,</span> <span class="s">'2019-03-01'</span><span class="p">,</span>
           <span class="s">'2019-05-06'</span><span class="p">,</span> <span class="s">'2019-06-06'</span><span class="p">,</span> <span class="s">'2019-08-15'</span><span class="p">,</span> <span class="s">'2019-09-12'</span><span class="p">,</span> <span class="s">'2019-09-13'</span><span class="p">,</span>
           <span class="s">'2019-10-03'</span><span class="p">,</span> <span class="s">'2019-10-09'</span><span class="p">,</span> <span class="s">'2019-12-25'</span><span class="p">,</span> <span class="s">'2020-06-06'</span><span class="p">]</span>

<span class="n">sat</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sun</span><span class="p">)</span>
<span class="n">holiday</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">sat</span><span class="p">)</span>

<span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'날짜'</span><span class="p">])[:</span><span class="mi">10</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">holiday</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
<span class="n">train</span><span class="p">[</span><span class="s">'휴일'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span>


<span class="n">lst2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'날짜'</span><span class="p">])[:</span><span class="mi">10</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp</span> <span class="ow">in</span> <span class="n">holiday</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
<span class="n">test</span><span class="p">[</span><span class="s">'휴일'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst2</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 35379/35379 [00:06&lt;00:00, 5134.92it/s]
100%|██████████| 2891/2891 [00:00&lt;00:00, 4524.75it/s]
</code></pre></div></div>

<h3 id="상품명-양-끝에-공백-문자-제거">상품명 양 끝에 공백 문자 제거</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'상품명'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">train</span><span class="p">[</span><span class="s">'상품명'</span><span class="p">]]</span>
<span class="n">test</span><span class="p">[</span><span class="s">'상품명'</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">test</span><span class="p">[</span><span class="s">'상품명'</span><span class="p">]]</span>
</code></pre></div></div>

<h3 id="노출분-시간-채우기">노출(분) 시간 채우기</h3>
<h3 id="노출시간-na값을-보면-전에-상품과-동시방영이라-위에-있는-값으로-채운다">노출시간 NA값을 보면 전에 상품과 동시방영이라 위에 있는 값으로 채운다</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dtype</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">dtypes</span>
<span class="n">n_na</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">).</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">pct_na</span> <span class="o">=</span> <span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span> <span class="o">/</span> <span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]).</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s">'dtype'</span><span class="p">:</span><span class="n">dtype</span><span class="p">,</span> <span class="s">'NA개수'</span><span class="p">:</span><span class="n">n_na</span><span class="p">,</span> <span class="s">'NA비율'</span><span class="p">:</span><span class="n">pct_na</span><span class="p">}</span>

<span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dic</span><span class="p">).</span><span class="n">T</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>방송일시</th>
      <th>노출(분)</th>
      <th>마더코드</th>
      <th>상품코드</th>
      <th>상품명</th>
      <th>상품군</th>
      <th>판매단가</th>
      <th>취급액</th>
      <th>날짜</th>
      <th>시</th>
      <th>분</th>
      <th>요일</th>
      <th>휴일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>dtype</th>
      <td>datetime64[ns]</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>object</td>
      <td>int64</td>
      <td>int64</td>
      <td>datetime64[ns]</td>
      <td>int64</td>
      <td>int64</td>
      <td>object</td>
      <td>int64</td>
    </tr>
    <tr>
      <th>NA개수</th>
      <td>0</td>
      <td>14976</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>NA비율</th>
      <td>0.00</td>
      <td>42.33</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># NaN값 미리 0으로 채워놓기
</span><span class="n">train</span><span class="p">[</span><span class="s">'노출(분)'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">test</span><span class="p">[</span><span class="s">'노출(분)'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># int형으로 type 변경
</span><span class="n">train</span><span class="p">[</span><span class="s">'노출(분)'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'노출(분)'</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="s">'int'</span><span class="p">)</span>
<span class="n">test</span><span class="p">[</span><span class="s">'노출(분)'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'노출(분)'</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="s">'int'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">'노출(분)'</span><span class="p">]]</span>

<span class="c1"># 채우려는 값
</span><span class="n">fill</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">'노출(분)'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="c1"># 값이 존재하면 채우려는 값을 바꿔준다
</span>    <span class="k">if</span> <span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'노출(분)'</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'노출(분)'</span><span class="p">]</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>
    <span class="c1"># 값이 없으면 현재의 fill값으로 채운다
</span>    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>
        
<span class="n">train</span><span class="p">[</span><span class="s">'노출(분)'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 35378/35378 [00:10&lt;00:00, 3326.30it/s]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">'노출(분)'</span><span class="p">]]</span>

<span class="c1"># 채우려는 값
</span><span class="n">fill</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">'노출(분)'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="c1"># 값이 존재하면 채우려는 값을 바꿔준다
</span>    <span class="k">if</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'노출(분)'</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">fill</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'노출(분)'</span><span class="p">]</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>
    <span class="c1"># 값이 없으면 현재의 fill값으로 채운다
</span>    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">fill</span><span class="p">)</span>
        
<span class="n">test</span><span class="p">[</span><span class="s">'노출(분)'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 2890/2890 [00:01&lt;00:00, 2807.89it/s]
</code></pre></div></div>

<h3 id="계절-변수-생성">계절 변수 생성</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">spring</span> <span class="o">=</span> <span class="p">[</span><span class="s">'03'</span><span class="p">,</span> <span class="s">'04'</span><span class="p">,</span> <span class="s">'05'</span><span class="p">]</span>
<span class="n">summer</span> <span class="o">=</span> <span class="p">[</span><span class="s">'06'</span><span class="p">,</span> <span class="s">'07'</span><span class="p">,</span> <span class="s">'08'</span><span class="p">]</span>
<span class="n">fall</span> <span class="o">=</span> <span class="p">[</span><span class="s">'9'</span><span class="p">,</span> <span class="s">'10'</span><span class="p">,</span> <span class="s">'11'</span><span class="p">]</span>
<span class="n">winter</span> <span class="o">=</span> <span class="p">[</span><span class="s">'12'</span><span class="p">,</span> <span class="s">'01'</span><span class="p">,</span> <span class="s">'02'</span><span class="p">]</span>

<span class="n">season</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="ow">in</span> <span class="n">spring</span><span class="p">:</span>
        <span class="n">season</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="ow">in</span> <span class="n">summer</span><span class="p">:</span>
        <span class="n">season</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="ow">in</span> <span class="n">fall</span><span class="p">:</span>
        <span class="n">season</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">season</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">train</span><span class="p">[</span><span class="s">'season'</span><span class="p">]</span> <span class="o">=</span> <span class="n">season</span>


<span class="n">season2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="ow">in</span> <span class="n">spring</span><span class="p">:</span>
        <span class="n">season2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="ow">in</span> <span class="n">summer</span><span class="p">:</span>
        <span class="n">season2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span> <span class="ow">in</span> <span class="n">fall</span><span class="p">:</span>
        <span class="n">season2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">season2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">test</span><span class="p">[</span><span class="s">'season'</span><span class="p">]</span> <span class="o">=</span> <span class="n">season2</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 35379/35379 [00:00&lt;00:00, 36338.03it/s]
100%|██████████| 2891/2891 [00:00&lt;00:00, 39906.84it/s]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'season'</span><span class="p">])</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f7a12a63898&gt;
</code></pre></div></div>

<p><img src="/assets/img/2020_big_contest/output_51_1.png" alt="png" /></p>

<h3 id="1일-기준으로-해당상품-노출-횟수">1일 기준으로 해당상품 노출 횟수</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cnt</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'날짜'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">().</span><span class="n">sort_index</span><span class="p">().</span><span class="n">index</span><span class="p">.</span><span class="n">tolist</span><span class="p">()):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="n">train</span><span class="p">[</span><span class="s">'날짜'</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">temp2</span> <span class="o">=</span> <span class="n">temp</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'상품명'</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">dic</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">temp2</span><span class="p">)</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dic</span><span class="p">[</span><span class="n">temp2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dic</span><span class="p">[</span><span class="n">temp2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">cnt</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">temp2</span><span class="p">])</span>
    
<span class="n">train</span><span class="p">[</span><span class="s">'노출횟수'</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnt</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 366/366 [00:06&lt;00:00, 54.22it/s]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cnt</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s">'날짜'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">().</span><span class="n">sort_index</span><span class="p">().</span><span class="n">index</span><span class="p">.</span><span class="n">tolist</span><span class="p">()):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="p">[</span><span class="s">'날짜'</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">temp2</span> <span class="o">=</span> <span class="n">temp</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'상품명'</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">dic</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">temp2</span><span class="p">)</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">dic</span><span class="p">[</span><span class="n">temp2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dic</span><span class="p">[</span><span class="n">temp2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">cnt</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">temp2</span><span class="p">])</span>
    
<span class="n">test</span><span class="p">[</span><span class="s">'노출횟수'</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnt</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 31/31 [00:00&lt;00:00, 58.45it/s]
</code></pre></div></div>

<h3 id="주문량-변수-만들기">주문량 변수 만들기</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span><span class="p">[</span><span class="s">'주문량'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'취급액'</span><span class="p">]</span> <span class="o">/</span> <span class="n">train</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]</span>
</code></pre></div></div>

<h3 id="판매단가등급-column-만들기">판매단가등급 column 만들기</h3>
<h3 id="평균판매단가가-낮을수록-더-많이-팔렸다">평균판매단가가 낮을수록 더 많이 팔렸다</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'상품군'</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'취급액'</span><span class="p">).</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'상품군별 평균 취급액'</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5, 1.0, '상품군별 평균 취급액')



/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 49345 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 54408 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 44400 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 48324 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 54217 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 44512 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 52712 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 44553 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 50529 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 44032 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 44396 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 51204 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 44148 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 44053 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 44592 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 45733 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 45453 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 49688 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 52629 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 49373 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 54876 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 50857 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 49549 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 50743 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 51032 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 47448 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 51060 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 48120 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 51105 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 54868 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 51452 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 48169 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:214: RuntimeWarning: Glyph 52840 missing from current font.
  font.set_text(s, 0.0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 44032 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 44396 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 51204 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 44148 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 44053 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 44592 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 45733 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 45453 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 49688 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 52629 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 49373 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 54876 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 50857 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 54408 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 49549 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 50743 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 51032 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 47448 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 51060 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 48120 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 51105 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 54868 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 51452 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 48169 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 52840 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 49345 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 44400 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 48324 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 54217 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 44512 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 52712 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 44553 missing from current font.
  font.set_text(s, 0, flags=flags)
/usr/local/lib/python3.6/dist-packages/matplotlib/backends/backend_agg.py:183: RuntimeWarning: Glyph 50529 missing from current font.
  font.set_text(s, 0, flags=flags)
</code></pre></div></div>

<p><img src="/assets/img/2020_big_contest/output_58_2.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">final</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'상품군'</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'판매단가'</span><span class="p">).</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s">'bar'</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'상품군별 평균 판매단가'</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Text(0.5, 1.0, '상품군별 평균 판매단가')
</code></pre></div></div>

<p><img src="/assets/img/2020_big_contest/output_59_1.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'판매단가'</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">).</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">129</span><span class="p">].</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>83329.8449612403
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">129</span><span class="p">:(</span><span class="mi">129</span><span class="o">+</span><span class="mi">129</span><span class="p">)].</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>791922.480620155
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'판매단가'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp</span> <span class="o">&lt;=</span> <span class="mi">80000</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">temp</span> <span class="o">&gt;=</span> <span class="mi">80000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">temp</span> <span class="o">&lt;</span> <span class="mi">800000</span><span class="p">):</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        
<span class="n">train</span><span class="p">[</span><span class="s">'판매단가등급'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span>


<span class="n">lst2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'판매단가'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp</span> <span class="o">&lt;=</span> <span class="mi">80000</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">temp</span> <span class="o">&gt;=</span> <span class="mi">80000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">temp</span> <span class="o">&lt;</span> <span class="mi">800000</span><span class="p">):</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        
<span class="n">test</span><span class="p">[</span><span class="s">'판매단가등급'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst2</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 35379/35379 [00:06&lt;00:00, 5198.03it/s]
100%|██████████| 2891/2891 [00:00&lt;00:00, 5269.74it/s]
</code></pre></div></div>

<h3 id="상품명을-기준으로-embedding-행렬-만들기">상품명을 기준으로 embedding 행렬 만들기</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 훈련 및 테스트 셋에서 상품명 컬럼만 뽑아서 데이터셋 만들기
</span><span class="n">train_product</span> <span class="o">=</span> <span class="n">train</span><span class="p">[[</span><span class="s">'상품명'</span><span class="p">]]</span>
<span class="n">test_product</span> <span class="o">=</span> <span class="n">test</span><span class="p">[[</span><span class="s">'상품명'</span><span class="p">]]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train_product</span><span class="p">,</span> <span class="n">test_product</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">data</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>상품명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>테이트 남성 셀린니트3종</td>
    </tr>
    <tr>
      <th>1</th>
      <td>테이트 여성 셀린니트3종</td>
    </tr>
    <tr>
      <th>2</th>
      <td>테이트 남성 셀린니트3종</td>
    </tr>
    <tr>
      <th>3</th>
      <td>테이트 여성 셀린니트3종</td>
    </tr>
    <tr>
      <th>4</th>
      <td>테이트 남성 셀린니트3종</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>38265</th>
      <td>쉴렉스  안마의자 렌탈서비스</td>
    </tr>
    <tr>
      <th>38266</th>
      <td>쉴렉스  안마의자 렌탈서비스</td>
    </tr>
    <tr>
      <th>38267</th>
      <td>쉴렉스  안마의자 렌탈서비스</td>
    </tr>
    <tr>
      <th>38268</th>
      <td>아놀드파마 티셔츠레깅스세트</td>
    </tr>
    <tr>
      <th>38269</th>
      <td>아놀드파마 티셔츠레깅스세트</td>
    </tr>
  </tbody>
</table>
<p>38270 rows × 1 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 전체 상품명 데이터에서 한글만 남기기
</span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))):</span>
    <span class="c1"># 한글만 남기기
</span>    <span class="n">hangul</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="s">'[^ㄱ-ㅣ가-힣]+'</span><span class="p">)</span>
    <span class="n">data</span><span class="p">[</span><span class="s">'상품명'</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">hangul</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">' '</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s">'상품명'</span><span class="p">][</span><span class="n">k</span><span class="p">])</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 38270/38270 [00:08&lt;00:00, 4311.82it/s]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 한글 상품명에서 명사만 추출하기
</span><span class="n">okt</span> <span class="o">=</span> <span class="n">Okt</span><span class="p">()</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))):</span>
    <span class="n">data</span><span class="p">[</span><span class="s">'상품명'</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">okt</span><span class="p">.</span><span class="n">nouns</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">'상품명'</span><span class="p">][</span><span class="n">k</span><span class="p">])</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 41200/41200 [01:02&lt;00:00, 656.20it/s]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>상품명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>테이트 남성 셀린니트 종</td>
    </tr>
    <tr>
      <th>1</th>
      <td>테이트 여성 셀린니트 종</td>
    </tr>
    <tr>
      <th>2</th>
      <td>테이트 남성 셀린니트 종</td>
    </tr>
    <tr>
      <th>3</th>
      <td>테이트 여성 셀린니트 종</td>
    </tr>
    <tr>
      <th>4</th>
      <td>테이트 남성 셀린니트 종</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 단어 집합 만들기
</span><span class="n">s</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'상품명'</span><span class="p">]:</span>
    <span class="n">s</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 38270/38270 [00:03&lt;00:00, 9703.03it/s]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 추출 된 명사가 컬럼으로 이루어진 희소행렬 생성
</span><span class="n">emb_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>

<span class="c1"># 희소행렬 값 채우기
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'상품명'</span><span class="p">]:</span>
    <span class="n">emb_df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">emb_df</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 38270/38270 [04:39&lt;00:00, 137.14it/s]
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>팽</th>
      <th>툴</th>
      <th>슬</th>
      <th>퀸</th>
      <th>켄</th>
      <th>혜</th>
      <th>티</th>
      <th>회</th>
      <th>퀼</th>
      <th>세</th>
      <th>늄</th>
      <th>스</th>
      <th>들</th>
      <th>염</th>
      <th>맘</th>
      <th>널</th>
      <th>꼬</th>
      <th>퀘</th>
      <th>써</th>
      <th>겹</th>
      <th>녘</th>
      <th>폼</th>
      <th>연</th>
      <th>퓨</th>
      <th>펫</th>
      <th>남</th>
      <th>압</th>
      <th>감</th>
      <th>홑</th>
      <th>목</th>
      <th>샴</th>
      <th>통</th>
      <th>수</th>
      <th>풀</th>
      <th>꽃</th>
      <th>후</th>
      <th>루</th>
      <th>멋</th>
      <th>론</th>
      <th>광</th>
      <th>...</th>
      <th>유</th>
      <th>텀</th>
      <th>아</th>
      <th>처</th>
      <th>빈</th>
      <th>따</th>
      <th>운</th>
      <th>롱</th>
      <th>돼</th>
      <th>톨</th>
      <th>샐</th>
      <th>택</th>
      <th>틱</th>
      <th>힐</th>
      <th>낚</th>
      <th>톡</th>
      <th>산</th>
      <th>애</th>
      <th>붙</th>
      <th>삼</th>
      <th>쉘</th>
      <th>탠</th>
      <th>령</th>
      <th>폐</th>
      <th>흥</th>
      <th>허</th>
      <th>경</th>
      <th>맛</th>
      <th>셰</th>
      <th>슈</th>
      <th>링</th>
      <th>급</th>
      <th>샘</th>
      <th>중</th>
      <th>펙</th>
      <th>뚜</th>
      <th>쓰</th>
      <th>배</th>
      <th>양</th>
      <th>깍</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>38265</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>38266</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>38267</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>38268</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>38269</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
<p>38270 rows × 725 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">emb_df</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0       10.00
1       10.00
2       10.00
3       10.00
4       10.00
         ... 
38265   12.00
38266   12.00
38267   12.00
38268   14.00
38269   14.00
Length: 38270, dtype: float64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">emb_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"/content/drive/Shared drives/빅콘테스트2020/data/2020빅콘테스트/01_제공데이터/emb_df.csv"</span><span class="p">)</span>
<span class="n">emb_df</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'Unnamed: 0'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">emb_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>흥양</th>
      <th>프린팅</th>
      <th>시래기</th>
      <th>홍어</th>
      <th>안국루테</th>
      <th>클렌</th>
      <th>배터리</th>
      <th>어스</th>
      <th>캠프</th>
      <th>신</th>
      <th>컬럼비아</th>
      <th>노</th>
      <th>대자리</th>
      <th>진액</th>
      <th>양태</th>
      <th>호빵</th>
      <th>약</th>
      <th>말랭이</th>
      <th>클란츠</th>
      <th>안마</th>
      <th>젠트</th>
      <th>큐</th>
      <th>메모리</th>
      <th>굴비</th>
      <th>시어서커</th>
      <th>이크</th>
      <th>플랩</th>
      <th>터틀넥</th>
      <th>스팀</th>
      <th>살롱</th>
      <th>인버터</th>
      <th>농원</th>
      <th>꼬리곰탕</th>
      <th>국수</th>
      <th>분리</th>
      <th>티슈</th>
      <th>두</th>
      <th>제옥스</th>
      <th>순면</th>
      <th>황사</th>
      <th>...</th>
      <th>엑슬</th>
      <th>레스</th>
      <th>렌</th>
      <th>아트</th>
      <th>한장</th>
      <th>간장</th>
      <th>체증</th>
      <th>킹스</th>
      <th>쿠킹</th>
      <th>히터</th>
      <th>폼폼</th>
      <th>미란다</th>
      <th>싹</th>
      <th>더탑</th>
      <th>수련</th>
      <th>캐시</th>
      <th>가능</th>
      <th>야생화</th>
      <th>영광군</th>
      <th>쇼케이스</th>
      <th>숄더백</th>
      <th>감성</th>
      <th>깍두기</th>
      <th>렌탈</th>
      <th>풀</th>
      <th>레깅스</th>
      <th>링</th>
      <th>단순</th>
      <th>돌침대</th>
      <th>로퍼</th>
      <th>스파</th>
      <th>로션</th>
      <th>히트</th>
      <th>베니스</th>
      <th>하프</th>
      <th>화장</th>
      <th>퍼니쿡</th>
      <th>모닝</th>
      <th>캣</th>
      <th>베드룸</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>38265</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>38266</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>38267</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>38268</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>38269</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>...</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>1.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
<p>38270 rows × 2012 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 행렬분해
</span><span class="n">svd_model</span> <span class="o">=</span> <span class="n">TruncatedSVD</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">160</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s">'randomized'</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">321</span><span class="p">)</span>
<span class="n">svd_model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">emb_df</span><span class="p">.</span><span class="n">T</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TruncatedSVD(algorithm='randomized', n_components=160, n_iter=50,
             random_state=321, tol=0.0)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">svd_model</span><span class="p">.</span><span class="n">components_</span><span class="p">.</span><span class="n">T</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 임베딩 행렬 스케일링 진행 (RobustScaler)
</span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">,</span> <span class="n">RobustScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">RobustScaler</span><span class="p">()</span>

<span class="n">scaler</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">temp</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="n">temp</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 임베딩 행렬 K-means clustering (대분류 : 13개, 중분류 : 67개, 소분류 : 100개)
</span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span> <span class="mi">13</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">510</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span> <span class="p">,</span> <span class="p">:</span><span class="mi">160</span><span class="p">])</span>
<span class="n">temp</span><span class="p">[</span><span class="s">'emb_label'</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">.</span><span class="n">labels_</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">kmeans2</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span> <span class="mi">67</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">510</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span> <span class="p">,</span> <span class="p">:</span><span class="mi">160</span><span class="p">])</span>
<span class="n">temp</span><span class="p">[</span><span class="s">'emb_label2'</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans2</span><span class="p">.</span><span class="n">labels_</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">kmeans3</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">510</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">temp</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span> <span class="p">,</span> <span class="p">:</span><span class="mi">160</span><span class="p">])</span>
<span class="n">temp</span><span class="p">[</span><span class="s">'emb_label3'</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans3</span><span class="p">.</span><span class="n">labels_</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train</span><span class="p">,</span> <span class="n">temp</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">35379</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">test</span><span class="p">.</span><span class="n">reset_index</span><span class="p">().</span><span class="n">drop</span><span class="p">([</span><span class="s">'index'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">temp</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">35379</span><span class="p">:].</span><span class="n">reset_index</span><span class="p">().</span><span class="n">drop</span><span class="p">([</span><span class="s">'index'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 훈련, 시험셋의 '방송일시'변수 datetime으로 변경 후  '월','일' 변수 생성
</span><span class="n">train</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">train</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">])</span>
<span class="n">test</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">])</span>

<span class="n">train</span><span class="p">[</span><span class="s">'월'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">month</span>
<span class="n">train</span><span class="p">[</span><span class="s">'일'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">day</span>

<span class="n">test</span><span class="p">[</span><span class="s">'월'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">month</span>
<span class="n">test</span><span class="p">[</span><span class="s">'일'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="s">'방송일시'</span><span class="p">].</span><span class="n">dt</span><span class="p">.</span><span class="n">day</span>
</code></pre></div></div>

<h3 id="train--test-split">train / test split</h3>
<h3 id="-train-data안에서의-주문량만-학습하기-위해-미리-분리">* train data안에서의 주문량만 학습하기 위해 미리 분리</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_train</span><span class="p">,</span> <span class="n">train_test</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

<span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">510</span><span class="p">)</span>

<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">idx</span><span class="p">:</span>
        <span class="n">train_train</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">train_test</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        
<span class="k">print</span><span class="p">(</span><span class="s">'train_train :'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_train</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">'train_test :'</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_test</span><span class="p">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|██████████| 35379/35379 [00:00&lt;00:00, 65757.33it/s]

train_train : 28303
train_test : 7076
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_data</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_train</span><span class="p">,:]</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_test</span><span class="p">,:]</span>

<span class="k">print</span><span class="p">(</span><span class="n">train_data</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">test_data</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(28303, 182)
(7076, 182)
</code></pre></div></div>

<h3 id="주문량에따른-시간대별-등급">주문량에따른 시간대별 등급</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'시'</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">).</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s">'1'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">5</span><span class="p">].</span><span class="n">tolist</span><span class="p">(),</span>
       <span class="s">'2'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="mi">5</span><span class="p">:(</span><span class="mi">5</span><span class="o">+</span><span class="mi">5</span><span class="p">)].</span><span class="n">tolist</span><span class="p">(),</span>
       <span class="s">'3'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[(</span><span class="mi">5</span><span class="o">+</span><span class="mi">5</span><span class="p">):(</span><span class="mi">5</span><span class="o">+</span><span class="mi">5</span><span class="o">+</span><span class="mi">6</span><span class="p">)].</span><span class="n">tolist</span><span class="p">(),</span>
       <span class="s">'4'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[(</span><span class="mi">5</span><span class="o">+</span><span class="mi">5</span><span class="o">+</span><span class="mi">6</span><span class="p">):].</span><span class="n">tolist</span><span class="p">()}</span>

<span class="k">print</span><span class="p">(</span><span class="s">'전체 train </span><span class="si">\</span><span class="se">n</span><span class="s">'</span><span class="p">)</span>
<span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'시'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'1'</span><span class="p">]:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'2'</span><span class="p">]:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'3'</span><span class="p">]:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">train</span><span class="p">[</span><span class="s">'시등급'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  2%|▏         | 590/35379 [00:00&lt;00:12, 2876.60it/s]

전체 train 



100%|██████████| 35379/35379 [00:11&lt;00:00, 3045.25it/s]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'시'</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">).</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>


<span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s">'1'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">5</span><span class="p">].</span><span class="n">tolist</span><span class="p">(),</span>
       <span class="s">'2'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="mi">5</span><span class="p">:(</span><span class="mi">5</span><span class="o">+</span><span class="mi">5</span><span class="p">)].</span><span class="n">tolist</span><span class="p">(),</span>
       <span class="s">'3'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[(</span><span class="mi">5</span><span class="o">+</span><span class="mi">5</span><span class="p">):(</span><span class="mi">5</span><span class="o">+</span><span class="mi">5</span><span class="o">+</span><span class="mi">6</span><span class="p">)].</span><span class="n">tolist</span><span class="p">(),</span>
       <span class="s">'4'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[(</span><span class="mi">5</span><span class="o">+</span><span class="mi">5</span><span class="o">+</span><span class="mi">6</span><span class="p">):].</span><span class="n">tolist</span><span class="p">()}</span>


<span class="k">print</span><span class="p">(</span><span class="s">'학습 data 중 train </span><span class="si">\</span><span class="se">n</span><span class="s">'</span><span class="p">)</span>
<span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">train_data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'시'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'1'</span><span class="p">]:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'2'</span><span class="p">]:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'3'</span><span class="p">]:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">train_data</span><span class="p">[</span><span class="s">'시등급'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span>

<span class="k">print</span><span class="p">(</span><span class="s">'학습 data 중 test </span><span class="si">\</span><span class="se">n</span><span class="s">'</span><span class="p">)</span>
<span class="n">lst2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">test_data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'시'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'1'</span><span class="p">]:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'2'</span><span class="p">]:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'3'</span><span class="p">]:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">test_data</span><span class="p">[</span><span class="s">'시등급'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst2</span>


<span class="k">print</span><span class="p">(</span><span class="s">'평가 data </span><span class="si">\</span><span class="se">n</span><span class="s">'</span><span class="p">)</span>
<span class="n">lst3</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'시'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'1'</span><span class="p">]:</span>
        <span class="n">lst3</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'2'</span><span class="p">]:</span>
        <span class="n">lst3</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'3'</span><span class="p">]:</span>
        <span class="n">lst3</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'4'</span><span class="p">]:</span>
        <span class="n">lst3</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst3</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">)</span>

<span class="n">test</span><span class="p">[</span><span class="s">'시등급'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst3</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  2%|▏         | 624/28303 [00:00&lt;00:08, 3080.29it/s]

학습 data 중 train 



100%|██████████| 28303/28303 [00:09&lt;00:00, 3099.82it/s]
/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:23: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  9%|▉         | 621/7076 [00:00&lt;00:02, 3015.26it/s]

학습 data 중 test 



100%|██████████| 7076/7076 [00:02&lt;00:00, 3064.61it/s]
/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:39: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
 21%|██▏       | 617/2891 [00:00&lt;00:00, 3113.08it/s]

평가 data 



100%|██████████| 2891/2891 [00:00&lt;00:00, 3032.51it/s]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>방송일시</th>
      <th>노출(분)</th>
      <th>마더코드</th>
      <th>상품코드</th>
      <th>상품명</th>
      <th>상품군</th>
      <th>판매단가</th>
      <th>취급액</th>
      <th>날짜</th>
      <th>시</th>
      <th>분</th>
      <th>요일</th>
      <th>휴일</th>
      <th>season</th>
      <th>노출횟수</th>
      <th>판매단가등급</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>...</th>
      <th>131</th>
      <th>132</th>
      <th>133</th>
      <th>134</th>
      <th>135</th>
      <th>136</th>
      <th>137</th>
      <th>138</th>
      <th>139</th>
      <th>140</th>
      <th>141</th>
      <th>142</th>
      <th>143</th>
      <th>144</th>
      <th>145</th>
      <th>146</th>
      <th>147</th>
      <th>148</th>
      <th>149</th>
      <th>150</th>
      <th>151</th>
      <th>152</th>
      <th>153</th>
      <th>154</th>
      <th>155</th>
      <th>156</th>
      <th>157</th>
      <th>158</th>
      <th>159</th>
      <th>emb_label</th>
      <th>emb_label2</th>
      <th>emb_label3</th>
      <th>월</th>
      <th>일</th>
      <th>시등급</th>
      <th>분등급</th>
      <th>emb_label_주문량</th>
      <th>emb_label2_주문량</th>
      <th>emb_label3_주문량</th>
      <th>월_주문량</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-06-01 06:20:00</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59800</td>
      <td>NaN</td>
      <td>2020-06-01</td>
      <td>6</td>
      <td>20</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>-0.04</td>
      <td>2.42</td>
      <td>-1.72</td>
      <td>-0.56</td>
      <td>-1.86</td>
      <td>-0.09</td>
      <td>-2.14</td>
      <td>-0.58</td>
      <td>-0.61</td>
      <td>3.23</td>
      <td>-0.29</td>
      <td>0.11</td>
      <td>-0.29</td>
      <td>-0.47</td>
      <td>0.44</td>
      <td>-0.56</td>
      <td>0.24</td>
      <td>1.54</td>
      <td>-1.12</td>
      <td>-0.68</td>
      <td>1.24</td>
      <td>-1.39</td>
      <td>-1.66</td>
      <td>2.01</td>
      <td>...</td>
      <td>-0.93</td>
      <td>-0.71</td>
      <td>-0.62</td>
      <td>-0.13</td>
      <td>0.25</td>
      <td>-0.66</td>
      <td>-0.30</td>
      <td>-0.36</td>
      <td>0.69</td>
      <td>0.93</td>
      <td>0.63</td>
      <td>-0.46</td>
      <td>-0.38</td>
      <td>0.94</td>
      <td>-0.98</td>
      <td>0.54</td>
      <td>-0.43</td>
      <td>0.30</td>
      <td>-1.25</td>
      <td>1.34</td>
      <td>-0.52</td>
      <td>0.64</td>
      <td>-1.54</td>
      <td>0.68</td>
      <td>-1.14</td>
      <td>0.66</td>
      <td>0.28</td>
      <td>-0.24</td>
      <td>-1.21</td>
      <td>2</td>
      <td>83</td>
      <td>83</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>300.74</td>
      <td>416.68</td>
      <td>416.68</td>
      <td>305.60</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 187 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'분'</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">).</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s">'1'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">3</span><span class="p">].</span><span class="n">tolist</span><span class="p">(),</span>
       <span class="s">'2'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="mi">3</span><span class="p">:(</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="p">)].</span><span class="n">tolist</span><span class="p">(),</span>
       <span class="s">'3'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[(</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="p">):].</span><span class="n">tolist</span><span class="p">()}</span>

<span class="k">print</span><span class="p">(</span><span class="s">'전체 train </span><span class="si">\</span><span class="se">n</span><span class="s">'</span><span class="p">)</span>
<span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'분'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'1'</span><span class="p">]:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'2'</span><span class="p">]:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'3'</span><span class="p">]:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">train</span><span class="p">[</span><span class="s">'분등급'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  2%|▏         | 632/35379 [00:00&lt;00:10, 3161.42it/s]

전체 train 



100%|██████████| 35379/35379 [00:11&lt;00:00, 3104.19it/s]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'분'</span><span class="p">],</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">).</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>


<span class="n">dic</span> <span class="o">=</span> <span class="p">{</span><span class="s">'1'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">3</span><span class="p">].</span><span class="n">tolist</span><span class="p">(),</span>
       <span class="s">'2'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="mi">3</span><span class="p">:(</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="p">)].</span><span class="n">tolist</span><span class="p">(),</span>
       <span class="s">'3'</span><span class="p">:</span><span class="n">temp</span><span class="p">.</span><span class="n">index</span><span class="p">[(</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="p">):].</span><span class="n">tolist</span><span class="p">()}</span>

<span class="k">print</span><span class="p">(</span><span class="s">'학습 data 중 train </span><span class="si">\</span><span class="se">n</span><span class="s">'</span><span class="p">)</span>
<span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">train_data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'분'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'1'</span><span class="p">]:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'2'</span><span class="p">]:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">train_data</span><span class="p">[</span><span class="s">'분등급'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst</span>

<span class="k">print</span><span class="p">(</span><span class="s">'학습 data 중 test </span><span class="si">\</span><span class="se">n</span><span class="s">'</span><span class="p">)</span>
<span class="n">lst2</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">test_data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'분'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'1'</span><span class="p">]:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'2'</span><span class="p">]:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst2</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>


<span class="n">test_data</span><span class="p">[</span><span class="s">'분등급'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst2</span>


<span class="k">print</span><span class="p">(</span><span class="s">'평가 data </span><span class="si">\</span><span class="se">n</span><span class="s">'</span><span class="p">)</span>
<span class="n">lst3</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">temp2</span> <span class="o">=</span> <span class="n">test</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">'분'</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'1'</span><span class="p">]:</span>
        <span class="n">lst3</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'2'</span><span class="p">]:</span>
        <span class="n">lst3</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">temp2</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">[</span><span class="s">'3'</span><span class="p">]:</span>
        <span class="n">lst3</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lst3</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">nan</span><span class="p">)</span>

<span class="n">test</span><span class="p">[</span><span class="s">'분등급'</span><span class="p">]</span> <span class="o">=</span> <span class="n">lst3</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  2%|▏         | 660/28303 [00:00&lt;00:08, 3344.74it/s]

학습 data 중 train 



100%|██████████| 28303/28303 [00:09&lt;00:00, 3095.95it/s]
/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:20: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
 18%|█▊        | 1246/7076 [00:00&lt;00:01, 3087.44it/s]

학습 data 중 test 



100%|██████████| 7076/7076 [00:02&lt;00:00, 3066.61it/s]
/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:35: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
 51%|█████▏    | 1482/2891 [00:00&lt;00:00, 2983.40it/s]

평가 data 



100%|██████████| 2891/2891 [00:00&lt;00:00, 3008.91it/s]
</code></pre></div></div>

<h2 id="평균-주문량-column-생성">평균 주문량 column 생성</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_data</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s">'emb_label'</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">).</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">reset_index</span><span class="p">()</span>

</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>emb_label</th>
      <th>주문량</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10</td>
      <td>1492.11</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>1022.19</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>1007.99</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>877.25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>862.38</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7</td>
      <td>810.78</td>
    </tr>
    <tr>
      <th>6</th>
      <td>11</td>
      <td>810.28</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>755.63</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3</td>
      <td>542.33</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>423.78</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2</td>
      <td>302.53</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0</td>
      <td>78.35</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
      <td>69.18</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># train_data
</span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="s">'emb_label'</span><span class="p">,</span> <span class="s">'emb_label2'</span><span class="p">,</span> <span class="s">'emb_label3'</span><span class="p">,</span> <span class="s">'월'</span><span class="p">,</span> <span class="s">'시등급'</span><span class="p">,</span> <span class="s">'분등급'</span><span class="p">,</span> <span class="s">'요일'</span><span class="p">,</span><span class="s">'노출횟수'</span><span class="p">]</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">).</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">temp</span><span class="p">.</span><span class="n">columns</span><span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s">'_주문량'</span><span class="p">]</span>
    <span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># test_data
</span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="s">'emb_label'</span><span class="p">,</span> <span class="s">'emb_label2'</span><span class="p">,</span> <span class="s">'emb_label3'</span><span class="p">,</span> <span class="s">'월'</span><span class="p">,</span> <span class="s">'시등급'</span><span class="p">,</span> <span class="s">'분등급'</span><span class="p">,</span> <span class="s">'요일'</span><span class="p">,</span><span class="s">'노출횟수'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">).</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">temp</span><span class="p">.</span><span class="n">columns</span><span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s">'_주문량'</span><span class="p">]</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># test
</span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="s">'emb_label'</span><span class="p">,</span> <span class="s">'emb_label2'</span><span class="p">,</span> <span class="s">'emb_label3'</span><span class="p">,</span> <span class="s">'월'</span><span class="p">,</span> <span class="s">'시등급'</span><span class="p">,</span> <span class="s">'분등급'</span><span class="p">,</span> <span class="s">'요일'</span><span class="p">,</span><span class="s">'노출횟수'</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
    <span class="c1"># test에서는 전체 train으로 학습
</span>    <span class="n">temp</span> <span class="o">=</span> <span class="n">train</span><span class="p">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s">'mean'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">).</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'주문량'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">temp</span><span class="p">.</span><span class="n">columns</span><span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s">'_주문량'</span><span class="p">]</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">train_data</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">test_data</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(28303, 193)
(7076, 193)
(2891, 192)
</code></pre></div></div>

<h3 id="원하는-column-선택">원하는 column 선택</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s">'emb_label_주문량'</span><span class="p">,</span> <span class="s">'emb_label2_주문량'</span><span class="p">,</span> <span class="s">'emb_label3_주문량'</span><span class="p">,</span> <span class="s">'월_주문량'</span><span class="p">,</span> <span class="s">'요일_주문량'</span><span class="p">,</span> <span class="s">'시등급_주문량'</span><span class="p">,</span> <span class="s">'분등급_주문량'</span><span class="p">,</span><span class="s">'노출횟수_주문량'</span><span class="p">,</span> <span class="s">'판매단가'</span><span class="p">]</span>
</code></pre></div></div>

<h3 id="robust-scaling">Robust Scaling</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">RobustScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">RobustScaler</span><span class="p">()</span>

<span class="n">scaler</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

<span class="n">train_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="n">col</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="n">train_data</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">columns</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">RobustScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">RobustScaler</span><span class="p">()</span>

<span class="n">scaler</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

<span class="n">test_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">col</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="n">test_data</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">columns</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">RobustScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">RobustScaler</span><span class="p">()</span>

<span class="n">scaler</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

<span class="n">test</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">col</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="n">test</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">columns</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">col</span><span class="p">.</span><span class="n">extend</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">159</span><span class="p">)])</span>
<span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>168
</code></pre></div></div>

<h3 id="비어있는-값-평균으로-대체">비어있는 값 평균으로 대체</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 평균값으로 대체
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">col</span><span class="p">:</span>
    <span class="n">test_data</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">mean</span><span class="p">(),</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="독립변수-종속변수-분리">독립변수, 종속변수 분리</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s">'주문량'</span><span class="p">]</span>

<span class="n">X_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s">'주문량'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">y_train</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">X_test</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">y_test</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(28303, 168)
(28303,)
(7076, 168)
(7076,)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">.</span><span class="n">values</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="p">.</span><span class="n">values</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">.</span><span class="n">values</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="p">.</span><span class="n">values</span>
</code></pre></div></div>

<h2 id="모델링">모델링</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Activation</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Conv1D</span><span class="p">,</span> <span class="n">MaxPooling1D</span><span class="p">,</span> <span class="n">AveragePooling1D</span><span class="p">,</span> <span class="n">GlobalAveragePooling1D</span><span class="p">,</span> <span class="n">Conv1DTranspose</span><span class="p">,</span> <span class="n">concatenate</span><span class="p">,</span> <span class="n">Input</span><span class="p">,</span> <span class="n">add</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">BatchNormalization</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">Model</span>

<span class="k">def</span> <span class="nf">build_model</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="n">start_neurons</span><span class="p">):</span>
    
    <span class="n">conv1</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))(</span><span class="n">input_layer</span><span class="p">)</span>
    <span class="n">conv1</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">conv1</span><span class="p">)</span>
    <span class="n">pool1</span> <span class="o">=</span> <span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">conv1</span><span class="p">)</span>
    <span class="n">pool1</span> <span class="o">=</span> <span class="n">MaxPooling1D</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">pool1</span><span class="p">)</span>
    <span class="n">pool1</span> <span class="o">=</span> <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)(</span><span class="n">pool1</span><span class="p">)</span>

    <span class="n">conv2</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">pool1</span><span class="p">)</span>
    <span class="n">conv2</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">conv2</span><span class="p">)</span>
    <span class="n">pool2</span> <span class="o">=</span> <span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">conv2</span><span class="p">)</span>
    <span class="n">pool2</span> <span class="o">=</span> <span class="n">MaxPooling1D</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">pool2</span><span class="p">)</span>
    <span class="n">pool2</span> <span class="o">=</span> <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)(</span><span class="n">pool2</span><span class="p">)</span>

    <span class="n">conv3</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">pool2</span><span class="p">)</span>
    <span class="n">conv3</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">conv3</span><span class="p">)</span>
    <span class="n">pool3</span> <span class="o">=</span> <span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">conv3</span><span class="p">)</span>
    <span class="n">pool3</span> <span class="o">=</span> <span class="n">AveragePooling1D</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">pool3</span><span class="p">)</span>
    <span class="n">pool3</span> <span class="o">=</span> <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)(</span><span class="n">pool3</span><span class="p">)</span>


    <span class="n">convm</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">pool3</span><span class="p">)</span>

    <span class="n">deconv3</span> <span class="o">=</span> <span class="n">Conv1DTranspose</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">convm</span><span class="p">)</span>
    <span class="n">uconv3</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="n">deconv3</span><span class="p">,</span> <span class="n">conv3</span><span class="p">])</span>
    <span class="n">uconv3</span> <span class="o">=</span> <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.15</span><span class="p">)(</span><span class="n">uconv3</span><span class="p">)</span>
    <span class="n">uconv3</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">uconv3</span><span class="p">)</span>
    <span class="n">uconv3</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">uconv3</span><span class="p">)</span>
    <span class="n">uconv3</span> <span class="o">=</span> <span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">uconv3</span><span class="p">)</span>
    <span class="n">uconv3</span> <span class="o">=</span> <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)(</span><span class="n">uconv3</span><span class="p">)</span>

    <span class="n">deconv2</span> <span class="o">=</span> <span class="n">Conv1DTranspose</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">uconv3</span><span class="p">)</span>
    <span class="n">uconv2</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="n">deconv2</span><span class="p">,</span> <span class="n">conv2</span><span class="p">])</span>
    <span class="n">uconv2</span> <span class="o">=</span> <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)(</span><span class="n">uconv2</span><span class="p">)</span>
    <span class="n">uconv2</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">uconv2</span><span class="p">)</span>
    <span class="n">uconv2</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">uconv2</span><span class="p">)</span>
    <span class="n">uconv2</span> <span class="o">=</span> <span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">uconv2</span><span class="p">)</span>
    <span class="n">uconv2</span> <span class="o">=</span> <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)(</span><span class="n">uconv2</span><span class="p">)</span>

    <span class="n">deconv1</span> <span class="o">=</span> <span class="n">Conv1DTranspose</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">strides</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">uconv2</span><span class="p">)</span>
    <span class="n">uconv1</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="n">deconv1</span><span class="p">,</span> <span class="n">conv1</span><span class="p">])</span>
    <span class="n">uconv1</span> <span class="o">=</span> <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)(</span><span class="n">uconv1</span><span class="p">)</span>
    <span class="n">uconv1</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">uconv1</span><span class="p">)</span>
    <span class="n">uconv1</span> <span class="o">=</span> <span class="n">Conv1D</span><span class="p">(</span><span class="n">start_neurons</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">"elu"</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s">"same"</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s">'he_normal'</span><span class="p">)(</span><span class="n">uconv1</span><span class="p">)</span>
    <span class="n">uconv1</span> <span class="o">=</span> <span class="n">BatchNormalization</span><span class="p">()(</span><span class="n">uconv1</span><span class="p">)</span>
    <span class="n">uconv1</span> <span class="o">=</span> <span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)(</span><span class="n">uconv1</span><span class="p">)</span>

    <span class="n">flat</span> <span class="o">=</span> <span class="n">Flatten</span><span class="p">()(</span><span class="n">uconv1</span><span class="p">)</span>
    <span class="n">dense1</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'elu'</span><span class="p">)(</span><span class="n">flat</span><span class="p">)</span>
    <span class="n">dense2</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'elu'</span><span class="p">)(</span><span class="n">dense1</span><span class="p">)</span>
    <span class="n">output_layer</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">dense2</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">output_layer</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">input_layer</span> <span class="o">=</span> <span class="n">Input</span><span class="p">((</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">output_layer</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="n">output_layer</span><span class="p">)</span>

<span class="n">model</span><span class="p">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Model: "functional_1"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 168, 1)]     0                                            
__________________________________________________________________________________________________
conv1d (Conv1D)                 (None, 168, 128)     512         input_1[0][0]                    
__________________________________________________________________________________________________
conv1d_1 (Conv1D)               (None, 168, 128)     49280       conv1d[0][0]                     
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 168, 128)     512         conv1d_1[0][0]                   
__________________________________________________________________________________________________
max_pooling1d (MaxPooling1D)    (None, 84, 128)      0           batch_normalization[0][0]        
__________________________________________________________________________________________________
dropout (Dropout)               (None, 84, 128)      0           max_pooling1d[0][0]              
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, 84, 256)      98560       dropout[0][0]                    
__________________________________________________________________________________________________
conv1d_3 (Conv1D)               (None, 84, 256)      196864      conv1d_2[0][0]                   
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 84, 256)      1024        conv1d_3[0][0]                   
__________________________________________________________________________________________________
max_pooling1d_1 (MaxPooling1D)  (None, 42, 256)      0           batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dropout_1 (Dropout)             (None, 42, 256)      0           max_pooling1d_1[0][0]            
__________________________________________________________________________________________________
conv1d_4 (Conv1D)               (None, 42, 256)      196864      dropout_1[0][0]                  
__________________________________________________________________________________________________
conv1d_5 (Conv1D)               (None, 42, 256)      196864      conv1d_4[0][0]                   
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 42, 256)      1024        conv1d_5[0][0]                   
__________________________________________________________________________________________________
average_pooling1d (AveragePooli (None, 21, 256)      0           batch_normalization_2[0][0]      
__________________________________________________________________________________________________
dropout_2 (Dropout)             (None, 21, 256)      0           average_pooling1d[0][0]          
__________________________________________________________________________________________________
conv1d_6 (Conv1D)               (None, 21, 512)      393728      dropout_2[0][0]                  
__________________________________________________________________________________________________
conv1d_transpose (Conv1DTranspo (None, 42, 128)      196736      conv1d_6[0][0]                   
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 42, 384)      0           conv1d_transpose[0][0]           
                                                                 conv1d_5[0][0]                   
__________________________________________________________________________________________________
dropout_3 (Dropout)             (None, 42, 384)      0           concatenate[0][0]                
__________________________________________________________________________________________________
conv1d_7 (Conv1D)               (None, 42, 128)      147584      dropout_3[0][0]                  
__________________________________________________________________________________________________
conv1d_8 (Conv1D)               (None, 42, 128)      49280       conv1d_7[0][0]                   
__________________________________________________________________________________________________
batch_normalization_3 (BatchNor (None, 42, 128)      512         conv1d_8[0][0]                   
__________________________________________________________________________________________________
dropout_4 (Dropout)             (None, 42, 128)      0           batch_normalization_3[0][0]      
__________________________________________________________________________________________________
conv1d_transpose_1 (Conv1DTrans (None, 84, 128)      49280       dropout_4[0][0]                  
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 84, 384)      0           conv1d_transpose_1[0][0]         
                                                                 conv1d_3[0][0]                   
__________________________________________________________________________________________________
dropout_5 (Dropout)             (None, 84, 384)      0           concatenate_1[0][0]              
__________________________________________________________________________________________________
conv1d_9 (Conv1D)               (None, 84, 128)      147584      dropout_5[0][0]                  
__________________________________________________________________________________________________
conv1d_10 (Conv1D)              (None, 84, 128)      49280       conv1d_9[0][0]                   
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 84, 128)      512         conv1d_10[0][0]                  
__________________________________________________________________________________________________
dropout_6 (Dropout)             (None, 84, 128)      0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
conv1d_transpose_2 (Conv1DTrans (None, 168, 128)     49280       dropout_6[0][0]                  
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 168, 256)     0           conv1d_transpose_2[0][0]         
                                                                 conv1d_1[0][0]                   
__________________________________________________________________________________________________
dropout_7 (Dropout)             (None, 168, 256)     0           concatenate_2[0][0]              
__________________________________________________________________________________________________
conv1d_11 (Conv1D)              (None, 168, 128)     98432       dropout_7[0][0]                  
__________________________________________________________________________________________________
conv1d_12 (Conv1D)              (None, 168, 128)     49280       conv1d_11[0][0]                  
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 168, 128)     512         conv1d_12[0][0]                  
__________________________________________________________________________________________________
dropout_8 (Dropout)             (None, 168, 128)     0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
flatten (Flatten)               (None, 21504)        0           dropout_8[0][0]                  
__________________________________________________________________________________________________
dense (Dense)                   (None, 256)          5505280     flatten[0][0]                    
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 128)          32896       dense[0][0]                      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 1)            129         dense_1[0][0]                    
==================================================================================================
Total params: 7,511,809
Trainable params: 7,509,761
Non-trainable params: 2,048
__________________________________________________________________________________________________
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">keras.callbacks</span> <span class="kn">import</span> <span class="n">ModelCheckpoint</span>
<span class="kn">from</span> <span class="nn">keras</span> <span class="kn">import</span> <span class="n">optimizers</span>
<span class="kn">import</span> <span class="nn">keras.backend</span> <span class="k">as</span> <span class="n">K</span>

<span class="n">adam</span> <span class="o">=</span> <span class="n">optimizers</span><span class="p">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.0002</span><span class="p">,</span> <span class="n">beta_1</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">beta_2</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">decay</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">amsgrad</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">mape</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">K</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">K</span><span class="p">.</span><span class="nb">abs</span><span class="p">((</span><span class="n">y_pred</span> <span class="o">-</span> <span class="n">y_true</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_true</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="k">def</span> <span class="nf">compile_and_train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">num_epochs</span><span class="p">):</span> 
    <span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">adam</span><span class="p">,</span>
                  <span class="n">loss</span><span class="o">=</span><span class="n">mape</span><span class="p">,</span>
                  <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'mean_squared_error'</span><span class="p">])</span>  
    <span class="n">filepath</span> <span class="o">=</span> <span class="s">'drive/Shared drives/빅콘테스트2020/weights/ds/'</span> <span class="o">+</span> <span class="n">model</span><span class="p">.</span><span class="n">name</span> <span class="o">+</span> <span class="s">'.{epoch:02d}-{val_loss:.4f}.hdf5'</span>
    <span class="n">checkpoint</span> <span class="o">=</span> <span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="s">'val_loss'</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">save_weights_only</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">save_best_only</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'auto'</span><span class="p">)</span>
    <span class="n">model_history</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="n">num_epochs</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">checkpoint</span><span class="p">],</span> <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">model</span><span class="p">.</span><span class="n">history</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">_</span><span class="o">=</span><span class="n">compile_and_train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Epoch 1/50
885/885 [==============================] - 15s 17ms/step - loss: 72.0506 - mean_squared_error: 234444.2031 - val_loss: 61.1960 - val_mean_squared_error: 190769.1875
Epoch 2/50
885/885 [==============================] - 12s 13ms/step - loss: 54.1626 - mean_squared_error: 135448.0625 - val_loss: 49.1079 - val_mean_squared_error: 100337.9141
Epoch 3/50
885/885 [==============================] - 11s 13ms/step - loss: 47.3490 - mean_squared_error: 94437.4453 - val_loss: 45.5351 - val_mean_squared_error: 79575.7578
Epoch 4/50
885/885 [==============================] - 12s 13ms/step - loss: 44.0135 - mean_squared_error: 79859.2656 - val_loss: 43.8869 - val_mean_squared_error: 68972.0781
Epoch 5/50
885/885 [==============================] - 11s 13ms/step - loss: 42.0960 - mean_squared_error: 71360.8359 - val_loss: 41.7467 - val_mean_squared_error: 66719.9375
Epoch 6/50
885/885 [==============================] - 11s 13ms/step - loss: 41.1415 - mean_squared_error: 67721.0156 - val_loss: 41.3399 - val_mean_squared_error: 58520.4336
Epoch 7/50
885/885 [==============================] - 11s 13ms/step - loss: 40.1173 - mean_squared_error: 64727.7852 - val_loss: 40.2029 - val_mean_squared_error: 56525.2500
Epoch 8/50
885/885 [==============================] - 11s 13ms/step - loss: 39.1574 - mean_squared_error: 61619.9492 - val_loss: 39.9463 - val_mean_squared_error: 52776.7656
Epoch 9/50
885/885 [==============================] - 11s 13ms/step - loss: 38.4144 - mean_squared_error: 59078.5977 - val_loss: 39.8683 - val_mean_squared_error: 53505.7383
Epoch 10/50
885/885 [==============================] - 11s 13ms/step - loss: 37.8804 - mean_squared_error: 57405.5273 - val_loss: 38.9853 - val_mean_squared_error: 48913.6523
Epoch 11/50
885/885 [==============================] - 11s 13ms/step - loss: 37.2552 - mean_squared_error: 56105.9414 - val_loss: 39.4120 - val_mean_squared_error: 48378.4062
Epoch 12/50
885/885 [==============================] - 11s 13ms/step - loss: 36.7965 - mean_squared_error: 54459.7109 - val_loss: 38.2957 - val_mean_squared_error: 52089.9375
Epoch 13/50
885/885 [==============================] - 11s 13ms/step - loss: 36.2845 - mean_squared_error: 52827.2578 - val_loss: 40.1860 - val_mean_squared_error: 50487.9414
Epoch 14/50
885/885 [==============================] - 11s 13ms/step - loss: 35.8560 - mean_squared_error: 51796.0898 - val_loss: 38.3331 - val_mean_squared_error: 51249.4102
Epoch 15/50
885/885 [==============================] - 11s 13ms/step - loss: 35.3632 - mean_squared_error: 51349.4727 - val_loss: 37.7870 - val_mean_squared_error: 49001.3984
Epoch 16/50
885/885 [==============================] - 11s 13ms/step - loss: 35.0045 - mean_squared_error: 49887.8164 - val_loss: 37.4562 - val_mean_squared_error: 44092.1875
Epoch 17/50
885/885 [==============================] - 11s 12ms/step - loss: 34.6247 - mean_squared_error: 48738.2031 - val_loss: 38.2878 - val_mean_squared_error: 41336.3516
Epoch 18/50
885/885 [==============================] - 11s 13ms/step - loss: 34.1496 - mean_squared_error: 47793.4805 - val_loss: 37.1594 - val_mean_squared_error: 45582.0234
Epoch 19/50
885/885 [==============================] - 11s 12ms/step - loss: 33.9325 - mean_squared_error: 46562.1328 - val_loss: 37.9922 - val_mean_squared_error: 41560.4531
Epoch 20/50
885/885 [==============================] - 12s 13ms/step - loss: 33.5639 - mean_squared_error: 47068.8789 - val_loss: 37.0304 - val_mean_squared_error: 43149.8711
Epoch 21/50
885/885 [==============================] - 11s 12ms/step - loss: 33.3884 - mean_squared_error: 46241.5781 - val_loss: 37.5516 - val_mean_squared_error: 43254.2461
Epoch 22/50
885/885 [==============================] - 11s 13ms/step - loss: 33.1104 - mean_squared_error: 45609.0898 - val_loss: 36.7937 - val_mean_squared_error: 44383.8516
Epoch 23/50
885/885 [==============================] - 11s 13ms/step - loss: 32.6400 - mean_squared_error: 44881.6992 - val_loss: 36.8421 - val_mean_squared_error: 41828.2227
Epoch 24/50
885/885 [==============================] - 12s 14ms/step - loss: 32.4107 - mean_squared_error: 43639.3789 - val_loss: 37.6604 - val_mean_squared_error: 40397.3789
Epoch 25/50
885/885 [==============================] - 12s 13ms/step - loss: 32.2566 - mean_squared_error: 43842.2109 - val_loss: 36.4007 - val_mean_squared_error: 40288.7461
Epoch 26/50
885/885 [==============================] - 11s 13ms/step - loss: 32.0389 - mean_squared_error: 43110.4766 - val_loss: 36.6331 - val_mean_squared_error: 41046.0234
Epoch 27/50
885/885 [==============================] - 11s 13ms/step - loss: 31.8357 - mean_squared_error: 42669.5742 - val_loss: 36.7838 - val_mean_squared_error: 43534.1133
Epoch 28/50
885/885 [==============================] - 11s 13ms/step - loss: 31.5333 - mean_squared_error: 42252.8633 - val_loss: 36.4919 - val_mean_squared_error: 38932.3750
Epoch 29/50
885/885 [==============================] - 11s 13ms/step - loss: 31.2561 - mean_squared_error: 41602.4922 - val_loss: 36.4576 - val_mean_squared_error: 41832.2969
Epoch 30/50
885/885 [==============================] - 11s 13ms/step - loss: 31.0332 - mean_squared_error: 41261.7852 - val_loss: 36.6560 - val_mean_squared_error: 38453.8750
Epoch 31/50
885/885 [==============================] - 11s 13ms/step - loss: 30.7985 - mean_squared_error: 41094.7539 - val_loss: 36.8772 - val_mean_squared_error: 37594.9336
Epoch 32/50
885/885 [==============================] - 11s 13ms/step - loss: 30.6786 - mean_squared_error: 40779.6016 - val_loss: 37.0396 - val_mean_squared_error: 38687.1172
Epoch 33/50
885/885 [==============================] - 11s 13ms/step - loss: 30.4793 - mean_squared_error: 40117.2695 - val_loss: 36.4555 - val_mean_squared_error: 38903.3047
Epoch 34/50
885/885 [==============================] - 12s 13ms/step - loss: 30.2910 - mean_squared_error: 40149.5078 - val_loss: 36.7116 - val_mean_squared_error: 38447.3633
Epoch 35/50
885/885 [==============================] - 11s 13ms/step - loss: 30.0343 - mean_squared_error: 39446.6641 - val_loss: 37.0447 - val_mean_squared_error: 36690.2109
Epoch 36/50
885/885 [==============================] - 11s 13ms/step - loss: 29.8964 - mean_squared_error: 39361.0469 - val_loss: 36.9854 - val_mean_squared_error: 34572.7852
Epoch 37/50
885/885 [==============================] - 11s 12ms/step - loss: 29.8083 - mean_squared_error: 38438.1875 - val_loss: 37.4272 - val_mean_squared_error: 38197.5430
Epoch 38/50
885/885 [==============================] - 11s 13ms/step - loss: 29.5378 - mean_squared_error: 38513.3203 - val_loss: 36.8323 - val_mean_squared_error: 37720.9453
Epoch 39/50
885/885 [==============================] - 11s 13ms/step - loss: 29.4717 - mean_squared_error: 37744.6367 - val_loss: 37.7488 - val_mean_squared_error: 35258.0273
Epoch 40/50
885/885 [==============================] - 12s 13ms/step - loss: 29.1888 - mean_squared_error: 37239.0156 - val_loss: 36.9798 - val_mean_squared_error: 36627.8477
Epoch 41/50
885/885 [==============================] - 12s 13ms/step - loss: 28.9853 - mean_squared_error: 37188.5273 - val_loss: 36.7871 - val_mean_squared_error: 37009.3984
Epoch 42/50
885/885 [==============================] - 12s 13ms/step - loss: 28.7947 - mean_squared_error: 36458.3516 - val_loss: 36.2778 - val_mean_squared_error: 36043.4922
Epoch 43/50
885/885 [==============================] - 12s 13ms/step - loss: 28.7667 - mean_squared_error: 36105.4961 - val_loss: 36.0185 - val_mean_squared_error: 36986.2148
Epoch 44/50
885/885 [==============================] - 11s 13ms/step - loss: 28.5003 - mean_squared_error: 36118.9648 - val_loss: 37.2940 - val_mean_squared_error: 41636.2773
Epoch 45/50
885/885 [==============================] - 11s 13ms/step - loss: 28.3166 - mean_squared_error: 35577.6602 - val_loss: 36.6263 - val_mean_squared_error: 34687.6289
Epoch 46/50
885/885 [==============================] - 11s 13ms/step - loss: 28.3254 - mean_squared_error: 35129.7461 - val_loss: 36.9247 - val_mean_squared_error: 36397.6758
Epoch 47/50
885/885 [==============================] - 11s 13ms/step - loss: 28.1238 - mean_squared_error: 35144.0234 - val_loss: 37.2090 - val_mean_squared_error: 33549.1289
Epoch 48/50
885/885 [==============================] - 11s 13ms/step - loss: 28.0206 - mean_squared_error: 34771.5195 - val_loss: 37.0418 - val_mean_squared_error: 33304.5273
Epoch 49/50
885/885 [==============================] - 11s 13ms/step - loss: 27.7911 - mean_squared_error: 34031.4844 - val_loss: 37.1774 - val_mean_squared_error: 32926.2109
Epoch 50/50
885/885 [==============================] - 11s 12ms/step - loss: 27.6829 - mean_squared_error: 34390.3984 - val_loss: 37.1884 - val_mean_squared_error: 32546.9590
</code></pre></div></div>

<h2 id="test-취급액-예측">test 취급액 예측</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>방송일시</th>
      <th>노출(분)</th>
      <th>마더코드</th>
      <th>상품코드</th>
      <th>상품명</th>
      <th>상품군</th>
      <th>판매단가</th>
      <th>취급액</th>
      <th>날짜</th>
      <th>시</th>
      <th>분</th>
      <th>요일</th>
      <th>휴일</th>
      <th>season</th>
      <th>노출횟수</th>
      <th>판매단가등급</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>...</th>
      <th>135</th>
      <th>136</th>
      <th>137</th>
      <th>138</th>
      <th>139</th>
      <th>140</th>
      <th>141</th>
      <th>142</th>
      <th>143</th>
      <th>144</th>
      <th>145</th>
      <th>146</th>
      <th>147</th>
      <th>148</th>
      <th>149</th>
      <th>150</th>
      <th>151</th>
      <th>152</th>
      <th>153</th>
      <th>154</th>
      <th>155</th>
      <th>156</th>
      <th>157</th>
      <th>158</th>
      <th>159</th>
      <th>emb_label</th>
      <th>emb_label2</th>
      <th>emb_label3</th>
      <th>월</th>
      <th>일</th>
      <th>시등급</th>
      <th>분등급</th>
      <th>emb_label_주문량</th>
      <th>emb_label2_주문량</th>
      <th>emb_label3_주문량</th>
      <th>월_주문량</th>
      <th>시등급_주문량</th>
      <th>분등급_주문량</th>
      <th>요일_주문량</th>
      <th>노출횟수_주문량</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-06-01 06:20:00</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>-0.04</td>
      <td>NaN</td>
      <td>2020-06-01</td>
      <td>6</td>
      <td>20</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>-0.04</td>
      <td>2.42</td>
      <td>-1.72</td>
      <td>-0.56</td>
      <td>-1.86</td>
      <td>-0.09</td>
      <td>-2.14</td>
      <td>-0.58</td>
      <td>-0.61</td>
      <td>3.23</td>
      <td>-0.29</td>
      <td>0.11</td>
      <td>-0.29</td>
      <td>-0.47</td>
      <td>0.44</td>
      <td>-0.56</td>
      <td>0.24</td>
      <td>1.54</td>
      <td>-1.12</td>
      <td>-0.68</td>
      <td>1.24</td>
      <td>-1.39</td>
      <td>-1.66</td>
      <td>2.01</td>
      <td>...</td>
      <td>0.25</td>
      <td>-0.66</td>
      <td>-0.30</td>
      <td>-0.36</td>
      <td>0.69</td>
      <td>0.93</td>
      <td>0.63</td>
      <td>-0.46</td>
      <td>-0.38</td>
      <td>0.94</td>
      <td>-0.98</td>
      <td>0.54</td>
      <td>-0.43</td>
      <td>0.30</td>
      <td>-1.25</td>
      <td>1.34</td>
      <td>-0.52</td>
      <td>0.64</td>
      <td>-1.54</td>
      <td>0.68</td>
      <td>-1.14</td>
      <td>0.66</td>
      <td>0.28</td>
      <td>-0.24</td>
      <td>-1.21</td>
      <td>2</td>
      <td>83</td>
      <td>83</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>-0.54</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-06-01 06:40:00</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>-0.04</td>
      <td>NaN</td>
      <td>2020-06-01</td>
      <td>6</td>
      <td>40</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>-0.04</td>
      <td>2.42</td>
      <td>-1.72</td>
      <td>-0.56</td>
      <td>-1.86</td>
      <td>-0.09</td>
      <td>-2.14</td>
      <td>-0.58</td>
      <td>-0.61</td>
      <td>3.23</td>
      <td>-0.29</td>
      <td>0.11</td>
      <td>-0.29</td>
      <td>-0.47</td>
      <td>0.44</td>
      <td>-0.56</td>
      <td>0.24</td>
      <td>1.54</td>
      <td>-1.12</td>
      <td>-0.68</td>
      <td>1.24</td>
      <td>-1.39</td>
      <td>-1.66</td>
      <td>2.01</td>
      <td>...</td>
      <td>0.25</td>
      <td>-0.66</td>
      <td>-0.30</td>
      <td>-0.36</td>
      <td>0.69</td>
      <td>0.93</td>
      <td>0.63</td>
      <td>-0.46</td>
      <td>-0.38</td>
      <td>0.94</td>
      <td>-0.98</td>
      <td>0.54</td>
      <td>-0.43</td>
      <td>0.30</td>
      <td>-1.25</td>
      <td>1.34</td>
      <td>-0.52</td>
      <td>0.64</td>
      <td>-1.54</td>
      <td>0.68</td>
      <td>-1.14</td>
      <td>0.66</td>
      <td>0.28</td>
      <td>-0.24</td>
      <td>-1.21</td>
      <td>2</td>
      <td>83</td>
      <td>83</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-06-01 07:00:00</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>-0.04</td>
      <td>NaN</td>
      <td>2020-06-01</td>
      <td>7</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>-0.04</td>
      <td>2.42</td>
      <td>-1.72</td>
      <td>-0.56</td>
      <td>-1.86</td>
      <td>-0.09</td>
      <td>-2.14</td>
      <td>-0.58</td>
      <td>-0.61</td>
      <td>3.23</td>
      <td>-0.29</td>
      <td>0.11</td>
      <td>-0.29</td>
      <td>-0.47</td>
      <td>0.44</td>
      <td>-0.56</td>
      <td>0.24</td>
      <td>1.54</td>
      <td>-1.12</td>
      <td>-0.68</td>
      <td>1.24</td>
      <td>-1.39</td>
      <td>-1.66</td>
      <td>2.01</td>
      <td>...</td>
      <td>0.25</td>
      <td>-0.66</td>
      <td>-0.30</td>
      <td>-0.36</td>
      <td>0.69</td>
      <td>0.93</td>
      <td>0.63</td>
      <td>-0.46</td>
      <td>-0.38</td>
      <td>0.94</td>
      <td>-0.98</td>
      <td>0.54</td>
      <td>-0.43</td>
      <td>0.30</td>
      <td>-1.25</td>
      <td>1.34</td>
      <td>-0.52</td>
      <td>0.64</td>
      <td>-1.54</td>
      <td>0.68</td>
      <td>-1.14</td>
      <td>0.66</td>
      <td>0.28</td>
      <td>-0.24</td>
      <td>-1.21</td>
      <td>2</td>
      <td>83</td>
      <td>83</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.00</td>
      <td>0.06</td>
      <td>0.06</td>
      <td>0.00</td>
      <td>0.38</td>
      <td>-1.00</td>
      <td>0.00</td>
      <td>0.46</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-06-01 07:20:00</td>
      <td>20</td>
      <td>100445</td>
      <td>202278</td>
      <td>쿠미투니카 쿨 레이시 란쥬쉐이퍼&amp;팬티</td>
      <td>속옷</td>
      <td>-0.02</td>
      <td>NaN</td>
      <td>2020-06-01</td>
      <td>7</td>
      <td>20</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0.14</td>
      <td>0.19</td>
      <td>-0.03</td>
      <td>3.75</td>
      <td>0.34</td>
      <td>-0.61</td>
      <td>-0.34</td>
      <td>2.96</td>
      <td>-0.83</td>
      <td>-1.10</td>
      <td>0.43</td>
      <td>0.12</td>
      <td>0.87</td>
      <td>0.65</td>
      <td>0.52</td>
      <td>0.16</td>
      <td>-2.10</td>
      <td>-2.93</td>
      <td>1.02</td>
      <td>3.78</td>
      <td>2.22</td>
      <td>2.51</td>
      <td>-1.18</td>
      <td>6.25</td>
      <td>...</td>
      <td>-0.62</td>
      <td>2.32</td>
      <td>0.25</td>
      <td>1.94</td>
      <td>3.35</td>
      <td>-1.84</td>
      <td>-1.94</td>
      <td>1.55</td>
      <td>2.49</td>
      <td>0.84</td>
      <td>-1.02</td>
      <td>-0.12</td>
      <td>1.81</td>
      <td>-3.09</td>
      <td>1.88</td>
      <td>2.00</td>
      <td>2.28</td>
      <td>2.64</td>
      <td>3.29</td>
      <td>-3.85</td>
      <td>-3.58</td>
      <td>2.44</td>
      <td>0.58</td>
      <td>-0.69</td>
      <td>-3.07</td>
      <td>2</td>
      <td>49</td>
      <td>49</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.49</td>
      <td>0.49</td>
      <td>0.00</td>
      <td>0.38</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>-0.54</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-06-01 07:40:00</td>
      <td>20</td>
      <td>100445</td>
      <td>202278</td>
      <td>쿠미투니카 쿨 레이시 란쥬쉐이퍼&amp;팬티</td>
      <td>속옷</td>
      <td>-0.02</td>
      <td>NaN</td>
      <td>2020-06-01</td>
      <td>7</td>
      <td>40</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0.14</td>
      <td>0.19</td>
      <td>-0.03</td>
      <td>3.75</td>
      <td>0.34</td>
      <td>-0.61</td>
      <td>-0.34</td>
      <td>2.96</td>
      <td>-0.83</td>
      <td>-1.10</td>
      <td>0.43</td>
      <td>0.12</td>
      <td>0.87</td>
      <td>0.65</td>
      <td>0.52</td>
      <td>0.16</td>
      <td>-2.10</td>
      <td>-2.93</td>
      <td>1.02</td>
      <td>3.78</td>
      <td>2.22</td>
      <td>2.51</td>
      <td>-1.18</td>
      <td>6.25</td>
      <td>...</td>
      <td>-0.62</td>
      <td>2.32</td>
      <td>0.25</td>
      <td>1.94</td>
      <td>3.35</td>
      <td>-1.84</td>
      <td>-1.94</td>
      <td>1.55</td>
      <td>2.49</td>
      <td>0.84</td>
      <td>-1.02</td>
      <td>-0.12</td>
      <td>1.81</td>
      <td>-3.09</td>
      <td>1.88</td>
      <td>2.00</td>
      <td>2.28</td>
      <td>2.64</td>
      <td>3.29</td>
      <td>-3.85</td>
      <td>-3.58</td>
      <td>2.44</td>
      <td>0.58</td>
      <td>-0.69</td>
      <td>-3.07</td>
      <td>2</td>
      <td>49</td>
      <td>49</td>
      <td>6</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0.00</td>
      <td>0.49</td>
      <td>0.49</td>
      <td>0.00</td>
      <td>0.38</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 191 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># model 생성
</span><span class="n">input_layer</span> <span class="o">=</span> <span class="n">Input</span><span class="p">((</span><span class="n">test</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">output_layer</span> <span class="o">=</span> <span class="n">build_model</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="n">output_layer</span><span class="p">)</span>

<span class="c1"># model 가중치 불러오기
</span><span class="n">model</span><span class="p">.</span><span class="n">load_weights</span><span class="p">(</span><span class="s">'drive/Shared drives/빅콘테스트2020/weights/ds/functional_1.43-36.0185.hdf5'</span><span class="p">)</span>


<span class="c1"># model2 = Model(input_layer, output_layer)
# model2.load_weights('')
</span>
<span class="c1"># 주문량 예측
</span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">real_test</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]</span> <span class="o">=</span> <span class="n">real_test</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">].</span><span class="n">astype</span><span class="p">(</span><span class="s">'int'</span><span class="p">)</span>

<span class="n">real_test</span><span class="p">[</span><span class="s">'취급액'</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">real_test</span><span class="p">[</span><span class="s">'판매단가'</span><span class="p">]</span>
<span class="n">real_test</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>방송일시</th>
      <th>노출(분)</th>
      <th>마더코드</th>
      <th>상품코드</th>
      <th>상품명</th>
      <th>상품군</th>
      <th>판매단가</th>
      <th>취급액</th>
      <th>날짜</th>
      <th>시</th>
      <th>분</th>
      <th>요일</th>
      <th>휴일</th>
      <th>season</th>
      <th>노출횟수</th>
      <th>판매단가등급</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2020-06-01 06:20:00</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59800</td>
      <td>10715700.84</td>
      <td>2020-06-01</td>
      <td>6</td>
      <td>20</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-06-01 06:40:00</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59800</td>
      <td>16863828.12</td>
      <td>2020-06-01</td>
      <td>6</td>
      <td>40</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-06-01 07:00:00</td>
      <td>20</td>
      <td>100650</td>
      <td>201971</td>
      <td>잭필드 남성  반팔셔츠 4종</td>
      <td>의류</td>
      <td>59800</td>
      <td>28546873.53</td>
      <td>2020-06-01</td>
      <td>7</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-06-01 07:20:00</td>
      <td>20</td>
      <td>100445</td>
      <td>202278</td>
      <td>쿠미투니카 쿨 레이시 란쥬쉐이퍼&amp;팬티</td>
      <td>속옷</td>
      <td>69900</td>
      <td>17404280.86</td>
      <td>2020-06-01</td>
      <td>7</td>
      <td>20</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020-06-01 07:40:00</td>
      <td>20</td>
      <td>100445</td>
      <td>202278</td>
      <td>쿠미투니카 쿨 레이시 란쥬쉐이퍼&amp;팬티</td>
      <td>속옷</td>
      <td>69900</td>
      <td>29564540.76</td>
      <td>2020-06-01</td>
      <td>7</td>
      <td>40</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2887</th>
      <td>2020-07-01 00:20:00</td>
      <td>20</td>
      <td>100660</td>
      <td>201989</td>
      <td>쉴렉스  안마의자 렌탈서비스</td>
      <td>무형</td>
      <td>0</td>
      <td>0.00</td>
      <td>2020-07-01</td>
      <td>0</td>
      <td>20</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2888</th>
      <td>2020-07-01 00:40:00</td>
      <td>20</td>
      <td>100660</td>
      <td>201989</td>
      <td>쉴렉스  안마의자 렌탈서비스</td>
      <td>무형</td>
      <td>0</td>
      <td>0.00</td>
      <td>2020-07-01</td>
      <td>0</td>
      <td>40</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2889</th>
      <td>2020-07-01 01:00:00</td>
      <td>20</td>
      <td>100660</td>
      <td>201989</td>
      <td>쉴렉스  안마의자 렌탈서비스</td>
      <td>무형</td>
      <td>0</td>
      <td>0.00</td>
      <td>2020-07-01</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2890</th>
      <td>2020-07-01 01:20:00</td>
      <td>20</td>
      <td>100261</td>
      <td>200875</td>
      <td>아놀드파마 티셔츠레깅스세트</td>
      <td>의류</td>
      <td>69900</td>
      <td>7021285.20</td>
      <td>2020-07-01</td>
      <td>1</td>
      <td>20</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2891</th>
      <td>2020-07-01 01:40:00</td>
      <td>16</td>
      <td>100261</td>
      <td>200875</td>
      <td>아놀드파마 티셔츠레깅스세트</td>
      <td>의류</td>
      <td>69900</td>
      <td>9228077.77</td>
      <td>2020-07-01</td>
      <td>1</td>
      <td>40</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>2891 rows × 16 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">real_test</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"/content/drive/Shared drives/빅콘테스트2020/data/sample_submit"</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

    



<div class="post-tags">
  
    
    <a href="/tags.html#python">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">python</span>
    </a>
  
    
    <a href="/tags.html#deep-learning">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">deep learning</span>
    </a>
  
    
    <a href="/tags.html#cnn">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">CNN</span>
    </a>
  
    
    <a href="/tags.html#bipartite-graph-matching-alogirthm">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Bipartite Graph Matching Alogirthm</span>
    </a>
  
    
    <a href="/tags.html#genetic-algorithm">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Genetic Algorithm</span>
    </a>
  
</div>
  </div>

  
  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
    
      <li>
        <h3>
          <a href="/2021/06/13/OpenCV-Python-%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0.html">
            OpenCV-Python 시작하기
            <small>13 Jun 2021</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/09/28/03_Maximum_Sales_Probability_Matching_Algorithm.html">
            2020 Big Contest - 3
            <small>28 Sep 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/09/28/01_MSPMA_design.html">
            2020 Big Contest - 1
            <small>28 Sep 2020</small>
          </a>
        </h3>
      </li>
    
  </ul>
</section>

</div>

    </main>

    <!-- Optional footer content -->

  </body>
</html>
