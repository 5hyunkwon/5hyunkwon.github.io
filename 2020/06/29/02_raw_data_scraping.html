<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="https://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      Year Prediction by Movie Posters using CNN - 2 &middot; Data Flows in You
    
  </title>

  


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://5hyunkwon.github.io/favicon.png" />
<link rel="shortcut icon" href="https://5hyunkwon.github.io/favicon.png" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Additional head bits without overriding original head -->
</head>


  <body class="post">

    <div id="sidebar">
  <header>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        Data Flows in You
      </a>
    </div>
    <p class="lead"><a href="https://en.wikipedia.org/wiki/Data_science" target="_blank">Data Scientist</a>: The Sexiest Job of the 21st Century</p>
  </header>
  <nav id="sidebar-nav-links">
  
    <a class="home-link "
        href="/">Home</a>
  
  

  

  


  
    
  

  
    
      <a class="page-link "
          href="/about.html">About</a>
    
  

  
    
  

  

  
    
  

  
    
  

  

  
    
  

  
    
  


  


  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  

  
    
  

  
    
  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  

  <nav id="sidebar-icon-links">
  
  
  
  

  
    <a id="tags-link"
       class="icon"
       title="Tags" aria-label="Tags"
       href="/tags.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
    </a>
  

  <a id="github-link"
    class="icon" title="Github" aria-label="Github"
    href="https://github.com/5hyunkwon"
    target="_blank">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 28" height="24" width="28"><path d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-0.609 0.109-0.828-0.266-0.828-0.578 0-0.391 0.016-1.687 0.016-3.297 0-1.125-0.375-1.844-0.812-2.219 2.672-0.297 5.484-1.313 5.484-5.922 0-1.313-0.469-2.375-1.234-3.219 0.125-0.313 0.531-1.531-0.125-3.187-1-0.313-3.297 1.234-3.297 1.234-0.953-0.266-1.984-0.406-3-0.406s-2.047 0.141-3 0.406c0 0-2.297-1.547-3.297-1.234-0.656 1.656-0.25 2.875-0.125 3.187-0.766 0.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-0.344 0.313-0.656 0.844-0.766 1.609-0.688 0.313-2.438 0.844-3.484-1-0.656-1.141-1.844-1.234-1.844-1.234-1.172-0.016-0.078 0.734-0.078 0.734 0.781 0.359 1.328 1.75 1.328 1.75 0.703 2.141 4.047 1.422 4.047 1.422 0 1 0.016 1.937 0.016 2.234 0 0.313-0.219 0.688-0.828 0.578-4.766-1.594-8.203-6.094-8.203-11.391 0-6.625 5.375-12 12-12zM4.547 19.234c0.031-0.063-0.016-0.141-0.109-0.187-0.094-0.031-0.172-0.016-0.203 0.031-0.031 0.063 0.016 0.141 0.109 0.187 0.078 0.047 0.172 0.031 0.203-0.031zM5.031 19.766c0.063-0.047 0.047-0.156-0.031-0.25-0.078-0.078-0.187-0.109-0.25-0.047-0.063 0.047-0.047 0.156 0.031 0.25 0.078 0.078 0.187 0.109 0.25 0.047zM5.5 20.469c0.078-0.063 0.078-0.187 0-0.297-0.063-0.109-0.187-0.156-0.266-0.094-0.078 0.047-0.078 0.172 0 0.281s0.203 0.156 0.266 0.109zM6.156 21.125c0.063-0.063 0.031-0.203-0.063-0.297-0.109-0.109-0.25-0.125-0.313-0.047-0.078 0.063-0.047 0.203 0.063 0.297 0.109 0.109 0.25 0.125 0.313 0.047zM7.047 21.516c0.031-0.094-0.063-0.203-0.203-0.25-0.125-0.031-0.266 0.016-0.297 0.109s0.063 0.203 0.203 0.234c0.125 0.047 0.266 0 0.297-0.094zM8.031 21.594c0-0.109-0.125-0.187-0.266-0.172-0.141 0-0.25 0.078-0.25 0.172 0 0.109 0.109 0.187 0.266 0.172 0.141 0 0.25-0.078 0.25-0.172zM8.937 21.438c-0.016-0.094-0.141-0.156-0.281-0.141-0.141 0.031-0.234 0.125-0.219 0.234 0.016 0.094 0.141 0.156 0.281 0.125s0.234-0.125 0.219-0.219z"></path>
</svg>

  </a>

  <!-- Optional additional links to insert for icons links -->
<a id="facebook-link"
   class="icon" title="Facebook" aria-label="Facebook"
   href="https://www.facebook.com/5hyunkwon"
   target="_blank">
   <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M22.675 0h-21.35c-.732 0-1.325.593-1.325 1.325v21.351c0 .731.593 1.324 1.325 1.324h11.495v-9.294h-3.128v-3.622h3.128v-2.671c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12v9.293h6.116c.73 0 1.323-.593 1.323-1.325v-21.35c0-.732-.593-1.325-1.325-1.325z"/></svg>
</a>

<a id="instagram-link"
   class="icon" title="Instagram" aria-label="Instagram"
   href="https://www.instagram.com/5hyun_kwon/"
   target="_blank">
   <svg xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" viewBox="0 0 24 24"><path d="M17.34,5.46h0a1.2,1.2,0,1,0,1.2,1.2A1.2,1.2,0,0,0,17.34,5.46Zm4.6,2.42a7.59,7.59,0,0,0-.46-2.43,4.94,4.94,0,0,0-1.16-1.77,4.7,4.7,0,0,0-1.77-1.15,7.3,7.3,0,0,0-2.43-.47C15.06,2,14.72,2,12,2s-3.06,0-4.12.06a7.3,7.3,0,0,0-2.43.47A4.78,4.78,0,0,0,3.68,3.68,4.7,4.7,0,0,0,2.53,5.45a7.3,7.3,0,0,0-.47,2.43C2,8.94,2,9.28,2,12s0,3.06.06,4.12a7.3,7.3,0,0,0,.47,2.43,4.7,4.7,0,0,0,1.15,1.77,4.78,4.78,0,0,0,1.77,1.15,7.3,7.3,0,0,0,2.43.47C8.94,22,9.28,22,12,22s3.06,0,4.12-.06a7.3,7.3,0,0,0,2.43-.47,4.7,4.7,0,0,0,1.77-1.15,4.85,4.85,0,0,0,1.16-1.77,7.59,7.59,0,0,0,.46-2.43c0-1.06.06-1.4.06-4.12S22,8.94,21.94,7.88ZM20.14,16a5.61,5.61,0,0,1-.34,1.86,3.06,3.06,0,0,1-.75,1.15,3.19,3.19,0,0,1-1.15.75,5.61,5.61,0,0,1-1.86.34c-1,.05-1.37.06-4,.06s-3,0-4-.06A5.73,5.73,0,0,1,6.1,19.8,3.27,3.27,0,0,1,5,19.05a3,3,0,0,1-.74-1.15A5.54,5.54,0,0,1,3.86,16c0-1-.06-1.37-.06-4s0-3,.06-4A5.54,5.54,0,0,1,4.21,6.1,3,3,0,0,1,5,5,3.14,3.14,0,0,1,6.1,4.2,5.73,5.73,0,0,1,8,3.86c1,0,1.37-.06,4-.06s3,0,4,.06a5.61,5.61,0,0,1,1.86.34A3.06,3.06,0,0,1,19.05,5,3.06,3.06,0,0,1,19.8,6.1,5.61,5.61,0,0,1,20.14,8c.05,1,.06,1.37.06,4S20.19,15,20.14,16ZM12,6.87A5.13,5.13,0,1,0,17.14,12,5.12,5.12,0,0,0,12,6.87Zm0,8.46A3.33,3.33,0,1,1,15.33,12,3.33,3.33,0,0,1,12,15.33Z"/></svg>
</a>

<a id="linkedin-link"
   class="icon" title="Linkedin" aria-label="Linkedin"
   href="https://www.linkedin.com/in/5hyunkwon/"
   target="_blank">
   <svg xmlns="http://www.w3.org/2000/svg" data-name="Layer 1" viewBox="0 0 24 24"><path d="M20.47,2H3.53A1.45,1.45,0,0,0,2.06,3.43V20.57A1.45,1.45,0,0,0,3.53,22H20.47a1.45,1.45,0,0,0,1.47-1.43V3.43A1.45,1.45,0,0,0,20.47,2ZM8.09,18.74h-3v-9h3ZM6.59,8.48h0a1.56,1.56,0,1,1,0-3.12,1.57,1.57,0,1,1,0,3.12ZM18.91,18.74h-3V13.91c0-1.21-.43-2-1.52-2A1.65,1.65,0,0,0,12.85,13a2,2,0,0,0-.1.73v5h-3s0-8.18,0-9h3V11A3,3,0,0,1,15.46,9.5c2,0,3.45,1.29,3.45,4.06Z"/></svg>
</a>
</nav>

  <p>
  &copy; 2021.
  <a href="/LICENSE.md">MIT License.</a>
</p>

</div>

    <main class="container">
      <header>
  <h1 class="post-title">Year Prediction by Movie Posters using CNN - 2</h1>
</header>
<div class="content">
  <div class="post-meta">
  <span class="post-date">29 Jun 2020</span>
  <span class="post-categories">
    
  </span>
</div>


  <div class="post-body">
    <h2 id="1-raw-data-scraping">1. Raw Data Scraping</h2>

<p><code class="highlighter-rouge">Local PC</code>에서 작업</p>

<h3 id="load-packages">Load Packages</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">request</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">time</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tqdm</span><span class="p">().</span><span class="n">pandas</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0it [00:00, ?it/s][A[A[A[A
/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/tqdm/std.py:658: FutureWarning: The Panel class is removed from pandas. Accessing it from the top-level namespace will also be removed in the next version
  from pandas import Panel
</code></pre></div></div>

<p><strong>Scraping Order</strong></p>

<ol>
  <li>각 장르별로 데이터프레임을 따로 구성 (총 7개의 데이터프레임, 각각 200개 레코드 존재)</li>
  <li>한 데이터프레임 내에는 영화 코드, 한글 제목, 영어 제목, 연도, 네티즌 평점, 등급, 링크, 이미지, 장르 존재</li>
  <li>상세 정보를 가져오기 위해 각 장르별 평점 순 랭킹 페이지를 1~4 page 순으로 크롤링
    <ul>
      <li>적어도 4 page까지는 평점 랭킹 존재하는 영화들 수집 (각 200개 * 7개 장르 = 1400개 데이터)</li>
      <li>드라마: 1, 공포: 4, 멜로/애정/로맨스: 5, 코미디: 11, 애니메이션: 15, 범죄: 16, 액션: 19</li>
    </ul>
  </li>
  <li>크롤링하면서 각 영화별 상세 페이지에 접속하여 한글 제목, 영어 제목, 연도, 네티즌 평점, 등급, 이미지, 장르 가져오기</li>
  <li>각 장르별로 반복</li>
</ol>

<h3 id="naver-movie-login">NAVER movie login</h3>

<p>성인 인증이 필요한 영화의 경우 로그인하지 않은 상태로는 바로 페이지 이동이 되지 않으므로, 미리 로그인이 필요</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">login_url</span> <span class="o">=</span> <span class="s">'https://nid.naver.com/nidlogin.login'</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">id_key</span> <span class="o">=</span> <span class="s">'kmoshn815'</span>
<span class="n">pw_key</span> <span class="o">=</span> <span class="s">'********'</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s">'/Users/ohhyunkwon/Documents/2020 study/etc/chromedriver'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">login_url</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('id')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">id_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('pw')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">pw_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="frmNIDLogin"]/fieldset/input'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="new.dontsave"]'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Basic NAVER movie url
</span><span class="n">basic_url</span> <span class="o">=</span> <span class="s">'https://movie.naver.com'</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Basic Ranking url (genre, page는 변수 형태)
</span><span class="n">rank_url</span> <span class="o">=</span> <span class="s">'https://movie.naver.com/movie/sdb/rank/rmovie.nhn?sel=pnt&amp;date=20200616&amp;tg={genre}&amp;page={page}'</span>
</code></pre></div></div>

<h3 id="a-drama">a. Drama</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">drama_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'code'</span><span class="p">,</span> <span class="s">'title_kor'</span><span class="p">,</span> <span class="s">'title_eng'</span><span class="p">,</span> <span class="s">'year'</span><span class="p">,</span>
                                 <span class="s">'rating'</span><span class="p">,</span> <span class="s">'rank'</span><span class="p">,</span> <span class="s">'link'</span><span class="p">,</span> <span class="s">'genre'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">drama_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_drama</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">'images/poster_drama'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'w+'</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 4 pages crawling
</span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'page '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">' crawling...'</span><span class="p">)</span>
    <span class="c1"># 단일 페이지 접속
</span>    <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">rank_url</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">genre</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)))):</span>
        <span class="c1"># link
</span>        <span class="n">link</span> <span class="o">=</span> <span class="n">basic_url</span> <span class="o">+</span> <span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">a</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'href'</span><span class="p">)</span>
        
        <span class="c1"># rating
</span>        <span class="n">rating</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'td'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'point'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">text</span>
        
        <span class="c1"># code
</span>        <span class="n">code_start</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'code='</span><span class="p">,</span> <span class="n">link</span><span class="p">).</span><span class="n">span</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">link</span><span class="p">[</span><span class="n">code_start</span><span class="p">:]</span>
        
        <span class="c1"># 상세 페이지 접속
</span>        <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
        <span class="n">link_html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">link_soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">link_html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
        
        <span class="c1"># 영화 정보
</span>        <span class="n">movie_info</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'mv_info'</span><span class="p">)</span>
        
        <span class="c1"># title_kor
</span>        <span class="n">title_kor</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">h3</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">text</span>
        
        <span class="c1"># title_eng
</span>        <span class="n">title_eng</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># year
</span>        <span class="n">year</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># rank
</span>        <span class="n">rank</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'span'</span><span class="p">)[</span><span class="mi">4</span><span class="p">].</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">text</span>

        <span class="c1"># genre
</span>        <span class="n">genre</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">))):</span>
            <span class="n">genre</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="n">i</span><span class="p">].</span><span class="n">strip</span><span class="p">())</span>
        
        <span class="c1"># poster
</span>        <span class="n">poster_thumbnail</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'poster'</span><span class="p">).</span><span class="n">a</span><span class="p">.</span><span class="n">img</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'src'</span><span class="p">)</span>
        <span class="n">poster_end</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'</span><span class="si">\</span><span class="err">?</span><span class="se">'</span><span class="s">, poster_thumbnail).span()[0]
        poster_link = poster_thumbnail[:poster_end]
        poster_index = l * 50 + k
        poster_drama[poster_index, :, :, :] = np.asarray(Image.open(request.urlopen(poster_link)).resize((256, 256)))[:, :, :3]
        
        # 데이터프레임에 추가
        drama_df = drama_df.append({'</span><span class="n">code</span><span class="s">': code, '</span><span class="n">title_kor</span><span class="s">': title_kor, '</span><span class="n">title_eng</span><span class="s">': title_eng,
                                    '</span><span class="n">year</span><span class="s">': year, '</span><span class="n">rating</span><span class="s">': rating, '</span><span class="n">rank</span><span class="s">': rank, '</span><span class="n">link</span><span class="s">': link,
                                    '</span><span class="n">genre</span><span class="s">': genre}, ignore_index=True)
print('</span><span class="n">Completed</span><span class="err">!</span><span class="s">')
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>page 1 crawling...

100%|██████████| 50/50 [01:25&lt;00:00,  1.71s/it]

page 2 crawling...

100%|██████████| 50/50 [01:20&lt;00:00,  1.61s/it]

page 3 crawling...

100%|██████████| 50/50 [01:20&lt;00:00,  1.60s/it]

page 4 crawling...

100%|██████████| 50/50 [01:23&lt;00:00,  1.67s/it]

Completed!
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_drama</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">drama_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>171539</td>
      <td>그린 북</td>
      <td>Green Book</td>
      <td>2018</td>
      <td>9.59</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>174830</td>
      <td>가버나움</td>
      <td>Capharnaum</td>
      <td>2018</td>
      <td>9.58</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>151196</td>
      <td>원더</td>
      <td>Wonder</td>
      <td>2017</td>
      <td>9.49</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>169240</td>
      <td>아일라</td>
      <td>Ayla: The Daughter of War</td>
      <td>2017</td>
      <td>9.48</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마, 전쟁]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>157243</td>
      <td>당갈</td>
      <td>Dangal</td>
      <td>2016</td>
      <td>9.47</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마, 액션]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>34566</td>
      <td>루키</td>
      <td>The Rookie</td>
      <td>2002</td>
      <td>8.95</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마]</td>
    </tr>
    <tr>
      <th>196</th>
      <td>16792</td>
      <td>흐르는 강물처럼</td>
      <td>A River Runs Through It</td>
      <td>1992</td>
      <td>8.95</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마]</td>
    </tr>
    <tr>
      <th>197</th>
      <td>129046</td>
      <td>리틀 보이</td>
      <td>Little Boy</td>
      <td>2015</td>
      <td>8.95</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마, 전쟁]</td>
    </tr>
    <tr>
      <th>198</th>
      <td>83160</td>
      <td>씨민과 나데르의 별거</td>
      <td>Jodaeiye Nader Az Simin</td>
      <td>2011</td>
      <td>8.95</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마]</td>
    </tr>
    <tr>
      <th>199</th>
      <td>27109</td>
      <td>소년은 울지 않는다</td>
      <td>Boys Don't Cry</td>
      <td>1999</td>
      <td>8.95</td>
      <td>청소년 관람불가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마]</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 8 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">drama_df</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'data/drama_df.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'images/poster_drama.npy'</span><span class="p">,</span> <span class="n">poster_drama</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_d</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">'images/poster_drama.npy'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">poster_d</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">poster_d</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(200, 256, 256, 3)





array([[[[  0, 100, 116],
         [  0, 100, 116],
         [  0, 100, 117],
         ...,
         [  1, 115, 141],
         [  0, 116, 141],
         [  1, 117, 142]],

        [[  0, 100, 116],
         [  0, 100, 115],
         [  0, 101, 118],
         ...,
         [  0, 115, 141],
         [  0, 116, 141],
         [  0, 116, 141]],

        [[  0, 101, 116],
         [  0, 101, 116],
         [  0, 101, 118],
         ...,
         [  1, 117, 142],
         [  1, 117, 142],
         [  1, 117, 142]],

        ...,

        [[  0, 106, 130],
         [  1, 107, 131],
         [  0, 108, 132],
         ...,
         [  0, 105, 127],
         [  0, 105, 127],
         [  0, 105, 127]],

        [[  0, 106, 130],
         [  0, 106, 130],
         [  1, 107, 131],
         ...,
         [  1, 104, 127],
         [  1, 104, 126],
         [  1, 104, 127]],

        [[  0, 106, 130],
         [  0, 106, 130],
         [  1, 107, 131],
         ...,
         [  1, 104, 127],
         [  1, 104, 127],
         [  2, 104, 127]]],


       [[[227, 221, 218],
         [231, 231, 227],
         [237, 238, 239],
         ...,
         [ 87,  56,  93],
         [ 89,  58,  94],
         [ 89,  57,  92]],

        [[231, 229, 226],
         [232, 231, 227],
         [237, 237, 236],
         ...,
         [ 89,  58,  95],
         [ 88,  58,  93],
         [ 89,  58,  94]],

        [[236, 235, 233],
         [236, 236, 235],
         [237, 237, 236],
         ...,
         [ 88,  58,  96],
         [ 88,  58,  95],
         [ 89,  58,  94]],

        ...,

        [[104, 129, 151],
         [105, 128, 150],
         [106, 130, 152],
         ...,
         [125, 125,  84],
         [123, 124,  94],
         [ 97, 104, 102]],

        [[103, 129, 151],
         [102, 128, 150],
         [104, 129, 152],
         ...,
         [115, 118,  87],
         [111, 115,  91],
         [ 87,  96,  99]],

        [[100, 129, 149],
         [100, 128, 149],
         [103, 128, 150],
         ...,
         [106, 112,  85],
         [ 97, 106,  86],
         [ 79,  85,  93]]],


       [[[242, 225, 217],
         [241, 223, 213],
         [241, 222, 212],
         ...,
         [250, 250, 231],
         [253, 252, 248],
         [253, 253, 252]],

        [[252, 252, 252],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        [[247, 234, 229],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        ...,

        [[100,  97,  86],
         [ 98,  95,  85],
         [ 96,  95,  85],
         ...,
         [114, 102,  86],
         [111,  98,  79],
         [114,  97,  77]],

        [[100,  99,  90],
         [ 89,  88,  79],
         [ 76,  73,  65],
         ...,
         [114, 100,  81],
         [118, 102,  83],
         [119, 100,  80]],

        [[ 90,  89,  83],
         [ 89,  86,  80],
         [ 88,  83,  76],
         ...,
         [102,  90,  73],
         [104,  92,  76],
         [103,  88,  74]]],


       ...,


       [[[ 16,  25,  42],
         [ 16,  25,  42],
         [ 16,  25,  42],
         ...,
         [ 16,  25,  42],
         [ 16,  25,  42],
         [ 16,  25,  41]],

        [[ 16,  25,  42],
         [ 16,  25,  42],
         [ 16,  25,  42],
         ...,
         [ 16,  25,  42],
         [ 16,  25,  42],
         [ 16,  25,  42]],

        [[ 16,  25,  42],
         [ 16,  25,  42],
         [ 16,  25,  42],
         ...,
         [ 16,  25,  42],
         [ 16,  25,  42],
         [ 16,  25,  42]],

        ...,

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  1,   1,   1]],

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  1,   1,   1]],

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  1,   1,   1]]],


       [[[ 77,  65,  62],
         [ 74,  63,  59],
         [ 72,  61,  56],
         ...,
         [ 93,  83,  74],
         [ 93,  83,  73],
         [ 97,  87,  78]],

        [[ 78,  66,  60],
         [ 74,  64,  58],
         [ 71,  61,  56],
         ...,
         [ 92,  82,  73],
         [ 92,  82,  73],
         [ 98,  88,  79]],

        [[ 78,  66,  59],
         [ 74,  63,  58],
         [ 71,  60,  56],
         ...,
         [ 92,  82,  73],
         [ 93,  83,  74],
         [ 97,  87,  78]],

        ...,

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]],

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]],

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]]],


       [[[146, 125,  54],
         [142, 121,  80],
         [146, 132,  95],
         ...,
         [252, 243, 142],
         [252, 243, 142],
         [253, 243, 144]],

        [[225, 196, 110],
         [182, 155,  92],
         [151, 130,  82],
         ...,
         [252, 243, 142],
         [252, 243, 142],
         [253, 243, 144]],

        [[224, 182, 102],
         [229, 193, 106],
         [221, 195, 108],
         ...,
         [252, 243, 142],
         [252, 243, 142],
         [252, 242, 144]],

        ...,

        [[205,  90,  43],
         [199,  83,  36],
         [206,  90,  43],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  5,   5,   5]],

        [[203,  88,  41],
         [191,  75,  28],
         [196,  80,  33],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  4,   4,   4]],

        [[209,  96,  48],
         [195,  81,  34],
         [197,  83,  36],
         ...,
         [  3,   3,   3],
         [  2,   2,   2],
         [  9,   9,   9]]]], dtype=uint8)
</code></pre></div></div>

<h3 id="b-horror">b. Horror</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s">'/Users/ohhyunkwon/Documents/2020 study/etc/chromedriver'</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">login_url</span><span class="p">)</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('id')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">id_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('pw')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">pw_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="frmNIDLogin"]/fieldset/input'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="new.dontsave"]'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">horror_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'code'</span><span class="p">,</span> <span class="s">'title_kor'</span><span class="p">,</span> <span class="s">'title_eng'</span><span class="p">,</span> <span class="s">'year'</span><span class="p">,</span>
                                 <span class="s">'rating'</span><span class="p">,</span> <span class="s">'rank'</span><span class="p">,</span> <span class="s">'link'</span><span class="p">,</span> <span class="s">'genre'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">horror_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_horror</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">'images/poster_horror'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'w+'</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 4 pages crawling
</span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'page '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">' crawling...'</span><span class="p">)</span>
    <span class="c1"># 단일 페이지 접속
</span>    <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">rank_url</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">genre</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)))):</span>
        <span class="c1"># link
</span>        <span class="n">link</span> <span class="o">=</span> <span class="n">basic_url</span> <span class="o">+</span> <span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">a</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'href'</span><span class="p">)</span>
        
        <span class="c1"># rating
</span>        <span class="n">rating</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'td'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'point'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">text</span>
        
        <span class="c1"># code
</span>        <span class="n">code_start</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'code='</span><span class="p">,</span> <span class="n">link</span><span class="p">).</span><span class="n">span</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">link</span><span class="p">[</span><span class="n">code_start</span><span class="p">:]</span>
        
        <span class="c1"># 상세 페이지 접속
</span>        <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
        <span class="n">link_html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">link_soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">link_html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
        
        <span class="c1"># 영화 정보
</span>        <span class="n">movie_info</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'mv_info'</span><span class="p">)</span>
        
        <span class="c1"># title_kor
</span>        <span class="n">title_kor</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">h3</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">text</span>
        
        <span class="c1"># title_eng
</span>        <span class="n">title_eng</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># year
</span>        <span class="n">year</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># rank
</span>        <span class="n">rank</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'span'</span><span class="p">)[</span><span class="mi">4</span><span class="p">].</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">text</span>

        <span class="c1"># genre
</span>        <span class="n">genre</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">))):</span>
            <span class="n">genre</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="n">i</span><span class="p">].</span><span class="n">strip</span><span class="p">())</span>
        
        <span class="c1"># poster
</span>        <span class="n">poster_thumbnail</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'poster'</span><span class="p">).</span><span class="n">a</span><span class="p">.</span><span class="n">img</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'src'</span><span class="p">)</span>
        <span class="n">poster_end</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'</span><span class="si">\</span><span class="err">?</span><span class="se">'</span><span class="s">, poster_thumbnail).span()[0]
        poster_link = poster_thumbnail[:poster_end]
        poster_index = l * 50 + k
        poster_horror[poster_index, :, :, :] = np.asarray(Image.open(request.urlopen(poster_link)).resize((256, 256)))[:, :, :3]
        
        # 데이터프레임에 추가
        horror_df = horror_df.append({'</span><span class="n">code</span><span class="s">': code, '</span><span class="n">title_kor</span><span class="s">': title_kor, '</span><span class="n">title_eng</span><span class="s">': title_eng,
                                      '</span><span class="n">year</span><span class="s">': year, '</span><span class="n">rating</span><span class="s">': rating, '</span><span class="n">rank</span><span class="s">': rank, '</span><span class="n">link</span><span class="s">': link,
                                      '</span><span class="n">genre</span><span class="s">': genre}, ignore_index=True)
print('</span><span class="n">Completed</span><span class="err">!</span><span class="s">')
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>page 1 crawling...


100%|██████████| 50/50 [01:42&lt;00:00,  2.06s/it]

page 2 crawling...

100%|██████████| 50/50 [01:37&lt;00:00,  1.96s/it]

page 3 crawling...

100%|██████████| 50/50 [01:41&lt;00:00,  2.03s/it]

page 4 crawling...

100%|██████████| 50/50 [01:48&lt;00:00,  2.18s/it]

Completed!
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_horror</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">horror_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17254</td>
      <td>뱀파이어와의 인터뷰</td>
      <td>Interview With The Vampire: The Vampire Chroni...</td>
      <td>1994</td>
      <td>9.12</td>
      <td>청소년 관람불가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[공포, 드라마]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10037</td>
      <td>에이리언</td>
      <td>Alien</td>
      <td>1979</td>
      <td>9.12</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[공포, SF]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10050</td>
      <td>싸이코</td>
      <td>Psycho</td>
      <td>1960</td>
      <td>9.11</td>
      <td>청소년 관람불가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[공포, 스릴러, 미스터리]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10029</td>
      <td>죠스</td>
      <td>Jaws</td>
      <td>1975</td>
      <td>8.90</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[공포, 스릴러]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>126389</td>
      <td>무서운 집</td>
      <td>Scary house</td>
      <td>2014</td>
      <td>8.89</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[공포]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>172003</td>
      <td>속닥속닥</td>
      <td>The Whispering</td>
      <td>2018</td>
      <td>5.06</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[공포, 미스터리]</td>
    </tr>
    <tr>
      <th>196</th>
      <td>65535</td>
      <td>해부학 교실</td>
      <td>Cadaver</td>
      <td>2007</td>
      <td>5.06</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[공포, 미스터리]</td>
    </tr>
    <tr>
      <th>197</th>
      <td>65901</td>
      <td>할로윈: 살인마의 탄생</td>
      <td>Halloween</td>
      <td>2007</td>
      <td>5.06</td>
      <td>청소년 관람불가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[공포]</td>
    </tr>
    <tr>
      <th>198</th>
      <td>63202</td>
      <td>커버넌트</td>
      <td>The Covenant</td>
      <td>2006</td>
      <td>5.05</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[공포, 스릴러]</td>
    </tr>
    <tr>
      <th>199</th>
      <td>125436</td>
      <td>포레스트: 죽음의 숲</td>
      <td>The Forest</td>
      <td>2016</td>
      <td>5.04</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[공포]</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 8 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">horror_df</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'data/horror_df.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'images/poster_horror.npy'</span><span class="p">,</span> <span class="n">poster_horror</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_h</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">'images/poster_horror.npy'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">poster_h</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">poster_h</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(200, 256, 256, 3)





array([[[[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]],

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]],

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]],

        ...,

        [[ 15,   5,   9],
         [ 12,   3,   6],
         [  8,   3,   4],
         ...,
         [ 12,   8,   5],
         [ 13,   9,   6],
         [ 13,   9,   6]],

        [[ 14,   4,   8],
         [ 12,   3,   6],
         [  8,   3,   4],
         ...,
         [ 12,   8,   5],
         [ 14,  10,   7],
         [ 14,  10,   7]],

        [[ 12,   2,   6],
         [ 10,   1,   4],
         [  6,   1,   2],
         ...,
         [ 12,   8,   5],
         [ 12,   8,   5],
         [ 13,   9,   6]]],


       [[[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  1,   0,   1],
         [  1,   1,   0],
         [  1,   2,   1]],

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  2,   0,   1],
         [  1,   0,   1],
         [  6,  12,   6]],

        [[  0,   1,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  1,   0,   0]],

        ...,

        [[212, 182, 128],
         [ 91,  66,  51],
         [  3,   0,   0],
         ...,
         [ 45,  53,  27],
         [ 61,  71,  52],
         [ 78,  89,  76]],

        [[122, 108,  32],
         [ 71,  53,  18],
         [ 12,   3,   0],
         ...,
         [ 39,  34,   5],
         [ 30,  36,   4],
         [ 41,  52,  23]],

        [[181, 147, 125],
         [129, 104,  83],
         [ 78,  55,  48],
         ...,
         [ 58,  63,  40],
         [ 78,  88,  74],
         [ 59,  64,  63]]],


       [[[102,   2,   2],
         [ 98,   2,   1],
         [100,   1,   1],
         ...,
         [ 64,   2,   2],
         [ 62,   2,   2],
         [ 62,   2,   2]],

        [[103,   1,   2],
         [102,   1,   2],
         [104,   2,   2],
         ...,
         [ 61,   3,   2],
         [ 62,   3,   2],
         [ 62,   3,   2]],

        [[104,   1,   2],
         [104,   1,   2],
         [104,   1,   2],
         ...,
         [ 61,   3,   2],
         [ 60,   3,   2],
         [ 61,   3,   2]],

        ...,

        [[ 16,   0,   1],
         [ 16,   0,   1],
         [ 16,   0,   1],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]],

        [[ 16,   0,   1],
         [ 16,   0,   1],
         [ 17,   1,   2],
         ...,
         [  2,   0,   1],
         [  2,   0,   1],
         [  1,   1,   1]],

        [[ 17,   1,   2],
         [ 17,   1,   2],
         [ 18,   1,   3],
         ...,
         [ 13,   1,   3],
         [ 20,   1,   1],
         [ 31,   2,   4]]],


       ...,


       [[[  3,   4,   9],
         [  1,   2,   7],
         [  2,   3,   8],
         ...,
         [  4,   4,   6],
         [  3,   3,   5],
         [  1,   1,   3]],

        [[  3,   4,   9],
         [  1,   2,   7],
         [  2,   3,   8],
         ...,
         [  4,   4,   6],
         [  3,   3,   5],
         [  1,   1,   3]],

        [[  2,   3,   7],
         [  2,   3,   7],
         [  1,   2,   6],
         ...,
         [  4,   4,   6],
         [  3,   3,   5],
         [  2,   2,   4]],

        ...,

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]],

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]],

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]]],


       [[[ 11,  40,  58],
         [  9,  38,  56],
         [ 10,  37,  56],
         ...,
         [ 14,  24,  36],
         [ 14,  24,  36],
         [ 15,  25,  36]],

        [[  9,  38,  56],
         [  7,  36,  54],
         [  9,  36,  55],
         ...,
         [ 13,  23,  35],
         [ 13,  23,  36],
         [ 13,  22,  37]],

        [[  9,  38,  56],
         [  7,  36,  54],
         [  8,  35,  54],
         ...,
         [ 14,  24,  36],
         [ 14,  24,  36],
         [ 14,  23,  37]],

        ...,

        [[  4,   4,   4],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]],

        [[  4,   4,   4],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]],

        [[  4,   4,   4],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0]]],


       [[[168, 158, 146],
         [168, 158, 146],
         [167, 157, 145],
         ...,
         [173, 165, 152],
         [173, 165, 152],
         [172, 164, 151]],

        [[169, 159, 147],
         [169, 159, 147],
         [168, 158, 146],
         ...,
         [174, 166, 153],
         [173, 165, 152],
         [173, 165, 152]],

        [[169, 159, 147],
         [169, 159, 147],
         [168, 158, 146],
         ...,
         [174, 166, 153],
         [174, 166, 153],
         [173, 165, 152]],

        ...,

        [[203, 197, 185],
         [203, 197, 185],
         [203, 197, 185],
         ...,
         [204, 198, 186],
         [204, 198, 186],
         [204, 198, 186]],

        [[203, 197, 185],
         [203, 197, 185],
         [203, 197, 185],
         ...,
         [204, 198, 186],
         [204, 198, 186],
         [204, 198, 186]],

        [[203, 197, 185],
         [202, 196, 184],
         [202, 196, 184],
         ...,
         [204, 198, 186],
         [204, 198, 186],
         [204, 198, 186]]]], dtype=uint8)
</code></pre></div></div>

<h3 id="c-romance">c. Romance</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s">'/Users/ohhyunkwon/Documents/2020 study/etc/chromedriver'</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">login_url</span><span class="p">)</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('id')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">id_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('pw')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">pw_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="frmNIDLogin"]/fieldset/input'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="new.dontsave"]'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">romance_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'code'</span><span class="p">,</span> <span class="s">'title_kor'</span><span class="p">,</span> <span class="s">'title_eng'</span><span class="p">,</span> <span class="s">'year'</span><span class="p">,</span>
                                 <span class="s">'rating'</span><span class="p">,</span> <span class="s">'rank'</span><span class="p">,</span> <span class="s">'link'</span><span class="p">,</span> <span class="s">'genre'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">romance_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_romance</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">'images/poster_romance'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'w+'</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 4 pages crawling
</span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'page '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">' crawling...'</span><span class="p">)</span>
    <span class="c1"># 단일 페이지 접속
</span>    <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">rank_url</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">genre</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)))):</span>
        <span class="c1"># link
</span>        <span class="n">link</span> <span class="o">=</span> <span class="n">basic_url</span> <span class="o">+</span> <span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">a</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'href'</span><span class="p">)</span>
        
        <span class="c1"># rating
</span>        <span class="n">rating</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'td'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'point'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">text</span>
        
        <span class="c1"># code
</span>        <span class="n">code_start</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'code='</span><span class="p">,</span> <span class="n">link</span><span class="p">).</span><span class="n">span</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">link</span><span class="p">[</span><span class="n">code_start</span><span class="p">:]</span>
        
        <span class="c1"># 상세 페이지 접속
</span>        <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
        <span class="n">link_html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">link_soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">link_html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
        
        <span class="c1"># 영화 정보
</span>        <span class="n">movie_info</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'mv_info'</span><span class="p">)</span>
        
        <span class="c1"># title_kor
</span>        <span class="n">title_kor</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">h3</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">text</span>
        
        <span class="c1"># title_eng
</span>        <span class="n">title_eng</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># year
</span>        <span class="n">year</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># rank
</span>        <span class="n">rank</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'span'</span><span class="p">)[</span><span class="mi">4</span><span class="p">].</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">text</span>

        <span class="c1"># genre
</span>        <span class="n">genre</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">))):</span>
            <span class="n">genre</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="n">i</span><span class="p">].</span><span class="n">strip</span><span class="p">())</span>
        
        <span class="c1"># poster
</span>        <span class="n">poster_thumbnail</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'poster'</span><span class="p">).</span><span class="n">a</span><span class="p">.</span><span class="n">img</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'src'</span><span class="p">)</span>
        <span class="n">poster_end</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'</span><span class="si">\</span><span class="err">?</span><span class="se">'</span><span class="s">, poster_thumbnail).span()[0]
        poster_link = poster_thumbnail[:poster_end]
        poster_index = l * 50 + k
        poster_romance[poster_index, :, :, :] = np.asarray(Image.open(request.urlopen(poster_link)).resize((256, 256)))[:, :, :3]
        
        # 데이터프레임에 추가
        romance_df = romance_df.append({'</span><span class="n">code</span><span class="s">': code, '</span><span class="n">title_kor</span><span class="s">': title_kor, '</span><span class="n">title_eng</span><span class="s">': title_eng,
                                        '</span><span class="n">year</span><span class="s">': year, '</span><span class="n">rating</span><span class="s">': rating, '</span><span class="n">rank</span><span class="s">': rank, '</span><span class="n">link</span><span class="s">': link,
                                        '</span><span class="n">genre</span><span class="s">': genre}, ignore_index=True)
print('</span><span class="n">Completed</span><span class="err">!</span><span class="s">')
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>page 1 crawling...

100%|██████████| 50/50 [01:54&lt;00:00,  2.30s/it]

page 2 crawling...

100%|██████████| 50/50 [01:42&lt;00:00,  2.05s/it]

page 3 crawling...

100%|██████████| 50/50 [01:35&lt;00:00,  1.92s/it]

page 4 crawling...

100%|██████████| 50/50 [01:40&lt;00:00,  2.00s/it]

Completed!
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_romance</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">romance_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10102</td>
      <td>사운드 오브 뮤직</td>
      <td>The Sound Of Music</td>
      <td>1965</td>
      <td>9.40</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[멜로/로맨스, 뮤지컬, 드라마]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>35939</td>
      <td>클래식</td>
      <td>The Classic</td>
      <td>2003</td>
      <td>9.39</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[멜로/로맨스, 드라마]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18847</td>
      <td>타이타닉</td>
      <td>Titanic</td>
      <td>1997</td>
      <td>9.38</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[멜로/로맨스, 드라마]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>39636</td>
      <td>지금, 만나러 갑니다</td>
      <td>いま、会いにゆきます</td>
      <td>2004</td>
      <td>9.34</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[멜로/로맨스, 드라마, 판타지]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>182348</td>
      <td>로망</td>
      <td>Romang</td>
      <td>2019</td>
      <td>9.30</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[멜로/로맨스]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>40163</td>
      <td>게스 후?</td>
      <td>Guess Who</td>
      <td>2005</td>
      <td>7.42</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[멜로/로맨스, 코미디]</td>
    </tr>
    <tr>
      <th>196</th>
      <td>85842</td>
      <td>네버엔딩 스토리</td>
      <td>Never Ending Story</td>
      <td>2012</td>
      <td>7.41</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[멜로/로맨스, 코미디]</td>
    </tr>
    <tr>
      <th>197</th>
      <td>69977</td>
      <td>참을 수 없는.</td>
      <td>2010</td>
      <td>2010</td>
      <td>7.39</td>
      <td>청소년 관람불가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[멜로/로맨스, 드라마]</td>
    </tr>
    <tr>
      <th>198</th>
      <td>69952</td>
      <td>호우시절</td>
      <td>好雨時節</td>
      <td>2009</td>
      <td>7.38</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[멜로/로맨스]</td>
    </tr>
    <tr>
      <th>199</th>
      <td>64195</td>
      <td>기다리다 미쳐</td>
      <td>Crazy For Wait</td>
      <td>2007</td>
      <td>7.37</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[멜로/로맨스]</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 8 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">romance_df</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'data/romance_df.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'images/poster_romance.npy'</span><span class="p">,</span> <span class="n">poster_romance</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_r</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">'images/poster_romance.npy'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">poster_r</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">poster_r</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(200, 256, 256, 3)





array([[[[ 20,  66, 160],
         [ 20,  66, 160],
         [ 20,  66, 160],
         ...,
         [ 19,  86, 173],
         [ 19,  86, 173],
         [ 19,  86, 173]],

        [[ 20,  66, 160],
         [ 20,  66, 160],
         [ 21,  67, 161],
         ...,
         [ 20,  87, 174],
         [ 19,  86, 173],
         [ 20,  87, 174]],

        [[ 21,  67, 161],
         [ 20,  67, 161],
         [ 21,  67, 161],
         ...,
         [ 19,  86, 173],
         [ 19,  86, 173],
         [ 19,  86, 173]],

        ...,

        [[ 38,  70,  33],
         [ 38,  71,  34],
         [ 41,  74,  35],
         ...,
         [ 68,  97,  40],
         [ 63,  94,  40],
         [ 45,  80,  37]],

        [[ 43,  79,  37],
         [ 44,  80,  38],
         [ 41,  79,  35],
         ...,
         [ 42,  77,  35],
         [ 42,  79,  36],
         [ 46,  83,  39]],

        [[ 41,  78,  35],
         [ 41,  78,  35],
         [ 40,  77,  34],
         ...,
         [ 41,  78,  35],
         [ 42,  79,  36],
         [ 42,  79,  36]]],


       [[[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        ...,

        [[ 16,  12,  13],
         [ 16,  12,  13],
         [ 18,  14,  14],
         ...,
         [  5,   1,   2],
         [  3,   1,   2],
         [ 18,  17,  17]],

        [[ 19,  15,  16],
         [ 19,  15,  16],
         [ 20,  16,  15],
         ...,
         [ 10,   6,   7],
         [ 11,   7,   8],
         [ 26,  22,  23]],

        [[ 67,  63,  64],
         [ 69,  65,  66],
         [ 69,  65,  64],
         ...,
         [ 69,  65,  66],
         [ 71,  67,  68],
         [ 79,  75,  76]]],


       [[[106,  75,  74],
         [103,  74,  70],
         [106,  73,  73],
         ...,
         [134,  96, 100],
         [135,  96, 100],
         [137,  96, 100]],

        [[112,  82,  85],
         [109,  79,  83],
         [111,  79,  84],
         ...,
         [144, 106, 116],
         [143, 106, 117],
         [144, 108, 119]],

        [[113,  81,  84],
         [111,  80,  83],
         [112,  80,  82],
         ...,
         [144, 105, 116],
         [142, 105, 114],
         [145, 106, 115]],

        ...,

        [[  3,   3,   3],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  3,   3,   3]],

        [[  3,   3,   3],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [  0,   0,   0],
         [  3,   3,   3]],

        [[  5,   5,   5],
         [  2,   2,   2],
         [  2,   2,   2],
         ...,
         [  2,   2,   2],
         [  2,   2,   2],
         [  5,   5,   5]]],


       ...,


       [[[ 34,  23,  19],
         [ 34,  23,  19],
         [ 34,  23,  19],
         ...,
         [ 38,  27,  23],
         [ 37,  26,  22],
         [ 37,  26,  22]],

        [[ 34,  23,  19],
         [ 34,  23,  19],
         [ 34,  23,  19],
         ...,
         [ 37,  26,  22],
         [ 36,  25,  20],
         [ 35,  24,  19]],

        [[ 34,  23,  19],
         [ 34,  23,  19],
         [ 34,  23,  19],
         ...,
         [ 39,  28,  24],
         [ 39,  28,  24],
         [ 37,  26,  22]],

        ...,

        [[112,  74,  64],
         [140,  99,  85],
         [149, 106,  91],
         ...,
         [  2,   0,   2],
         [  3,   0,   1],
         [  3,   1,   2]],

        [[ 99,  64,  55],
         [123,  85,  73],
         [140,  99,  86],
         ...,
         [  4,   1,   2],
         [  4,   1,   2],
         [  6,   2,   3]],

        [[ 81,  50,  42],
         [107,  71,  61],
         [122,  83,  72],
         ...,
         [  6,   2,   3],
         [  7,   3,   4],
         [  8,   3,   4]]],


       [[[169, 202, 177],
         [171, 204, 174],
         [165, 203, 165],
         ...,
         [166, 146, 148],
         [166, 146, 148],
         [166, 147, 149]],

        [[163, 199, 173],
         [161, 198, 171],
         [155, 196, 163],
         ...,
         [168, 148, 150],
         [165, 146, 148],
         [164, 145, 147]],

        [[150, 194, 160],
         [150, 192, 159],
         [151, 193, 158],
         ...,
         [168, 149, 151],
         [165, 146, 148],
         [162, 143, 145]],

        ...,

        [[146, 131, 110],
         [146, 131, 111],
         [141, 128, 108],
         ...,
         [ 55,  81,  54],
         [ 53,  80,  53],
         [ 53,  78,  52]],

        [[139, 126, 107],
         [139, 126, 107],
         [138, 126, 107],
         ...,
         [ 49,  76,  50],
         [ 49,  76,  49],
         [ 50,  73,  47]],

        [[140, 129, 107],
         [134, 122, 103],
         [139, 126, 109],
         ...,
         [ 47,  74,  47],
         [ 49,  76,  48],
         [ 52,  77,  49]]],


       [[[ 82, 110,  59],
         [ 80, 108,  57],
         [ 80, 108,  57],
         ...,
         [ 80, 108,  57],
         [ 80, 108,  57],
         [ 82, 110,  59]],

        [[ 81, 109,  58],
         [ 79, 107,  56],
         [ 79, 107,  56],
         ...,
         [ 79, 107,  56],
         [ 79, 107,  56],
         [ 81, 109,  58]],

        [[ 82, 110,  59],
         [ 79, 107,  56],
         [ 79, 107,  56],
         ...,
         [ 79, 107,  56],
         [ 79, 107,  56],
         [ 81, 109,  58]],

        ...,

        [[167,  51,  50],
         [188,  52,  53],
         [194,  51,  54],
         ...,
         [184,  42,  62],
         [176,  40,  53],
         [178,  98,  93]],

        [[ 69,  17,  13],
         [ 92,  25,  22],
         [ 99,  27,  25],
         ...,
         [189,  41,  64],
         [180,  40,  57],
         [174,  58,  63]],

        [[ 64,  17,  13],
         [ 81,  21,  18],
         [ 99,  30,  27],
         ...,
         [192,  56,  74],
         [191,  41,  66],
         [181,  44,  56]]]], dtype=uint8)
</code></pre></div></div>

<h3 id="d-comedy">d. Comedy</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s">'/Users/ohhyunkwon/Documents/2020 study/etc/chromedriver'</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">login_url</span><span class="p">)</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('id')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">id_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('pw')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">pw_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="frmNIDLogin"]/fieldset/input'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="new.dontsave"]'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">comedy_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'code'</span><span class="p">,</span> <span class="s">'title_kor'</span><span class="p">,</span> <span class="s">'title_eng'</span><span class="p">,</span> <span class="s">'year'</span><span class="p">,</span>
                                  <span class="s">'rating'</span><span class="p">,</span> <span class="s">'rank'</span><span class="p">,</span> <span class="s">'link'</span><span class="p">,</span> <span class="s">'genre'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">comedy_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_comedy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">'images/poster_comedy'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'w+'</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 4 pages crawling
</span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'page '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">' crawling...'</span><span class="p">)</span>
    <span class="c1"># 단일 페이지 접속
</span>    <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">rank_url</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">genre</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)))):</span>
        <span class="c1"># link
</span>        <span class="n">link</span> <span class="o">=</span> <span class="n">basic_url</span> <span class="o">+</span> <span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">a</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'href'</span><span class="p">)</span>
        
        <span class="c1"># rating
</span>        <span class="n">rating</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'td'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'point'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">text</span>
        
        <span class="c1"># code
</span>        <span class="n">code_start</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'code='</span><span class="p">,</span> <span class="n">link</span><span class="p">).</span><span class="n">span</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">link</span><span class="p">[</span><span class="n">code_start</span><span class="p">:]</span>
        
        <span class="c1"># 상세 페이지 접속
</span>        <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
        <span class="n">link_html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">link_soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">link_html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
        
        <span class="c1"># 영화 정보
</span>        <span class="n">movie_info</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'mv_info'</span><span class="p">)</span>
        
        <span class="c1"># title_kor
</span>        <span class="n">title_kor</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">h3</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">text</span>
        
        <span class="c1"># title_eng
</span>        <span class="n">title_eng</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># year
</span>        <span class="n">year</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># rank
</span>        <span class="n">rank</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'span'</span><span class="p">)[</span><span class="mi">4</span><span class="p">].</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">text</span>

        <span class="c1"># genre
</span>        <span class="n">genre</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">))):</span>
            <span class="n">genre</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="n">i</span><span class="p">].</span><span class="n">strip</span><span class="p">())</span>
        
        <span class="c1"># poster
</span>        <span class="n">poster_thumbnail</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'poster'</span><span class="p">).</span><span class="n">a</span><span class="p">.</span><span class="n">img</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'src'</span><span class="p">)</span>
        <span class="n">poster_end</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'</span><span class="si">\</span><span class="err">?</span><span class="se">'</span><span class="s">, poster_thumbnail).span()[0]
        poster_link = poster_thumbnail[:poster_end]
        poster_index = l * 50 + k
        # gif로 받아지는 경우 3개 채널로 다시 만들어주어야 함
        if np.asarray(Image.open(request.urlopen(poster_link))).ndim == 2:
            im = Image.open(request.urlopen(poster_link)).resize((256, 256))
            background = Image.new('</span><span class="n">RGB</span><span class="s">', im.size, (255, 255, 255))
            background.paste(im)
            poster_array = np.asarray(background)
        else:
            poster_array = np.asarray(Image.open(request.urlopen(poster_link)).resize((256, 256)))[:, :, :3]
        poster_comedy[poster_index, :, :, :] = poster_array
        
        # 데이터프레임에 추가
        comedy_df = comedy_df.append({'</span><span class="n">code</span><span class="s">': code, '</span><span class="n">title_kor</span><span class="s">': title_kor, '</span><span class="n">title_eng</span><span class="s">': title_eng,
                                      '</span><span class="n">year</span><span class="s">': year, '</span><span class="n">rating</span><span class="s">': rating, '</span><span class="n">rank</span><span class="s">': rank, '</span><span class="n">link</span><span class="s">': link,
                                      '</span><span class="n">genre</span><span class="s">': genre}, ignore_index=True)
print('</span><span class="n">Completed</span><span class="err">!</span><span class="s">')
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>page 1 crawling...

100%|██████████| 50/50 [02:07&lt;00:00,  2.56s/it]

page 2 crawling...

100%|██████████| 50/50 [01:47&lt;00:00,  2.16s/it]

page 3 crawling...

100%|██████████| 50/50 [02:10&lt;00:00,  2.61s/it]

page 4 crawling...

100%|██████████| 50/50 [02:53&lt;00:00,  3.47s/it]

Completed!
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_comedy</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">comedy_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>18543</td>
      <td>서유기 2 - 선리기연</td>
      <td>西遊記 完結篇 之 仙履奇緣: A Chinese Odyssey Part Two - C...</td>
      <td>1994</td>
      <td>9.35</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[코미디, 액션, 모험, 판타지, 멜로/로맨스]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>73372</td>
      <td>세 얼간이</td>
      <td>3 Idiots</td>
      <td>2009</td>
      <td>9.35</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[코미디]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>19099</td>
      <td>트루먼 쇼</td>
      <td>The Truman Show</td>
      <td>1998</td>
      <td>9.34</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[코미디, 드라마, SF]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>87566</td>
      <td>언터처블: 1%의 우정</td>
      <td>Intouchables</td>
      <td>2011</td>
      <td>9.33</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[코미디, 드라마]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16210</td>
      <td>미세스 다웃파이어</td>
      <td>Mrs. Doubtfire</td>
      <td>1993</td>
      <td>9.33</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[코미디, 가족, 드라마]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>39397</td>
      <td>윔블던</td>
      <td>Wimbledon</td>
      <td>2004</td>
      <td>8.10</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[코미디, 멜로/로맨스]</td>
    </tr>
    <tr>
      <th>196</th>
      <td>91073</td>
      <td>박수건달</td>
      <td>Man on the Edge</td>
      <td>2012</td>
      <td>8.10</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[코미디]</td>
    </tr>
    <tr>
      <th>197</th>
      <td>98738</td>
      <td>프란시스 하</td>
      <td>Frances Ha</td>
      <td>2012</td>
      <td>8.10</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[코미디, 멜로/로맨스]</td>
    </tr>
    <tr>
      <th>198</th>
      <td>62219</td>
      <td>색즉시공 시즌 2</td>
      <td>Sex Is Zero 2</td>
      <td>2007</td>
      <td>8.09</td>
      <td>청소년 관람불가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[코미디]</td>
    </tr>
    <tr>
      <th>199</th>
      <td>74954</td>
      <td>두 번의 결혼식과 한 번의 장례식</td>
      <td>Two Weddings And A Funeral</td>
      <td>2012</td>
      <td>8.09</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[코미디, 멜로/로맨스]</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 8 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">comedy_df</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'data/comedy_df.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'images/poster_comedy.npy'</span><span class="p">,</span> <span class="n">poster_comedy</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_c</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">'images/poster_comedy.npy'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">poster_c</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">poster_c</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(200, 256, 256, 3)





array([[[[  8,   8,   8],
         [  8,   8,   8],
         [  9,   9,   9],
         ...,
         [  8,   8,   8],
         [  8,   8,   8],
         [  8,   8,   8]],

        [[  9,   9,   9],
         [  9,   9,   9],
         [  9,   9,   9],
         ...,
         [  9,   9,   9],
         [  8,   8,   8],
         [  8,   8,   8]],

        [[  9,   9,   9],
         [  9,   9,   9],
         [ 10,  10,  10],
         ...,
         [  9,   9,   9],
         [  9,   9,   9],
         [  9,   9,   9]],

        ...,

        [[  8,   7,   5],
         [ 11,   9,   7],
         [ 13,  10,   8],
         ...,
         [ 31,  28,  24],
         [ 30,  27,  23],
         [ 30,  27,  23]],

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [ 44,  37,  31],
         [ 47,  40,  33],
         [ 48,  41,  34]],

        [[  0,   0,   0],
         [  0,   0,   0],
         [  0,   0,   0],
         ...,
         [  2,   1,   1],
         [  5,   4,   4],
         [  9,   8,   7]]],


       [[[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        ...,

        [[252, 252, 252],
         [253, 253, 253],
         [253, 253, 253],
         ...,
         [252, 254, 253],
         [252, 254, 253],
         [252, 254, 253]],

        [[251, 254, 253],
         [253, 253, 253],
         [252, 253, 252],
         ...,
         [251, 253, 252],
         [251, 253, 252],
         [251, 253, 252]],

        [[251, 253, 252],
         [251, 252, 252],
         [251, 253, 252],
         ...,
         [251, 253, 252],
         [251, 253, 252],
         [252, 254, 253]]],


       [[[244, 248, 252],
         [244, 248, 252],
         [244, 248, 252],
         ...,
         [237, 246, 251],
         [237, 246, 251],
         [237, 246, 251]],

        [[244, 248, 252],
         [243, 248, 252],
         [244, 248, 253],
         ...,
         [237, 246, 251],
         [237, 246, 251],
         [237, 246, 251]],

        [[244, 248, 252],
         [243, 248, 252],
         [244, 248, 252],
         ...,
         [237, 246, 251],
         [237, 246, 251],
         [237, 246, 251]],

        ...,

        [[111,  87,  98],
         [ 77,  52,  65],
         [ 98,  73,  84],
         ...,
         [ 52,  24,  41],
         [ 46,  20,  36],
         [ 51,  24,  40]],

        [[103,  80,  90],
         [107,  81,  92],
         [105,  78,  90],
         ...,
         [ 54,  27,  43],
         [ 49,  24,  39],
         [ 54,  28,  44]],

        [[ 73,  50,  61],
         [ 96,  71,  82],
         [ 90,  65,  76],
         ...,
         [ 51,  26,  40],
         [ 62,  36,  52],
         [ 61,  36,  51]]],


       ...,


       [[[119, 117, 107],
         [ 20,  21,  16],
         [ 21,  22,  17],
         ...,
         [100, 100,  91],
         [102, 102,  93],
         [ 70,  71,  64]],

        [[111, 110, 102],
         [ 19,  19,  16],
         [ 21,  22,  18],
         ...,
         [ 73,  74,  68],
         [ 76,  77,  70],
         [ 36,  37,  31]],

        [[112, 110, 103],
         [ 19,  20,  17],
         [ 21,  22,  17],
         ...,
         [ 44,  45,  40],
         [ 32,  33,  28],
         [ 28,  28,  23]],

        ...,

        [[ 28,  28,  23],
         [ 28,  27,  22],
         [ 24,  23,  19],
         ...,
         [ 27,  28,  23],
         [ 30,  31,  26],
         [ 30,  31,  27]],

        [[ 14,  14,  10],
         [ 16,  16,  11],
         [ 18,  17,  14],
         ...,
         [ 26,  27,  22],
         [ 32,  33,  28],
         [ 34,  35,  30]],

        [[ 64,  63,  55],
         [ 43,  42,  36],
         [ 18,  17,  12],
         ...,
         [ 34,  35,  30],
         [ 37,  38,  33],
         [ 41,  42,  37]]],


       [[[ 13,   0,   0],
         [ 20,   0,   1],
         [ 22,   2,   3],
         ...,
         [ 26,  10,   9],
         [ 70,  37,  33],
         [ 25,   9,   9]],

        [[  9,   1,   1],
         [ 10,   0,   0],
         [ 17,   0,   1],
         ...,
         [ 28,  12,  12],
         [ 30,  13,  13],
         [ 10,   0,   1]],

        [[ 32,  14,  12],
         [ 19,   6,   6],
         [  7,   0,   1],
         ...,
         [ 29,  12,  11],
         [ 12,   1,   1],
         [ 13,   1,   1]],

        ...,

        [[  4,   0,   0],
         [  5,   0,   0],
         [  6,   0,   0],
         ...,
         [  2,   0,   1],
         [  2,   0,   1],
         [  2,   0,   1]],

        [[  4,   0,   0],
         [  5,   0,   0],
         [  6,   0,   0],
         ...,
         [  2,   0,   1],
         [  2,   0,   1],
         [  2,   0,   1]],

        [[  4,   0,   0],
         [  4,   0,   0],
         [  4,   0,   0],
         ...,
         [  1,   0,   0],
         [  2,   0,   1],
         [  2,   0,   1]]],


       [[[227, 223, 215],
         [225, 220, 213],
         [223, 218, 212],
         ...,
         [ 25,  11,   7],
         [ 57,  41,  34],
         [103,  86,  78]],

        [[225, 220, 214],
         [222, 217, 211],
         [219, 214, 210],
         ...,
         [ 17,   4,   2],
         [ 27,  12,   7],
         [ 54,  36,  27]],

        [[218, 213, 208],
         [220, 215, 210],
         [218, 213, 209],
         ...,
         [ 16,   3,   3],
         [ 15,   2,   0],
         [ 26,   8,   3]],

        ...,

        [[ 61,  55,  54],
         [ 62,  56,  57],
         [ 63,  58,  59],
         ...,
         [137, 117, 110],
         [135, 113, 107],
         [133, 113, 104]],

        [[ 63,  57,  58],
         [ 63,  57,  59],
         [ 63,  57,  59],
         ...,
         [136, 116, 109],
         [137, 115, 108],
         [137, 114, 106]],

        [[ 61,  58,  60],
         [ 61,  57,  58],
         [ 62,  57,  57],
         ...,
         [135, 113, 106],
         [136, 113, 107],
         [140, 117, 109]]]], dtype=uint8)
</code></pre></div></div>

<h3 id="e-animation">e. Animation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s">'/Users/ohhyunkwon/Documents/2020 study/etc/chromedriver'</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">login_url</span><span class="p">)</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('id')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">id_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('pw')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">pw_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="frmNIDLogin"]/fieldset/input'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="new.dontsave"]'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">animation_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'code'</span><span class="p">,</span> <span class="s">'title_kor'</span><span class="p">,</span> <span class="s">'title_eng'</span><span class="p">,</span> <span class="s">'year'</span><span class="p">,</span>
                                     <span class="s">'rating'</span><span class="p">,</span> <span class="s">'rank'</span><span class="p">,</span> <span class="s">'link'</span><span class="p">,</span> <span class="s">'genre'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">animation_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_animation</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">'images/poster_animation'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'w+'</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 4 pages crawling
</span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'page '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">' crawling...'</span><span class="p">)</span>
    <span class="c1"># 단일 페이지 접속
</span>    <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">rank_url</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">genre</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)))):</span>
        <span class="c1"># link
</span>        <span class="n">link</span> <span class="o">=</span> <span class="n">basic_url</span> <span class="o">+</span> <span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">a</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'href'</span><span class="p">)</span>
        
        <span class="c1"># rating
</span>        <span class="n">rating</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'td'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'point'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">text</span>
        
        <span class="c1"># code
</span>        <span class="n">code_start</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'code='</span><span class="p">,</span> <span class="n">link</span><span class="p">).</span><span class="n">span</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">link</span><span class="p">[</span><span class="n">code_start</span><span class="p">:]</span>
        
        <span class="c1"># 상세 페이지 접속
</span>        <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
        <span class="n">link_html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">link_soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">link_html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
        
        <span class="c1"># 영화 정보
</span>        <span class="n">movie_info</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'mv_info'</span><span class="p">)</span>
        
        <span class="c1"># title_kor
</span>        <span class="n">title_kor</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">h3</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">text</span>
        
        <span class="c1"># title_eng
</span>        <span class="n">title_eng</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># year
</span>        <span class="n">year</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># rank
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="n">rank</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'span'</span><span class="p">)[</span><span class="mi">4</span><span class="p">].</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">text</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">rank</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>

        <span class="c1"># genre
</span>        <span class="n">genre</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">))):</span>
            <span class="n">genre</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="n">i</span><span class="p">].</span><span class="n">strip</span><span class="p">())</span>
        
        <span class="c1"># poster
</span>        <span class="n">poster_thumbnail</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'poster'</span><span class="p">).</span><span class="n">a</span><span class="p">.</span><span class="n">img</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'src'</span><span class="p">)</span>
        <span class="n">poster_end</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'</span><span class="si">\</span><span class="err">?</span><span class="se">'</span><span class="s">, poster_thumbnail).span()[0]
        poster_link = poster_thumbnail[:poster_end]
        poster_index = l * 50 + k
        # gif로 받아지는 경우 3개 채널로 다시 만들어주어야 함
        if np.asarray(Image.open(request.urlopen(poster_link))).ndim == 2:
            im = Image.open(request.urlopen(poster_link)).resize((256, 256))
            background = Image.new('</span><span class="n">RGB</span><span class="s">', im.size, (255, 255, 255))
            background.paste(im)
            poster_array = np.asarray(background)
        else:
            poster_array = np.asarray(Image.open(request.urlopen(poster_link)).resize((256, 256)))[:, :, :3]
        poster_animation[poster_index, :, :, :] = poster_array
        
        # 데이터프레임에 추가
        animation_df = animation_df.append({'</span><span class="n">code</span><span class="s">': code, '</span><span class="n">title_kor</span><span class="s">': title_kor, '</span><span class="n">title_eng</span><span class="s">': title_eng,
                                            '</span><span class="n">year</span><span class="s">': year, '</span><span class="n">rating</span><span class="s">': rating, '</span><span class="n">rank</span><span class="s">': rank, '</span><span class="n">link</span><span class="s">': link,
                                            '</span><span class="n">genre</span><span class="s">': genre}, ignore_index=True)
print('</span><span class="n">Completed</span><span class="err">!</span><span class="s">')
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>page 1 crawling...

100%|██████████| 50/50 [03:46&lt;00:00,  4.53s/it]

page 2 crawling...

100%|██████████| 50/50 [02:27&lt;00:00,  2.95s/it]

page 3 crawling...

100%|██████████| 50/50 [03:27&lt;00:00,  4.16s/it]

page 4 crawling...

100%|██████████| 50/50 [03:09&lt;00:00,  3.78s/it]

Completed!
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_animation</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">animation_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>69105</td>
      <td>월-E</td>
      <td>WALL-E</td>
      <td>2008</td>
      <td>9.41</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[애니메이션, SF, 가족, 코미디, 멜로/로맨스, 모험]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>32686</td>
      <td>센과 치히로의 행방불명</td>
      <td>千と千尋の神隠し</td>
      <td>2001</td>
      <td>9.39</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[애니메이션, 판타지, 모험, 가족]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>66463</td>
      <td>토이 스토리 3</td>
      <td>Toy Story 3</td>
      <td>2010</td>
      <td>9.38</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[애니메이션, 모험, 코미디, 가족, 판타지]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>130850</td>
      <td>주토피아</td>
      <td>Zootopia</td>
      <td>2016</td>
      <td>9.35</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[애니메이션, 액션, 모험, 코미디, 가족]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>19303</td>
      <td>모노노케 히메</td>
      <td>もののけ-: Mononoke Hime</td>
      <td>1997</td>
      <td>9.35</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[애니메이션, 모험, 액션]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>34449</td>
      <td>아이스 에이지</td>
      <td>Ice Age</td>
      <td>2002</td>
      <td>8.58</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[애니메이션, 모험, 가족, 판타지, 코미디]</td>
    </tr>
    <tr>
      <th>196</th>
      <td>122581</td>
      <td>극장판 도라에몽 진구의 아프리카 모험 : 베코와 5인의 탐험대</td>
      <td>映画ドラえもん 新・のび太の大魔境 ～ペコと5人の探検隊～</td>
      <td>2014</td>
      <td>8.58</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[애니메이션, 모험]</td>
    </tr>
    <tr>
      <th>197</th>
      <td>144355</td>
      <td>감바의 대모험</td>
      <td>GAMBA ガンバと仲間たち</td>
      <td>2015</td>
      <td>8.57</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[애니메이션]</td>
    </tr>
    <tr>
      <th>198</th>
      <td>17230</td>
      <td>포카혼타스</td>
      <td>Pocahontas</td>
      <td>1995</td>
      <td>8.57</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[애니메이션, 가족, 모험, 드라마, 멜로/로맨스]</td>
    </tr>
    <tr>
      <th>199</th>
      <td>134980</td>
      <td>마이펫의 이중생활</td>
      <td>The Secret Life of Pets</td>
      <td>2016</td>
      <td>8.56</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[애니메이션, 코미디, 가족]</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 8 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">animation_df</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>code         0
title_kor    0
title_eng    0
year         0
rating       0
rank         1
link         0
genre        0
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">animation_df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">animation_df</span><span class="p">[</span><span class="s">'rank'</span><span class="p">].</span><span class="n">isnull</span><span class="p">(),</span> <span class="s">'rank'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'전체 관람가'</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">animation_df</span><span class="p">.</span><span class="n">isnull</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>code         0
title_kor    0
title_eng    0
year         0
rating       0
rank         0
link         0
genre        0
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">animation_df</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'data/animation_df.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'images/poster_animation.npy'</span><span class="p">,</span> <span class="n">poster_animation</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">'images/poster_animation.npy'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">poster_a</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">poster_a</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(200, 256, 256, 3)





array([[[[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        ...,

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [254, 254, 254],
         [255, 255, 255],
         [255, 255, 255]],

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]]],


       [[[149,  21,  47],
         [126,  13,  38],
         [100,  14,  37],
         ...,
         [ 65,  43,  43],
         [ 67,  42,  44],
         [150,  27,  43]],

        [[190,  38,  71],
         [150,  22,  42],
         [115,   9,  37],
         ...,
         [ 70,  43,  44],
         [ 70,  42,  43],
         [156,  29,  43]],

        [[220,  76, 125],
         [165,  26,  46],
         [120,  10,  36],
         ...,
         [ 59,  44,  44],
         [ 77,  42,  44],
         [170,  36,  47]],

        ...,

        [[ 43,  55,  64],
         [ 44,  55,  65],
         [ 45,  55,  65],
         ...,
         [ 86,  80,  81],
         [ 86,  80,  81],
         [ 86,  80,  81]],

        [[ 44,  54,  64],
         [ 43,  55,  65],
         [ 44,  54,  64],
         ...,
         [ 86,  80,  81],
         [ 86,  80,  80],
         [ 86,  80,  81]],

        [[ 44,  54,  64],
         [ 44,  54,  64],
         [ 44,  54,  64],
         ...,
         [ 85,  79,  80],
         [ 85,  79,  79],
         [ 85,  79,  81]]],


       [[[  0,  19,  56],
         [  0,  18,  56],
         [  0,  21,  58],
         ...,
         [  2,  36,  81],
         [  2,  50,  95],
         [  2,  65, 110]],

        [[  0,  19,  57],
         [  1,  19,  57],
         [  1,  23,  60],
         ...,
         [  1,  70, 115],
         [  1,  64, 109],
         [  2,  51,  88]],

        [[  1,  22,  59],
         [  1,  25,  62],
         [  2,  28,  67],
         ...,
         [  1,  48,  87],
         [  1,  42,  80],
         [  0,  31,  64]],

        ...,

        [[ 19,  60, 108],
         [ 18,  60, 109],
         [ 21,  64, 114],
         ...,
         [  8,  44,  83],
         [ 10,  46,  85],
         [ 12,  48,  88]],

        [[ 19,  59, 109],
         [ 19,  61, 109],
         [ 15,  56, 104],
         ...,
         [  7,  44,  85],
         [  3,  41,  79],
         [  7,  45,  84]],

        [[ 11,  53,  97],
         [ 14,  55, 100],
         [ 13,  54,  99],
         ...,
         [  4,  43,  82],
         [  2,  40,  77],
         [  9,  44,  84]]],


       ...,


       [[[255, 255, 245],
         [255, 255, 245],
         [255, 255, 245],
         ...,
         [255, 255, 245],
         [255, 255, 245],
         [255, 255, 245]],

        [[255, 255, 245],
         [255, 255, 245],
         [255, 255, 245],
         ...,
         [255, 255, 245],
         [255, 255, 245],
         [255, 255, 245]],

        [[255, 255, 245],
         [255, 255, 245],
         [255, 255, 245],
         ...,
         [255, 255, 245],
         [255, 255, 245],
         [255, 255, 245]],

        ...,

        [[123, 158, 174],
         [127, 162, 178],
         [119, 156, 173],
         ...,
         [186, 199, 175],
         [163, 177, 151],
         [165, 173, 138]],

        [[ 91, 140, 163],
         [ 90, 139, 161],
         [ 97, 148, 163],
         ...,
         [221, 223, 207],
         [159, 157, 103],
         [170, 180, 138]],

        [[112, 161, 149],
         [121, 171, 145],
         [121, 171, 146],
         ...,
         [241, 246, 241],
         [179, 182, 134],
         [217, 218, 182]]],


       [[[229, 134, 154],
         [230, 135, 155],
         [229, 134, 154],
         ...,
         [238, 127, 170],
         [237, 126, 168],
         [239, 128, 170]],

        [[231, 136, 155],
         [232, 138, 156],
         [231, 137, 155],
         ...,
         [238, 127, 169],
         [237, 126, 168],
         [238, 127, 169]],

        [[234, 140, 158],
         [233, 139, 156],
         [233, 139, 156],
         ...,
         [238, 126, 169],
         [238, 126, 169],
         [239, 126, 169]],

        ...,

        [[ 26,  18,  16],
         [ 24,  16,  14],
         [ 22,  14,  12],
         ...,
         [254, 132, 145],
         [253, 131, 144],
         [253, 132, 145]],

        [[ 24,  16,  14],
         [ 23,  15,  13],
         [ 22,  14,  12],
         ...,
         [252, 129, 147],
         [253, 131, 148],
         [253, 131, 148]],

        [[ 23,  15,  13],
         [ 23,  15,  12],
         [ 23,  15,  13],
         ...,
         [253, 130, 150],
         [254, 129, 150],
         [252, 126, 148]]],


       [[[ 95, 109, 162],
         [ 92, 108, 168],
         [ 92, 108, 167],
         ...,
         [ 59,  86, 151],
         [ 58,  86, 151],
         [ 65,  88, 146]],

        [[100, 116, 176],
         [100, 119, 186],
         [100, 118, 186],
         ...,
         [ 64,  93, 167],
         [ 63,  93, 168],
         [ 68,  94, 160]],

        [[100, 117, 175],
         [ 99, 118, 186],
         [100, 116, 185],
         ...,
         [ 64,  92, 166],
         [ 63,  92, 167],
         [ 69,  94, 159]],

        ...,

        [[120,  84,  82],
         [121,  80,  77],
         [117,  77,  76],
         ...,
         [111,  75,  73],
         [118,  79,  77],
         [112,  80,  78]],

        [[118,  85,  84],
         [131,  91,  90],
         [123,  84,  83],
         ...,
         [123,  84,  82],
         [131,  91,  89],
         [115,  81,  79]],

        [[122,  89,  88],
         [117,  79,  79],
         [117,  79,  77],
         ...,
         [119,  81,  79],
         [120,  82,  80],
         [128,  93,  91]]]], dtype=uint8)
</code></pre></div></div>

<h3 id="f-crime">f. Crime</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s">'/Users/ohhyunkwon/Documents/2020 study/etc/chromedriver'</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">login_url</span><span class="p">)</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('id')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">id_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('pw')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">pw_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="frmNIDLogin"]/fieldset/input'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="new.dontsave"]'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">crime_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'code'</span><span class="p">,</span> <span class="s">'title_kor'</span><span class="p">,</span> <span class="s">'title_eng'</span><span class="p">,</span> <span class="s">'year'</span><span class="p">,</span>
                                 <span class="s">'rating'</span><span class="p">,</span> <span class="s">'rank'</span><span class="p">,</span> <span class="s">'link'</span><span class="p">,</span> <span class="s">'genre'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">crime_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_crime</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">'images/poster_crime'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'w+'</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 4 pages crawling
</span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'page '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">' crawling...'</span><span class="p">)</span>
    <span class="c1"># 단일 페이지 접속
</span>    <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">rank_url</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">genre</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)))):</span>
        <span class="c1"># link
</span>        <span class="n">link</span> <span class="o">=</span> <span class="n">basic_url</span> <span class="o">+</span> <span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">a</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'href'</span><span class="p">)</span>
        
        <span class="c1"># rating
</span>        <span class="n">rating</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'td'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'point'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">text</span>
        
        <span class="c1"># code
</span>        <span class="n">code_start</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'code='</span><span class="p">,</span> <span class="n">link</span><span class="p">).</span><span class="n">span</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">link</span><span class="p">[</span><span class="n">code_start</span><span class="p">:]</span>
        
        <span class="c1"># 상세 페이지 접속
</span>        <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
        <span class="n">link_html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">link_soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">link_html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
        
        <span class="c1"># 영화 정보
</span>        <span class="n">movie_info</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'mv_info'</span><span class="p">)</span>
        
        <span class="c1"># title_kor
</span>        <span class="n">title_kor</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">h3</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">text</span>
        
        <span class="c1"># title_eng
</span>        <span class="n">title_eng</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># year
</span>        <span class="n">year</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># rank
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="n">rank</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'span'</span><span class="p">)[</span><span class="mi">4</span><span class="p">].</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">text</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">rank</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>

        <span class="c1"># genre
</span>        <span class="n">genre</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">))):</span>
            <span class="n">genre</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="n">i</span><span class="p">].</span><span class="n">strip</span><span class="p">())</span>
        
        <span class="c1"># poster
</span>        <span class="n">poster_thumbnail</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'poster'</span><span class="p">).</span><span class="n">a</span><span class="p">.</span><span class="n">img</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'src'</span><span class="p">)</span>
        <span class="n">poster_end</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'</span><span class="si">\</span><span class="err">?</span><span class="se">'</span><span class="s">, poster_thumbnail).span()[0]
        poster_link = poster_thumbnail[:poster_end]
        poster_index = l * 50 + k
        # gif로 받아지는 경우 3개 채널로 다시 만들어주어야 함
        if np.asarray(Image.open(request.urlopen(poster_link))).ndim == 2:
            im = Image.open(request.urlopen(poster_link)).resize((256, 256))
            background = Image.new('</span><span class="n">RGB</span><span class="s">', im.size, (255, 255, 255))
            background.paste(im)
            poster_array = np.asarray(background)
        else:
            poster_array = np.asarray(Image.open(request.urlopen(poster_link)).resize((256, 256)))[:, :, :3]
        poster_crime[poster_index, :, :, :] = poster_array
        
        # 데이터프레임에 추가
        crime_df = crime_df.append({'</span><span class="n">code</span><span class="s">': code, '</span><span class="n">title_kor</span><span class="s">': title_kor, '</span><span class="n">title_eng</span><span class="s">': title_eng,
                                    '</span><span class="n">year</span><span class="s">': year, '</span><span class="n">rating</span><span class="s">': rating, '</span><span class="n">rank</span><span class="s">': rank, '</span><span class="n">link</span><span class="s">': link,
                                    '</span><span class="n">genre</span><span class="s">': genre}, ignore_index=True)
print('</span><span class="n">Completed</span><span class="err">!</span><span class="s">')
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>page 1 crawling...

100%|██████████| 50/50 [03:36&lt;00:00,  4.33s/it]

page 2 crawling...

100%|██████████| 50/50 [02:01&lt;00:00,  2.44s/it]

page 3 crawling...

100%|██████████| 50/50 [01:57&lt;00:00,  2.35s/it]

page 4 crawling...

100%|██████████| 50/50 [02:37&lt;00:00,  3.15s/it]

Completed!
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_crime</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">crime_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>35901</td>
      <td>살인의 추억</td>
      <td>Memories Of Murder</td>
      <td>2003</td>
      <td>9.40</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[범죄, 미스터리, 스릴러, 코미디, 드라마]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17170</td>
      <td>레옹</td>
      <td>Leon</td>
      <td>1994</td>
      <td>9.37</td>
      <td>청소년 관람불가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[범죄, 액션, 드라마]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>29657</td>
      <td>프리퀀시</td>
      <td>Frequency</td>
      <td>2000</td>
      <td>9.32</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[범죄, 드라마, SF, 스릴러]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>51462</td>
      <td>그랜 토리노</td>
      <td>Gran Torino</td>
      <td>2008</td>
      <td>9.23</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[범죄, 드라마]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10561</td>
      <td>대부 3</td>
      <td>Mario Puzo's The Godfather Part III</td>
      <td>1990</td>
      <td>9.21</td>
      <td>청소년 관람불가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[범죄, 드라마]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>43568</td>
      <td>모노폴리</td>
      <td>Monopoly</td>
      <td>2006</td>
      <td>6.42</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[범죄, 스릴러]</td>
    </tr>
    <tr>
      <th>196</th>
      <td>69742</td>
      <td>킬 위드 미</td>
      <td>Untraceable</td>
      <td>2008</td>
      <td>6.36</td>
      <td>청소년 관람불가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[범죄, 스릴러]</td>
    </tr>
    <tr>
      <th>197</th>
      <td>154112</td>
      <td>불한당: 나쁜 놈들의 세상</td>
      <td>The Merciless</td>
      <td>2016</td>
      <td>6.35</td>
      <td>청소년 관람불가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[범죄, 액션, 드라마]</td>
    </tr>
    <tr>
      <th>198</th>
      <td>157297</td>
      <td>마약왕</td>
      <td>THE DRUG KING</td>
      <td>2017</td>
      <td>6.33</td>
      <td>청소년 관람불가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[범죄, 드라마]</td>
    </tr>
    <tr>
      <th>199</th>
      <td>65340</td>
      <td>쏘우 4</td>
      <td>Saw IV</td>
      <td>2007</td>
      <td>6.32</td>
      <td>청소년 관람불가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[범죄, 스릴러, 공포]</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 8 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">crime_df</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'data/crime_df.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'images/poster_crime.npy'</span><span class="p">,</span> <span class="n">poster_crime</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_cr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">'images/poster_crime.npy'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">poster_cr</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">poster_cr</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(200, 256, 256, 3)





array([[[[ 96, 115, 119],
         [ 95, 114, 118],
         [ 94, 114, 118],
         ...,
         [ 67,  85,  89],
         [ 67,  85,  89],
         [ 62,  80,  84]],

        [[ 95, 114, 118],
         [ 98, 116, 121],
         [ 99, 119, 122],
         ...,
         [ 62,  80,  84],
         [ 66,  84,  88],
         [ 72,  90,  94]],

        [[ 99, 118, 122],
         [ 99, 118, 122],
         [ 99, 118, 122],
         ...,
         [ 73,  91,  95],
         [ 65,  83,  87],
         [ 66,  84,  88]],

        ...,

        [[  5,   7,   6],
         [  5,   7,   6],
         [  5,   7,   6],
         ...,
         [ 14,  23,  23],
         [ 12,  20,  20],
         [ 21,  30,  30]],

        [[  5,   7,   6],
         [  5,   7,   6],
         [  5,   7,   6],
         ...,
         [ 33,  42,  41],
         [ 22,  31,  30],
         [ 25,  34,  33]],

        [[  7,   9,   8],
         [  7,   9,   8],
         [  7,   9,   8],
         ...,
         [ 41,  49,  51],
         [ 44,  52,  53],
         [ 37,  45,  47]]],


       [[[ 19,  31,  58],
         [ 62,  74,  90],
         [120, 150, 182],
         ...,
         [123, 155, 188],
         [120, 145, 171],
         [ 87, 101, 119]],

        [[ 33,  41,  58],
         [ 79,  90, 107],
         [116, 151, 185],
         ...,
         [114, 148, 179],
         [106, 127, 147],
         [ 80,  89, 106]],

        [[ 39,  49,  64],
         [ 86, 100, 122],
         [116, 153, 188],
         ...,
         [ 95, 118, 145],
         [ 97, 113, 132],
         [ 80,  91, 107]],

        ...,

        [[128, 105,  76],
         [127, 103,  73],
         [131, 104,  75],
         ...,
         [ 95,  87,  71],
         [ 95,  88,  72],
         [ 94,  86,  71]],

        [[133, 104,  73],
         [135, 104,  70],
         [136, 107,  73],
         ...,
         [ 97,  87,  70],
         [ 94,  87,  71],
         [ 94,  87,  69]],

        [[137, 108,  73],
         [138, 107,  78],
         [140, 109,  78],
         ...,
         [ 96,  86,  70],
         [ 97,  88,  73],
         [ 94,  86,  68]]],


       [[[209, 151, 141],
         [207, 148, 139],
         [204, 143, 136],
         ...,
         [ 87,  46,  55],
         [ 98,  54,  44],
         [ 90,  42,  46]],

        [[223, 187, 186],
         [235, 215, 204],
         [232, 201, 187],
         ...,
         [143, 101,  66],
         [113,  75,  55],
         [123,  70,  53]],

        [[225, 192, 178],
         [231, 209, 194],
         [239, 222, 207],
         ...,
         [143, 100,  70],
         [ 90,  55,  44],
         [144,  80,  58]],

        ...,

        [[ 28,  15,  22],
         [ 25,  12,  19],
         [ 27,  14,  21],
         ...,
         [ 58,  47,  43],
         [ 60,  49,  45],
         [ 64,  54,  50]],

        [[ 30,  17,  24],
         [ 26,  13,  20],
         [ 32,  19,  26],
         ...,
         [ 56,  46,  42],
         [ 58,  47,  43],
         [ 61,  49,  46]],

        [[ 29,  16,  23],
         [ 30,  17,  24],
         [ 29,  16,  24],
         ...,
         [ 48,  40,  37],
         [ 51,  39,  37],
         [ 66,  51,  50]]],


       ...,


       [[[164, 127, 119],
         [119,  96,  98],
         [ 35,  37,  44],
         ...,
         [210, 221, 228],
         [209, 220, 225],
         [207, 216, 229]],

        [[148, 110, 103],
         [120,  92,  91],
         [ 45,  43,  47],
         ...,
         [213, 223, 232],
         [211, 221, 229],
         [209, 219, 230]],

        [[ 98,  70,  68],
         [ 90,  67,  68],
         [ 46,  41,  42],
         ...,
         [218, 228, 237],
         [214, 224, 233],
         [213, 223, 232]],

        ...,

        [[ 10,  18,  20],
         [ 10,  18,  20],
         [ 12,  20,  22],
         ...,
         [ 18,  25,  35],
         [ 18,  25,  35],
         [ 18,  25,  35]],

        [[ 10,  18,  20],
         [ 11,  19,  21],
         [ 12,  20,  22],
         ...,
         [ 18,  25,  35],
         [ 18,  25,  35],
         [ 18,  25,  35]],

        [[ 10,  18,  20],
         [ 10,  18,  20],
         [ 10,  18,  20],
         ...,
         [ 18,  25,  35],
         [ 18,  25,  35],
         [ 18,  25,  35]]],


       [[[ 84,  66,  41],
         [ 92,  75,  49],
         [104,  86,  54],
         ...,
         [157,  76,  35],
         [159,  77,  36],
         [160,  82,  40]],

        [[ 88,  68,  43],
         [ 96,  76,  49],
         [108,  88,  56],
         ...,
         [154,  70,  33],
         [157,  73,  35],
         [161,  80,  38]],

        [[ 88,  68,  43],
         [ 97,  77,  48],
         [112,  89,  58],
         ...,
         [157,  72,  34],
         [158,  71,  32],
         [160,  74,  36]],

        ...,

        [[ 15,  10,   7],
         [ 15,  10,   7],
         [ 14,  10,   7],
         ...,
         [  8,   4,   3],
         [  8,   4,   3],
         [  7,   3,   2]],

        [[ 16,  11,   8],
         [ 15,  10,   7],
         [ 13,   9,   7],
         ...,
         [  8,   4,   3],
         [  8,   4,   3],
         [  8,   4,   3]],

        [[ 15,  10,   7],
         [ 14,   9,   7],
         [ 14,  10,   8],
         ...,
         [  8,   4,   3],
         [  8,   4,   3],
         [  8,   4,   3]]],


       [[[227, 222, 219],
         [227, 222, 219],
         [227, 222, 219],
         ...,
         [188, 179, 171],
         [192, 183, 174],
         [191, 182, 173]],

        [[227, 222, 219],
         [227, 222, 219],
         [227, 222, 219],
         ...,
         [186, 178, 167],
         [188, 180, 170],
         [189, 180, 171]],

        [[227, 222, 219],
         [227, 222, 219],
         [227, 222, 219],
         ...,
         [181, 173, 162],
         [183, 174, 164],
         [185, 176, 167]],

        ...,

        [[252, 250, 251],
         [250, 248, 249],
         [248, 246, 247],
         ...,
         [  2,   2,   2],
         [  2,   2,   2],
         [  3,   3,   3]],

        [[253, 252, 252],
         [252, 250, 251],
         [250, 248, 249],
         ...,
         [  3,   3,   3],
         [  4,   4,   4],
         [  3,   3,   3]],

        [[254, 254, 254],
         [253, 252, 253],
         [253, 251, 252],
         ...,
         [  4,   4,   4],
         [  6,   6,   6],
         [  5,   5,   5]]]], dtype=uint8)
</code></pre></div></div>

<h3 id="g-action">g. Action</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s">'/Users/ohhyunkwon/Documents/2020 study/etc/chromedriver'</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">login_url</span><span class="p">)</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('id')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">id_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">execute_script</span><span class="p">(</span><span class="s">"document.getElementsByName('pw')[0].value=</span><span class="si">\</span><span class="se">'</span><span class="s">"</span> <span class="o">+</span> <span class="n">pw_key</span> <span class="o">+</span> <span class="s">"</span><span class="si">\</span><span class="se">'</span><span class="s">"</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="frmNIDLogin"]/fieldset/input'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
<span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s">'//*[@id="new.dontsave"]'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">action_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'code'</span><span class="p">,</span> <span class="s">'title_kor'</span><span class="p">,</span> <span class="s">'title_eng'</span><span class="p">,</span> <span class="s">'year'</span><span class="p">,</span>
                                  <span class="s">'rating'</span><span class="p">,</span> <span class="s">'rank'</span><span class="p">,</span> <span class="s">'link'</span><span class="p">,</span> <span class="s">'genre'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">action_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_action</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">memmap</span><span class="p">(</span><span class="s">'images/poster_action'</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint8</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">'w+'</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 4 pages crawling
</span><span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'page '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">' crawling...'</span><span class="p">)</span>
    <span class="c1"># 단일 페이지 접속
</span>    <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">rank_url</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">genre</span><span class="o">=</span><span class="mi">19</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)))):</span>
        <span class="c1"># link
</span>        <span class="n">link</span> <span class="o">=</span> <span class="n">basic_url</span> <span class="o">+</span> <span class="n">soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'table'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'list_ranking'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'tit5'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">a</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'href'</span><span class="p">)</span>
        
        <span class="c1"># rating
</span>        <span class="n">rating</span> <span class="o">=</span> <span class="n">soup</span><span class="p">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">'td'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'point'</span><span class="p">)[</span><span class="n">k</span><span class="p">].</span><span class="n">text</span>
        
        <span class="c1"># code
</span>        <span class="n">code_start</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'code='</span><span class="p">,</span> <span class="n">link</span><span class="p">).</span><span class="n">span</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">link</span><span class="p">[</span><span class="n">code_start</span><span class="p">:]</span>
        
        <span class="c1"># 상세 페이지 접속
</span>        <span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
        <span class="n">link_html</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">page_source</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">link_soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">link_html</span><span class="p">,</span> <span class="s">'lxml'</span><span class="p">)</span>
        
        <span class="c1"># 영화 정보
</span>        <span class="n">movie_info</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'mv_info'</span><span class="p">)</span>
        
        <span class="c1"># title_kor
</span>        <span class="n">title_kor</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">h3</span><span class="p">.</span><span class="n">a</span><span class="p">.</span><span class="n">text</span>
        
        <span class="c1"># title_eng
</span>        <span class="n">title_eng</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># year
</span>        <span class="n">year</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">strong</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">strip</span><span class="p">()</span>
        
        <span class="c1"># rank
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="n">rank</span> <span class="o">=</span> <span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">).</span><span class="n">find_all</span><span class="p">(</span><span class="s">'span'</span><span class="p">)[</span><span class="mi">4</span><span class="p">].</span><span class="n">find_all</span><span class="p">(</span><span class="s">'a'</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">text</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">rank</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">nan</span>

        <span class="c1"># genre
</span>        <span class="n">genre</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">))):</span>
            <span class="n">genre</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">movie_info</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'p'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'info_spec'</span><span class="p">).</span><span class="n">span</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">','</span><span class="p">)[</span><span class="n">i</span><span class="p">].</span><span class="n">strip</span><span class="p">())</span>
        
        <span class="c1"># poster
</span>        <span class="n">poster_thumbnail</span> <span class="o">=</span> <span class="n">link_soup</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">'div'</span><span class="p">,</span> <span class="n">class_</span><span class="o">=</span><span class="s">'poster'</span><span class="p">).</span><span class="n">a</span><span class="p">.</span><span class="n">img</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'src'</span><span class="p">)</span>
        <span class="n">poster_end</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'</span><span class="si">\</span><span class="err">?</span><span class="se">'</span><span class="s">, poster_thumbnail).span()[0]
        poster_link = poster_thumbnail[:poster_end]
        poster_index = l * 50 + k
        # gif로 받아지는 경우 3개 채널로 다시 만들어주어야 함
        if np.asarray(Image.open(request.urlopen(poster_link))).ndim == 2:
            im = Image.open(request.urlopen(poster_link)).resize((256, 256))
            background = Image.new('</span><span class="n">RGB</span><span class="s">', im.size, (255, 255, 255))
            background.paste(im)
            poster_array = np.asarray(background)
        else:
            poster_array = np.asarray(Image.open(request.urlopen(poster_link)).resize((256, 256)))[:, :, :3]
        poster_action[poster_index, :, :, :] = poster_array
        
        # 데이터프레임에 추가
        action_df = action_df.append({'</span><span class="n">code</span><span class="s">': code, '</span><span class="n">title_kor</span><span class="s">': title_kor, '</span><span class="n">title_eng</span><span class="s">': title_eng,
                                      '</span><span class="n">year</span><span class="s">': year, '</span><span class="n">rating</span><span class="s">': rating, '</span><span class="n">rank</span><span class="s">': rank, '</span><span class="n">link</span><span class="s">': link,
                                      '</span><span class="n">genre</span><span class="s">': genre}, ignore_index=True)
print('</span><span class="n">Completed</span><span class="err">!</span><span class="s">')
</span></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>page 1 crawling...

100%|██████████| 50/50 [03:05&lt;00:00,  3.71s/it]

page 2 crawling...

100%|██████████| 50/50 [03:25&lt;00:00,  4.11s/it]

page 3 crawling...

100%|██████████| 50/50 [03:28&lt;00:00,  4.17s/it]

page 4 crawling...

100%|██████████| 50/50 [03:23&lt;00:00,  4.08s/it]

Completed!
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">driver</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_action</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">action_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>181710</td>
      <td>포드 V 페라리</td>
      <td>FORD v FERRARI</td>
      <td>2019</td>
      <td>9.49</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 드라마]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29217</td>
      <td>글래디에이터</td>
      <td>Gladiator</td>
      <td>2000</td>
      <td>9.39</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 드라마]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>136900</td>
      <td>어벤져스: 엔드게임</td>
      <td>Avengers: Endgame</td>
      <td>2019</td>
      <td>9.38</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, SF]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>92125</td>
      <td>헌터 킬러</td>
      <td>Hunter Killer</td>
      <td>2018</td>
      <td>9.37</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 스릴러]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>37886</td>
      <td>클레멘타인</td>
      <td>Clementine</td>
      <td>2004</td>
      <td>9.35</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 드라마]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>195</th>
      <td>41334</td>
      <td>옹박 - 두번째 미션</td>
      <td>The Protector</td>
      <td>2005</td>
      <td>8.28</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 범죄, 드라마, 스릴러]</td>
    </tr>
    <tr>
      <th>196</th>
      <td>162249</td>
      <td>램페이지</td>
      <td>RAMPAGE</td>
      <td>2018</td>
      <td>8.28</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 모험]</td>
    </tr>
    <tr>
      <th>197</th>
      <td>82473</td>
      <td>캐리비안의 해적: 죽은 자는 말이 없다</td>
      <td>Pirates of the Caribbean: Dead Men Tell No Tales</td>
      <td>2017</td>
      <td>8.28</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 모험, 코미디, 판타지]</td>
    </tr>
    <tr>
      <th>198</th>
      <td>31606</td>
      <td>킬러들의 수다</td>
      <td>Guns &amp; Talks</td>
      <td>2001</td>
      <td>8.28</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 드라마, 코미디]</td>
    </tr>
    <tr>
      <th>199</th>
      <td>51082</td>
      <td>7급 공무원</td>
      <td>7th Grade Civil Servant</td>
      <td>2009</td>
      <td>8.28</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 코미디]</td>
    </tr>
  </tbody>
</table>
<p>200 rows × 8 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">action_df</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'data/action_df.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'images/poster_action.npy'</span><span class="p">,</span> <span class="n">poster_action</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_ac</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">'images/poster_action.npy'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">poster_ac</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">poster_ac</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(200, 256, 256, 3)





array([[[[171, 192, 215],
         [171, 193, 215],
         [171, 193, 215],
         ...,
         [183, 179, 175],
         [175, 172, 167],
         [170, 167, 162]],

        [[172, 194, 217],
         [172, 193, 216],
         [171, 192, 216],
         ...,
         [180, 177, 172],
         [182, 179, 174],
         [185, 182, 177]],

        [[167, 191, 213],
         [169, 192, 215],
         [168, 192, 215],
         ...,
         [207, 203, 199],
         [209, 205, 201],
         [211, 207, 202]],

        ...,

        [[ 65,  56,  47],
         [ 65,  56,  47],
         [ 67,  58,  49],
         ...,
         [ 17,  18,  21],
         [ 16,  17,  19],
         [ 14,  15,  18]],

        [[ 65,  56,  47],
         [ 66,  57,  48],
         [ 65,  56,  47],
         ...,
         [ 17,  18,  21],
         [ 16,  17,  20],
         [ 15,  16,  19]],

        [[ 63,  55,  46],
         [ 64,  55,  46],
         [ 64,  55,  46],
         ...,
         [ 17,  18,  20],
         [ 15,  16,  19],
         [ 16,  17,  21]]],


       [[[249, 255, 252],
         [238, 242, 239],
         [231, 232, 230],
         ...,
         [228, 228, 228],
         [240, 240, 240],
         [255, 255, 255]],

        [[255, 255, 255],
         [145, 144, 142],
         [ 55,  50,  49],
         ...,
         [ 30,  30,  30],
         [135, 135, 135],
         [255, 255, 255]],

        [[255, 255, 255],
         [135, 129, 129],
         [ 31,  21,  22],
         ...,
         [  0,   0,   0],
         [119, 119, 119],
         [255, 255, 255]],

        ...,

        [[255, 255, 255],
         [117, 117, 117],
         [  0,   0,   0],
         ...,
         [  0,   0,   0],
         [117, 117, 117],
         [255, 255, 255]],

        [[255, 255, 255],
         [134, 134, 134],
         [ 29,  29,  29],
         ...,
         [ 29,  29,  29],
         [133, 133, 133],
         [255, 255, 255]],

        [[255, 255, 255],
         [238, 238, 238],
         [228, 228, 228],
         ...,
         [227, 227, 227],
         [239, 239, 239],
         [255, 255, 255]]],


       [[[  6,   4,  19],
         [  5,   4,  12],
         [  4,   3,  11],
         ...,
         [  1,   1,   1],
         [  1,   1,   1],
         [  1,   1,   1]],

        [[ 24,  18,  58],
         [  6,   4,  18],
         [  5,   4,  11],
         ...,
         [  1,   1,   1],
         [  1,   1,   1],
         [  1,   1,   1]],

        [[ 38,  30,  89],
         [ 15,  11,  42],
         [  5,   4,  14],
         ...,
         [  1,   1,   1],
         [  1,   1,   1],
         [  1,   1,   1]],

        ...,

        [[  1,   1,   2],
         [  1,   1,   2],
         [  1,   1,   1],
         ...,
         [  4,   3,   9],
         [  2,   1,   6],
         [  2,   2,   5]],

        [[  1,   1,   2],
         [  1,   1,   1],
         [  1,   1,   1],
         ...,
         [  4,   3,   9],
         [  2,   2,   7],
         [  2,   1,   5]],

        [[  2,   1,   4],
         [  1,   1,   1],
         [  1,   1,   1],
         ...,
         [  3,   2,   7],
         [  2,   1,   5],
         [  1,   1,   3]]],


       ...,


       [[[107, 147, 155],
         [106, 146, 153],
         [107, 146, 154],
         ...,
         [214, 222, 204],
         [214, 223, 206],
         [213, 222, 204]],

        [[106, 146, 153],
         [106, 147, 154],
         [105, 147, 153],
         ...,
         [215, 222, 204],
         [214, 222, 206],
         [216, 223, 204]],

        [[106, 146, 154],
         [107, 147, 154],
         [104, 146, 152],
         ...,
         [215, 222, 204],
         [215, 222, 205],
         [210, 220, 204]],

        ...,

        [[ 16,  24,  34],
         [ 16,  23,  32],
         [ 16,  23,  32],
         ...,
         [ 16,  21,  28],
         [ 16,  20,  29],
         [ 16,  20,  29]],

        [[ 18,  23,  34],
         [ 17,  23,  34],
         [ 17,  23,  32],
         ...,
         [ 17,  21,  30],
         [ 14,  20,  30],
         [ 15,  20,  30]],

        [[ 18,  22,  33],
         [ 18,  23,  35],
         [ 17,  22,  33],
         ...,
         [ 20,  22,  30],
         [ 45,  29,  30],
         [ 28,  22,  29]]],


       [[[237, 254, 248],
         [250, 250, 250],
         [255, 249, 253],
         ...,
         [252, 250, 250],
         [254, 250, 250],
         [254, 252, 254]],

        [[242, 254, 249],
         [252, 251, 251],
         [244, 243, 245],
         ...,
         [236, 244, 239],
         [253, 253, 253],
         [254, 252, 255]],

        [[248, 253, 251],
         [255, 253, 254],
         [226, 232, 232],
         ...,
         [163, 172, 164],
         [238, 239, 241],
         [254, 253, 255]],

        ...,

        [[252, 252, 252],
         [255, 255, 255],
         [188, 188, 188],
         ...,
         [113, 113, 113],
         [220, 220, 220],
         [255, 255, 255]],

        [[251, 251, 251],
         [251, 251, 251],
         [249, 249, 249],
         ...,
         [152, 152, 152],
         [225, 225, 225],
         [255, 255, 255]],

        [[252, 252, 252],
         [253, 253, 253],
         [254, 254, 254],
         ...,
         [252, 252, 252],
         [252, 252, 252],
         [255, 255, 255]]],


       [[[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [179,  47,  35],
         [179,  47,  35],
         [179,  47,  35]],

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [180,  48,  33],
         [179,  47,  33],
         [179,  47,  33]],

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [181,  49,  32],
         [181,  49,  35],
         [181,  49,  35]],

        ...,

        [[ 96,   4,   8],
         [ 58,   2,   1],
         [ 15,   1,   0],
         ...,
         [136,  27,  33],
         [138,  27,  33],
         [138,  27,  33]],

        [[ 82,   4,   4],
         [ 32,   1,   2],
         [ 12,   2,   3],
         ...,
         [136,  27,  32],
         [138,  27,  33],
         [138,  27,  33]],

        [[ 52,   1,   3],
         [ 10,   1,   2],
         [ 38,   4,   6],
         ...,
         [138,  27,  33],
         [137,  26,  32],
         [138,  27,  33]]]], dtype=uint8)
</code></pre></div></div>

<h2 id="total-dataframe">Total Dataframe</h2>

<h3 id="poster를-제외한-나머지-변수들-포함된-데이터">poster를 제외한 나머지 변수들 포함된 데이터</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">total_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'code'</span><span class="p">,</span> <span class="s">'title_kor'</span><span class="p">,</span> <span class="s">'title_eng'</span><span class="p">,</span> <span class="s">'year'</span><span class="p">,</span>
                                 <span class="s">'rating'</span><span class="p">,</span> <span class="s">'rank'</span><span class="p">,</span> <span class="s">'link'</span><span class="p">,</span> <span class="s">'genre'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">total_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">total_df</span> <span class="o">=</span> <span class="n">total_df</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">drama_df</span><span class="p">).</span><span class="n">append</span><span class="p">(</span><span class="n">horror_df</span><span class="p">).</span><span class="n">append</span><span class="p">(</span><span class="n">romance_df</span><span class="p">)</span>\
                   <span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">comedy_df</span><span class="p">).</span><span class="n">append</span><span class="p">(</span><span class="n">animation_df</span><span class="p">).</span><span class="n">append</span><span class="p">(</span><span class="n">crime_df</span><span class="p">).</span><span class="n">append</span><span class="p">(</span><span class="n">action_df</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">total_df</span> <span class="o">=</span> <span class="n">total_df</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">total_df</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>title_kor</th>
      <th>title_eng</th>
      <th>year</th>
      <th>rating</th>
      <th>rank</th>
      <th>link</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>171539</td>
      <td>그린 북</td>
      <td>Green Book</td>
      <td>2018</td>
      <td>9.59</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마]</td>
    </tr>
    <tr>
      <th>1</th>
      <td>174830</td>
      <td>가버나움</td>
      <td>Capharnaum</td>
      <td>2018</td>
      <td>9.58</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마]</td>
    </tr>
    <tr>
      <th>2</th>
      <td>151196</td>
      <td>원더</td>
      <td>Wonder</td>
      <td>2017</td>
      <td>9.49</td>
      <td>전체 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마]</td>
    </tr>
    <tr>
      <th>3</th>
      <td>169240</td>
      <td>아일라</td>
      <td>Ayla: The Daughter of War</td>
      <td>2017</td>
      <td>9.48</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마, 전쟁]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>157243</td>
      <td>당갈</td>
      <td>Dangal</td>
      <td>2016</td>
      <td>9.47</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[드라마, 액션]</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1395</th>
      <td>41334</td>
      <td>옹박 - 두번째 미션</td>
      <td>The Protector</td>
      <td>2005</td>
      <td>8.28</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 범죄, 드라마, 스릴러]</td>
    </tr>
    <tr>
      <th>1396</th>
      <td>162249</td>
      <td>램페이지</td>
      <td>RAMPAGE</td>
      <td>2018</td>
      <td>8.28</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 모험]</td>
    </tr>
    <tr>
      <th>1397</th>
      <td>82473</td>
      <td>캐리비안의 해적: 죽은 자는 말이 없다</td>
      <td>Pirates of the Caribbean: Dead Men Tell No Tales</td>
      <td>2017</td>
      <td>8.28</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 모험, 코미디, 판타지]</td>
    </tr>
    <tr>
      <th>1398</th>
      <td>31606</td>
      <td>킬러들의 수다</td>
      <td>Guns &amp; Talks</td>
      <td>2001</td>
      <td>8.28</td>
      <td>15세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 드라마, 코미디]</td>
    </tr>
    <tr>
      <th>1399</th>
      <td>51082</td>
      <td>7급 공무원</td>
      <td>7th Grade Civil Servant</td>
      <td>2009</td>
      <td>8.28</td>
      <td>12세 관람가</td>
      <td>https://movie.naver.com/movie/bi/mi/basic.nhn?...</td>
      <td>[액션, 코미디]</td>
    </tr>
  </tbody>
</table>
<p>1400 rows × 8 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">total_df</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'data/total_df.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="poster-데이터">poster 데이터</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">poster_total</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">r_</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">r_</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">r_</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">r_</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">r_</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">r_</span><span class="p">[</span><span class="n">poster_d</span><span class="p">,</span> <span class="n">poster_h</span><span class="p">],</span> <span class="n">poster_r</span><span class="p">],</span> <span class="n">poster_c</span><span class="p">],</span> <span class="n">poster_a</span><span class="p">],</span> <span class="n">poster_cr</span><span class="p">],</span> <span class="n">poster_ac</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">poster_total</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">poster_total</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(1400, 256, 256, 3)





array([[[[  0, 100, 116],
         [  0, 100, 116],
         [  0, 100, 117],
         ...,
         [  1, 115, 141],
         [  0, 116, 141],
         [  1, 117, 142]],

        [[  0, 100, 116],
         [  0, 100, 115],
         [  0, 101, 118],
         ...,
         [  0, 115, 141],
         [  0, 116, 141],
         [  0, 116, 141]],

        [[  0, 101, 116],
         [  0, 101, 116],
         [  0, 101, 118],
         ...,
         [  1, 117, 142],
         [  1, 117, 142],
         [  1, 117, 142]],

        ...,

        [[  0, 106, 130],
         [  1, 107, 131],
         [  0, 108, 132],
         ...,
         [  0, 105, 127],
         [  0, 105, 127],
         [  0, 105, 127]],

        [[  0, 106, 130],
         [  0, 106, 130],
         [  1, 107, 131],
         ...,
         [  1, 104, 127],
         [  1, 104, 126],
         [  1, 104, 127]],

        [[  0, 106, 130],
         [  0, 106, 130],
         [  1, 107, 131],
         ...,
         [  1, 104, 127],
         [  1, 104, 127],
         [  2, 104, 127]]],


       [[[227, 221, 218],
         [231, 231, 227],
         [237, 238, 239],
         ...,
         [ 87,  56,  93],
         [ 89,  58,  94],
         [ 89,  57,  92]],

        [[231, 229, 226],
         [232, 231, 227],
         [237, 237, 236],
         ...,
         [ 89,  58,  95],
         [ 88,  58,  93],
         [ 89,  58,  94]],

        [[236, 235, 233],
         [236, 236, 235],
         [237, 237, 236],
         ...,
         [ 88,  58,  96],
         [ 88,  58,  95],
         [ 89,  58,  94]],

        ...,

        [[104, 129, 151],
         [105, 128, 150],
         [106, 130, 152],
         ...,
         [125, 125,  84],
         [123, 124,  94],
         [ 97, 104, 102]],

        [[103, 129, 151],
         [102, 128, 150],
         [104, 129, 152],
         ...,
         [115, 118,  87],
         [111, 115,  91],
         [ 87,  96,  99]],

        [[100, 129, 149],
         [100, 128, 149],
         [103, 128, 150],
         ...,
         [106, 112,  85],
         [ 97, 106,  86],
         [ 79,  85,  93]]],


       [[[242, 225, 217],
         [241, 223, 213],
         [241, 222, 212],
         ...,
         [250, 250, 231],
         [253, 252, 248],
         [253, 253, 252]],

        [[252, 252, 252],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        [[247, 234, 229],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [255, 255, 255],
         [255, 255, 255],
         [255, 255, 255]],

        ...,

        [[100,  97,  86],
         [ 98,  95,  85],
         [ 96,  95,  85],
         ...,
         [114, 102,  86],
         [111,  98,  79],
         [114,  97,  77]],

        [[100,  99,  90],
         [ 89,  88,  79],
         [ 76,  73,  65],
         ...,
         [114, 100,  81],
         [118, 102,  83],
         [119, 100,  80]],

        [[ 90,  89,  83],
         [ 89,  86,  80],
         [ 88,  83,  76],
         ...,
         [102,  90,  73],
         [104,  92,  76],
         [103,  88,  74]]],


       ...,


       [[[107, 147, 155],
         [106, 146, 153],
         [107, 146, 154],
         ...,
         [214, 222, 204],
         [214, 223, 206],
         [213, 222, 204]],

        [[106, 146, 153],
         [106, 147, 154],
         [105, 147, 153],
         ...,
         [215, 222, 204],
         [214, 222, 206],
         [216, 223, 204]],

        [[106, 146, 154],
         [107, 147, 154],
         [104, 146, 152],
         ...,
         [215, 222, 204],
         [215, 222, 205],
         [210, 220, 204]],

        ...,

        [[ 16,  24,  34],
         [ 16,  23,  32],
         [ 16,  23,  32],
         ...,
         [ 16,  21,  28],
         [ 16,  20,  29],
         [ 16,  20,  29]],

        [[ 18,  23,  34],
         [ 17,  23,  34],
         [ 17,  23,  32],
         ...,
         [ 17,  21,  30],
         [ 14,  20,  30],
         [ 15,  20,  30]],

        [[ 18,  22,  33],
         [ 18,  23,  35],
         [ 17,  22,  33],
         ...,
         [ 20,  22,  30],
         [ 45,  29,  30],
         [ 28,  22,  29]]],


       [[[237, 254, 248],
         [250, 250, 250],
         [255, 249, 253],
         ...,
         [252, 250, 250],
         [254, 250, 250],
         [254, 252, 254]],

        [[242, 254, 249],
         [252, 251, 251],
         [244, 243, 245],
         ...,
         [236, 244, 239],
         [253, 253, 253],
         [254, 252, 255]],

        [[248, 253, 251],
         [255, 253, 254],
         [226, 232, 232],
         ...,
         [163, 172, 164],
         [238, 239, 241],
         [254, 253, 255]],

        ...,

        [[252, 252, 252],
         [255, 255, 255],
         [188, 188, 188],
         ...,
         [113, 113, 113],
         [220, 220, 220],
         [255, 255, 255]],

        [[251, 251, 251],
         [251, 251, 251],
         [249, 249, 249],
         ...,
         [152, 152, 152],
         [225, 225, 225],
         [255, 255, 255]],

        [[252, 252, 252],
         [253, 253, 253],
         [254, 254, 254],
         ...,
         [252, 252, 252],
         [252, 252, 252],
         [255, 255, 255]]],


       [[[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [179,  47,  35],
         [179,  47,  35],
         [179,  47,  35]],

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [180,  48,  33],
         [179,  47,  33],
         [179,  47,  33]],

        [[255, 255, 255],
         [255, 255, 255],
         [255, 255, 255],
         ...,
         [181,  49,  32],
         [181,  49,  35],
         [181,  49,  35]],

        ...,

        [[ 96,   4,   8],
         [ 58,   2,   1],
         [ 15,   1,   0],
         ...,
         [136,  27,  33],
         [138,  27,  33],
         [138,  27,  33]],

        [[ 82,   4,   4],
         [ 32,   1,   2],
         [ 12,   2,   3],
         ...,
         [136,  27,  32],
         [138,  27,  33],
         [138,  27,  33]],

        [[ 52,   1,   3],
         [ 10,   1,   2],
         [ 38,   4,   6],
         ...,
         [138,  27,  33],
         [137,  26,  32],
         [138,  27,  33]]]], dtype=uint8)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'images/poster_total.npy'</span><span class="p">,</span> <span class="n">poster_total</span><span class="p">)</span>
</code></pre></div></div>

    



<div class="post-tags">
  
    
    <a href="/tags.html#python">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">python</span>
    </a>
  
    
    <a href="/tags.html#deep-learning">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">deep learning</span>
    </a>
  
    
    <a href="/tags.html#cnn">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">CNN</span>
    </a>
  
</div>
  </div>

  
  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
    
      <li>
        <h3>
          <a href="/2021/06/08/OpenCV-Python-%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0.html">
            OpenCV-Python 시작하기
            <small>08 Jun 2021</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/09/28/03_Maximum_Sales_Probability_Matching_Algorithm.html">
            2020 Big Contest - 3
            <small>28 Sep 2020</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2020/09/28/02_NS_shop_code_final.html">
            2020 Big Contest - 2
            <small>28 Sep 2020</small>
          </a>
        </h3>
      </li>
    
  </ul>
</section>

</div>

    </main>

    <!-- Optional footer content -->

  </body>
</html>
